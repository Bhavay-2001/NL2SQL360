SELECT ROUND(MAX(`FRPM Count (K-12)` / `Enrollment (K-12)`), 2) FROM frpm WHERE `County Name` = 'Alameda';
SELECT `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` AS EligibleFreeRate FROM frpm WHERE CDSCode IN (SELECT CDSCode FROM schools WHERE StatusType = 'Continuation High') ORDER BY EligibleFreeRate LIMIT 3;
SELECT Zip FROM schools WHERE County = 'Fresno' AND StatusType = 'Active' AND `Charter` = 1;
SELECT MailStreet || ' ' || MailCity || ' ' || MailState || ' ' || MailZip FROM schools WHERE CDSCode = (SELECT CDSCode FROM frpm ORDER BY `FRPM Count (K-12)` DESC LIMIT 1);
SELECT schools.Phone FROM schools JOIN frpm ON schools.CDSCode = frpm.CDSCode WHERE frpm.`Charter School (Y/N)` = 1 AND schools.OpenDate > '2000-01-01';
SELECT COUNT(*) FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds WHERE ss.AvgScrMath < 400 AND s.Virtual = 'F';
SELECT schools.School, schools.CDSCode FROM schools JOIN satscores ON schools.CDSCode = satscores.cds WHERE satscores.NumTstTakr > 500 AND schools.Magnet = 1;
SELECT schools.Phone FROM schools JOIN (SELECT cds FROM satscores JOIN frpm ON satscores.cds = frpm.CDSCode WHERE NumTstTakr > 1500 ORDER BY NumTstTakr DESC LIMIT 1) AS t ON schools.CDSCode = t.cds;
SELECT NumTstTakr FROM satscores WHERE cds IN (SELECT CDSCode FROM frpm WHERE `FRPM Count (K-12)` = (SELECT MAX(`FRPM Count (K-12)`) FROM frpm));
SELECT COUNT(*) FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds WHERE ss.AvgScrMath > 560 AND s.FundingType = 'Directly funded charter';
SELECT frpm.`FRPM Count (Ages 5-17)` FROM frpm WHERE frpm.CDSCode = (SELECT cds FROM satscores ORDER BY AvgScrRead DESC LIMIT 1);
SELECT CDSCode FROM frpm WHERE `Enrollment (K-12)` + `Enrollment (Ages 5-17)` > 500;
SELECT ROUND(MAX(`Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)`), 2) FROM frpm WHERE cds IN (SELECT cds FROM satscores WHERE NumTstTakr > 0 AND NumGE1500 / NumTstTakr > 0.3);
SELECT schools.Phone FROM schools JOIN satscores ON schools.CDSCode = satscores.cds ORDER BY satscores.NumGE1500 / satscores.NumTstTakr DESC LIMIT 3;
SELECT CDSCode, `Enrollment (Ages 5-17)` FROM frpm ORDER BY `Enrollment (Ages 5-17)` DESC LIMIT 5;
SELECT dname, AVG(AvgScrRead) as avg_read FROM frpm JOIN satscores ON frpm.CDSCode = satscores.cds JOIN schools ON frpm.CDSCode = schools.CDSCode WHERE schools.StatusType = 'Active' GROUP BY dname ORDER BY avg_read DESC LIMIT 1;
SELECT COUNT(*) FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode JOIN satscores ss ON s.CDSCode = ss.cds WHERE s.County = 'Alameda' AND ss.NumTstTakr < 100;
SELECT CharterNum FROM schools WHERE CDSCode IN (SELECT cds FROM satscores WHERE AvgScrWrite = 499);
SELECT COUNT(*) FROM schools s JOIN frpm f ON s.CDSCode = f.CDSCode JOIN satscores ss ON s.CDSCode = ss.cds WHERE s.County = 'Contra Costa' AND f.FundingType = 'Directly funded' AND ss.NumTstTakr <= 250;
SELECT schools.Phone FROM schools JOIN satscores ON schools.CDSCode = satscores.cds WHERE satscores.AvgScrMath = (SELECT MAX(AvgScrMath) FROM satscores);
SELECT COUNT(*) FROM frpm WHERE `County Name` = 'Amador' AND `Low Grade` = '9' AND `High Grade` = '12';
SELECT COUNT(*) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `FRPM Count (K-12)` < 700;
SELECT * FROM satscores WHERE cds IN (SELECT CDSCode FROM schools WHERE County = 'Contra Costa') ORDER BY NumTstTakr DESC LIMIT 1;
SELECT schools.School, schools.Street FROM frpm JOIN schools ON frpm.CDSCode = schools.CDSCode WHERE `Enrollment (K-12)` - `Enrollment (Ages 5-17)` > 30;
SELECT School FROM schools WHERE CDSCode IN (SELECT cds FROM satscores WHERE Percent (%) Eligible Free (K-12) > 0.1 AND NumGE1500 >= 1500);
SELECT schools.School, schools.FundingType FROM schools JOIN satscores ON schools.CDSCode = satscores.cds WHERE schools.County = 'Riverside' AND satscores.AvgScrMath > 400 AND satscores.rtype = 'E';
SELECT schools.School, schools.Street || ', ' || schools.City || ', ' || schools.Zip || ', ' || schools.State AS Full_Address FROM schools JOIN frpm ON schools.CDSCode = frpm.CDSCode WHERE schools.StatusType = 'Active' AND schools.GSserved LIKE '%12%' AND schools.County = 'Monterey' AND frpm.`FRPM Count (Ages 5-17)` > 800;
SELECT schools.School, satscores.AvgScrWrite, frpm.Phone_Number FROM schools JOIN satscores ON schools.CDSCode = satscores.cds JOIN frpm ON schools.CDSCode = frpm.CDSCode WHERE schools.OpenDate > '1991' AND schools.ClosedDate < '2000' AND satscores.AvgScrWrite IS NOT NULL ORDER BY satscores.AvgScrWrite DESC;
SELECT schools.School, satscores.NumTstTakr, schools.DOCType, schools.`Enrollment (K-12)` - schools.`Enrollment (Ages 5-17)` AS diff FROM schools JOIN satscores ON schools.CDSCode = satscores.cds WHERE schools.FundingType = 'Locally Funded' AND diff > (SELECT AVG(`Enrollment (K-12)` - `Enrollment (Ages 5-17)`) FROM schools WHERE FundingType = 'Locally Funded') ORDER BY diff DESC;
SELECT OpenDate FROM schools ORDER BY enroll12 DESC LIMIT 1;
SELECT city, SUM(`Enrollment (K-12)`) as total_enrollment FROM schools GROUP BY city ORDER BY total_enrollment LIMIT 5;
SELECT `FRPM Count (K-12)` / `Enrollment (K-12)` AS eligible_free_rate FROM frpm WHERE `Free Meal Count (K-12)` IS NOT NULL AND `Enrollment (K-12)` IS NOT NULL ORDER BY `Enrollment (K-12)` DESC LIMIT 11 OFFSET 9;
SELECT schools.`School`, schools.`FRPM Count (K-12)` / schools.`Enrollment (K-12)` AS `Eligible Free or Reduced Price Meal Rate` FROM schools JOIN frpm ON schools.`CDSCode` = frpm.`CDSCode` WHERE schools.`Ownership Type` = 66 AND schools.`Low Grade` = '1' AND schools.`High Grade` = '12' ORDER BY frpm.`FRPM Count (K-12)` DESC LIMIT 5;
0
SELECT `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` FROM schools JOIN frpm ON schools.CDSCode = frpm.CDSCode WHERE schools.`School Name` = 'KACEY GIBSON SCHOOL';
SELECT AdmEmail1 FROM schools WHERE CDSCode = (SELECT cds FROM frpm WHERE `Charter School (Y/N)` = 1 ORDER BY `Enrollment (K-12)` ASC LIMIT 1);
SELECT AdmFName1 || ' ' || AdmLName1 FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds WHERE ss.NumGE1500 = (SELECT MAX(NumGE1500) FROM satscores WHERE NumGE1500 IS NOT NULL) AND ss.NumTstTakr = (SELECT MAX(NumTstTakr) FROM satscores WHERE NumGE1500 = (SELECT MAX(NumGE1500) FROM satscores WHERE NumGE1500 IS NOT NULL));
SELECT schools.Street, schools.City, schools.Zip, schools.State FROM schools JOIN satscores ON schools.CDSCode = satscores.cds ORDER BY satscores.NumGE1500 / satscores.NumTstTakr ASC LIMIT 1;
SELECT Website FROM schools WHERE CDSCode IN (SELECT cds FROM satscores WHERE NumTstTakr BETWEEN 2000 AND 3000) AND County = 'Los Angeles County';
SELECT AVG(NumTstTakr) FROM satscores WHERE cds IN (SELECT CDSCode FROM schools WHERE County = 'Fresno' AND OpenDate BETWEEN '1/1/1980' AND '12/31/1980');
SELECT schools.Phone FROM schools JOIN satscores ON schools.CDSCode = satscores.cds WHERE schools.District = 'Fresno Unified' ORDER BY satscores.AvgScrRead ASC LIMIT 1;
SELECT schools.School, satscores.AvgScrRead FROM schools JOIN satscores ON schools.CDSCode = satscores.cds WHERE schools.Virtual = 'F' ORDER BY satscores.AvgScrRead DESC LIMIT 5;
SELECT schools.EdOpsName FROM schools JOIN satscores ON schools.CDSCode = satscores.cds WHERE satscores.AvgScrMath = (SELECT MAX(AvgScrMath) FROM satscores WHERE rtype = 'S');
SELECT s.County, s.AvgScrMath FROM satscores s WHERE s.AvgScrMath = (SELECT MIN(s1.AvgScrMath + s1.AvgScrRead + s1.AvgScrWrite) FROM satscores s1);
SELECT AVG(AvgScrWrite), schools.City FROM satscores JOIN schools ON satscores.cds = schools.CDSCode WHERE NumTstTakr > 0 AND NumGE1500 > 0 AND NumTstTakr = (SELECT MAX(NumTstTakr) FROM satscores WHERE NumTstTakr > 0 AND NumGE1500 > 0) GROUP BY schools.City;
SELECT schools.School, AVG(satscores.AvgScrRead) as AvgRead, AVG(satscores.AvgScrWrite) as AvgWrite FROM schools JOIN satscores ON schools.CDSCode = satscores.cds WHERE schools.AdmFName1 = 'Ricci' AND schools.AdmLName1 = 'Ulrich' GROUP BY schools.School ORDER BY AvgRead DESC;
SELECT schools.School, schools.County, schools.City, schools.State, schools.enroll12 FROM schools JOIN frpm ON schools.CDSCode = frpm.CDSCode WHERE schools.DOC = 31 AND schools.StatusType = 'Active' AND schools.GSoffered = 'K-12' ORDER BY schools.enroll12 DESC LIMIT 1;
SELECT COUNT(*)/12 FROM schools WHERE County = 'Alameda' AND DOC = 52 AND OpenDate LIKE '1980%';
SELECT COUNT(*) FROM schools WHERE County = 'Orange' AND DOCType = 'Merged Unified School District' OR DOCType = 'Merged Elementary School District';
SELECT schools.County, schools.School, schools.ClosedDate FROM schools JOIN frpm ON schools.CDSCode = frpm.CDSCode WHERE schools.StatusType = 'Closed' GROUP BY schools.County ORDER BY COUNT(schools.School) DESC LIMIT 1;
SELECT schools.Street, schools.School FROM schools JOIN satscores ON schools.CDSCode = satscores.cds ORDER BY satscores.AvgScrMath DESC LIMIT 1 OFFSET 5;
SELECT schools.MailStreet, schools.School FROM schools JOIN satscores ON schools.CDSCode = satscores.cds WHERE satscores.AvgScrRead = (SELECT MIN(AvgScrRead) FROM satscores);
SELECT COUNT(*) FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds WHERE s.MailCity = 'Lafayette' AND ss.NumGE1500 > 0;
SELECT SUM(NumTstTakr) FROM satscores WHERE cds IN (SELECT CDSCode FROM schools WHERE MailCity = 'Fresno');
SELECT schools.CDSCode, schools.MailZip, frpm.`School Name` FROM schools JOIN frpm ON schools.CDSCode = frpm.CDSCode WHERE schools.AdmFName1 = 'Avetik' AND schools.AdmLName1 = 'Atoian';
SELECT COUNT(CASE WHEN County = 'Colusa' THEN 1 END) * 1.0 / COUNT(CASE WHEN County = 'Humboldt' THEN 1 END) FROM schools WHERE MailState = 'CA';
SELECT COUNT(*) FROM schools WHERE State = 'CA' AND County = 'San Joaquin' AND StatusType = 'Active';
SELECT schools.Phone, schools.Ext FROM schools JOIN satscores ON schools.CDSCode = satscores.cds ORDER BY satscores.AvgScrWrite DESC LIMIT 1 OFFSET 332;
SELECT schools."School", schools."Phone", schools."Ext" FROM schools WHERE schools."Zip" = '95203-3704';
SELECT Website FROM schools WHERE (AdmFName1 = 'Mike' AND AdmLName1 = 'Larson') OR (AdmFName1 = 'Dante' AND AdmLName1 = 'Alvarez');
SELECT Website FROM schools WHERE County = 'San Joaquin' AND Virtual = 'P' AND Charter = 1;
SELECT COUNT(*) FROM schools WHERE Charter = 1 AND City = 'Hickman' AND DOC = 52;
SELECT COUNT(*) FROM schools WHERE Charter = 0 AND County = 'Los Angeles' AND `FRPM Count (K-12)` * 100 / `Enrollment (K-12)` < 0.18;
SELECT schools.School, schools.City, schools.AdmFName1, schools.AdmLName1, schools.AdmEmail1, schools.AdmFName2, schools.AdmLName2, schools.AdmEmail2, schools.AdmFName3, schools.AdmLName3, schools.AdmEmail3 FROM schools WHERE Charter = 1 AND CharterNum = '00D2';
SELECT COUNT(*) FROM schools WHERE MailCity = 'Handford' AND CharterNum = '00D4';
SELECT COUNT(*) * 100.0 / (SELECT COUNT(*) FROM schools WHERE County = 'Santa Clara') FROM schools WHERE County = 'Santa Clara' AND FundingType = 'Locally Funded';
SELECT COUNT(*) FROM schools WHERE OpenDate BETWEEN '2000-01-01' AND '2005-12-31' AND County = 'Stanislaus' AND FundingType = 'Directly Funded';
SELECT SUM(FRPM Count (K-12)) FROM frpm WHERE CDSCode IN (SELECT CDSCode FROM schools WHERE StatusType = 'Closed' AND ClosedDate = '1989' AND City = 'San Francisco');
SELECT County, COUNT(*) AS num FROM schools WHERE SOC = 11 AND ClosedDate BETWEEN '1980-01-01' AND '1989-12-31' AND StatusType = 'Closed' AND DOCType = 'CEA' GROUP BY County ORDER BY num DESC LIMIT 1;
0
SELECT COUNT(*) FROM schools WHERE District = 'Alpine County Office of Education' AND StatusType IN ('Active', 'Closed');
SELECT District FROM schools WHERE Magnet = 0 AND City = 'Fresno';
SELECT `Enrollment (Ages 5-17)` FROM frpm WHERE `Academic Year` = '2014-2015' AND `District Name` = 'Fremont Unified' AND `EdOpsCode` = 'SSS';
SELECT FRPMCount(Ages5-17) FROM frpm WHERE SchoolName = 'Youth Authority School' AND MailStreet = 'PO Box 1040';
SELECT MIN(`Low Grade`) FROM frpm WHERE `District Code` = 613360 AND EdOpsCode = 'SPECON';
SELECT schools.School, schools.EdOpsName FROM schools JOIN frpm ON schools.CDSCode = frpm.CDSCode WHERE frpm.`NSLP Provision Status` = 'B' AND frpm.`Educational Option Type` = '2' AND frpm.`County Code` = '37';
SELECT `City` FROM frpm WHERE `County Name` = 'Merced' AND `Educational Option Type` = 'Lunch Provision 2' AND `Low Grade` = 9 AND `High Grade` = 12 AND `EILCode` = 'HS';
SELECT schools.`School Name`, frpm.`Percent (%) Eligible FRPM (Ages 5-17)` FROM schools JOIN frpm ON schools.CDSCode = frpm.CDSCode WHERE schools.`Low Grade` = 'K' AND schools.`High Grade` = '9' AND schools.`County Name` = 'Los Angeles' AND schools.`GSserved` = 'KG|01|02|03|04|05|06|07|08|09' AND frpm.`Percent (%) Eligible
SELECT GSserved, COUNT(*) FROM schools WHERE City = 'Adelanto' GROUP BY GSserved ORDER BY COUNT(*) DESC LIMIT 1;
SELECT County, COUNT(*) FROM schools WHERE Virtual = 'F' AND (County = 'San Diego' OR County = 'Santa Barbara') GROUP BY County ORDER BY COUNT(*) DESC LIMIT 1;
SELECT schools.School, schools.Latitude, schools.`School Type` FROM schools WHERE schools.Latitude = (SELECT MAX(schools.Latitude) FROM schools);
SELECT schools.City, schools.School, schools.LowGrade FROM schools WHERE schools.State = 'CA' AND schools.Latitude = (SELECT MIN(Latitude) FROM schools WHERE schools.State = 'CA');
SELECT (CAST(highgrade AS INTEGER) - CAST(lowgrade AS INTEGER)) AS grade_span FROM schools ORDER BY longitude DESC LIMIT 1;
0
SELECT schools.District, schools.AdmFName1, COUNT(*) AS freq FROM schools WHERE schools.AdmFName1 IS NOT NULL GROUP BY schools.District, schools.AdmFName1 ORDER BY freq DESC LIMIT 2;
SELECT FRPM.`Percent (%) Eligible Free (K-12)`, frpm.`District Code` FROM frpm JOIN schools ON frpm.CDSCode = schools.CDSCode WHERE schools.AdmFName1 = 'Alusine';
SELECT schools.District, schools.County, schools.School, schools.AdmLName1 FROM schools WHERE schools.CharterNum = '40';
SELECT AdmEmail1 FROM schools WHERE County = 'San Bernardino' AND District = 'San Bernardino City Unified' AND OpenDate BETWEEN '1/1/2009' AND '12/31/2010' AND StatusType = 'Active' AND (SOC = 62 OR DOC = 54);
SELECT s.AdmEmail1, s.School FROM schools s JOIN satscores ss ON s.CDSCode = ss.cds WHERE ss.NumTstTakr = (SELECT MAX(ss.NumTstTakr) FROM satscores ss WHERE ss.NumGE1500 > 0);
SELECT COUNT(*) FROM account WHERE district_id IN (SELECT district_id FROM district WHERE A3 = 'East Bohemia region') AND frequency = 'POPLATEK PO OBRATU';
SELECT COUNT(*) FROM loan WHERE account_id IN (SELECT account_id FROM account WHERE district_id IN (SELECT district_id FROM district WHERE A3 = 'Prague'));
SELECT AVG(A12) AS avg_1995, AVG(A13) AS avg_1996, CASE WHEN AVG(A12) > AVG(A13) THEN '1995' ELSE '1996' END AS higher_percentage_year FROM district;
SELECT COUNT(*) FROM district WHERE A11 > 6000 AND A11 < 10000 AND district_id IN (SELECT district_id FROM client WHERE gender = 'F');
SELECT COUNT(*) FROM client WHERE gender = 'M' AND district_id IN (SELECT district_id FROM district WHERE A3 = 'North Bohemia') AND client_id IN (SELECT client_id FROM disp WHERE account_id IN (SELECT account_id FROM account WHERE district_id IN (SELECT district_id FROM district WHERE A3 = 'North Bohemia'))) AND client_id IN (SELECT client_id FROM disp WHERE account_id IN (SELECT account_id FROM account WHERE district_id IN (SELECT district_id FROM district WHERE A3 = 'North Bohemia'))) AND client_id IN (SELECT client_id FROM disp WHERE account_id IN (
SELECT account_id FROM disp WHERE client_id IN (SELECT client_id FROM client WHERE gender = 'F' ORDER BY birth_date ASC LIMIT 1) UNION SELECT account_id FROM disp WHERE client_id IN (SELECT client_id FROM client WHERE gender = 'F' ORDER BY birth_date DESC LIMIT 1) EXCEPT SELECT account_id FROM disp WHERE client_id IN (SELECT client_id FROM client WHERE gender = 'F' AND district_id IN (SELECT district_id FROM district GROUP BY district_id HAVING AVG(A11) = (SELECT MIN(A11) FROM district WHERE district_id IN (SELECT district_id FROM client WHERE gender = 'F'))) ) UNION SELECT account_id FROM disp WHERE client_id IN (SELECT client_id FROM client WHERE gender = 'F' AND district_id IN (SELECT district_id FROM district GROUP BY district
SELECT account_id FROM disp WHERE client_id IN (SELECT client_id FROM client WHERE gender = 'M' AND birth_date = (SELECT MIN(birth_date) FROM client WHERE gender = 'M') AND district_id IN (SELECT district_id FROM district WHERE A11 = (SELECT MAX(A11) FROM district WHERE A11 IS NOT NULL)));
SELECT COUNT(*) FROM client WHERE client_id IN (SELECT client_id FROM disp WHERE disp_id IN (SELECT disp_id FROM account WHERE frequency = 'POPLATEK TYDNE') AND type = 'OWNER');
SELECT client_id FROM disp WHERE disp.type = 'DISPONENT' AND disp_id IN (SELECT disp_id FROM account WHERE frequency = 'POPLATEK PO OBRATU');
SELECT * FROM account WHERE account_id IN (SELECT account_id FROM loan WHERE date LIKE '1997%') AND account_id IN (SELECT account_id FROM loan WHERE amount = (SELECT MIN(amount) FROM loan WHERE date LIKE '1997%')) AND frequency = 'POPLATEK TYDNE';
SELECT MAX(amount) FROM loan WHERE duration > 12 AND date BETWEEN '1993-01-01' AND '1993-12-31';
SELECT COUNT(*) FROM account WHERE district_id = (SELECT district_id FROM district WHERE A2 = 'Slokolov') AND account_id IN (SELECT account_id FROM disp WHERE client_id IN (SELECT client_id FROM client WHERE gender = 'F' AND birth_date < '1950-01-01'));
SELECT account_id FROM trans WHERE date = (SELECT MIN(date) FROM trans WHERE date LIKE '1995%') GROUP BY account_id;
SELECT account_id FROM account WHERE date < '1997-01-01' AND account_id IN (SELECT account_id FROM trans WHERE amount > 3000);
SELECT client_id FROM disp WHERE disp_id = (SELECT disp_id FROM card WHERE issued = '1994-03-03');
SELECT date FROM account WHERE account_id = (SELECT account_id FROM trans WHERE trans_id = 1050729);
SELECT district_id FROM account WHERE account_id = (SELECT account_id FROM loan WHERE date = '1994-08-25');
SELECT MAX(amount) FROM trans WHERE account_id = (SELECT account_id FROM disp WHERE disp_id = (SELECT disp_id FROM card WHERE issued = '1995-10-08' AND disp_id = (SELECT disp_id FROM disp WHERE client_id = 1)));
SELECT gender FROM client WHERE birth_date = (SELECT MIN(birth_date) FROM client WHERE district_id = (SELECT district_id FROM district WHERE A11 = (SELECT MAX(A11) FROM district))) AND client_id IN (SELECT client_id FROM disp WHERE account_id IN (SELECT account_id FROM account WHERE account_id IN (SELECT account_id FROM loan WHERE account_id IN (SELECT account_id FROM disp WHERE client_id IN (SELECT client_id FROM client WHERE gender IN ('M', 'F') AND client_id IN (SELECT client_id FROM disp WHERE account_id IN (SELECT account_id FROM account WHERE account_id IN (SELECT account_id FROM loan WHERE account_id IN (SELECT account_id FROM disp WHERE client_id IN (SELECT client_id FROM client WHERE birth_date = (SELECT MIN(birth_date)
SELECT amount FROM trans WHERE account_id = (SELECT account_id FROM loan ORDER BY amount DESC LIMIT 1) ORDER BY date ASC LIMIT 1;
SELECT COUNT(*) FROM client WHERE district_id = (SELECT district_id FROM district WHERE A2 = 'Jesenik') AND gender = 'F';
SELECT disp_id FROM disp WHERE account_id = (SELECT account_id FROM trans WHERE date = '1998-09-02' AND amount = 5100);
SELECT COUNT(*) FROM account WHERE district_id = (SELECT district_id FROM district WHERE A2 = 'Litomerice') AND strftime('%Y', date) = '1996';
SELECT card.type FROM client JOIN disp ON client.client_id = disp.client_id JOIN account ON disp.account_id = account.account_id JOIN card ON disp.disp_id = card.disp_id WHERE client.gender = 'F' AND client.birth_date = '1976-01-29';
SELECT birth_date FROM client WHERE client_id = (SELECT client_id FROM disp WHERE account_id = (SELECT account_id FROM loan WHERE amount = 98832 AND date = '1996-01-03'));
SELECT account_id FROM disp WHERE client_id = (SELECT client_id FROM client WHERE district_id = (SELECT district_id FROM district WHERE A3 = 'Prague') ORDER BY client_id LIMIT 1);
SELECT ROUND(DIVIDE(COUNT(CASE WHEN gender = 'M' THEN 1 END), COUNT(*)) * 100) FROM client WHERE district_id = (SELECT district_id FROM district WHERE A3 = 'south Bohemia' ORDER BY A4 DESC LIMIT 1);
SELECT ROUND((balance_19981227 - balance_19930322) * 100.0 / balance_19930322, 2) AS increase_rate FROM (SELECT trans.account_id, trans.balance AS balance_19981227 FROM trans WHERE trans.date = '1998-12-27') AS t1 JOIN (SELECT trans.account_id, trans.balance AS balance_19930322 FROM trans WHERE trans.date = '1993-03-22') AS t2 ON t1.account_id = t2.account_id JOIN (SELECT loan.account_id FROM loan WHERE loan.date = '1993-07-05') AS t3 ON t1.account_id = t3.account_id;
SELECT (SUM(amount) FILTER (WHERE status = 'A') / SUM(amount)) * 100 FROM loan;
SELECT (COUNT(*) * 1.0 / (SELECT COUNT(*) FROM loan WHERE amount < 100000)) * 100 FROM loan WHERE amount < 100000 AND status = 'C';
SELECT account_id, A4, A3 FROM account JOIN district ON account.district_id = district.district_id WHERE strftime('%Y', date) = '1993' AND frequency = 'POPLATEK PO OBRATU' ORDER BY account_id;
0
SELECT account_id, date FROM account WHERE district_id = (SELECT district_id FROM district WHERE A2 = 'Prachatice') ORDER BY account_id ASC;
SELECT district.A2, district.A3 FROM district JOIN account ON district.district_id = account.district_id JOIN loan ON loan.account_id = account.account_id WHERE loan.loan_id = 4990;
SELECT account_id, A2, A3 FROM account JOIN district ON account.district_id = district.district_id WHERE account_id IN (SELECT account_id FROM loan WHERE amount > 300000);
SELECT loan.loan_id, district.A3, district.A11 FROM loan JOIN account ON loan.account_id = account.account_id JOIN disp ON account.account_id = disp.account_id JOIN client ON disp.client_id = client.client_id JOIN district ON client.district_id = district.district_id WHERE loan.duration = 60 ORDER BY district.A11 DESC;
SELECT district.A2, ((district.A13 - district.A12) / district.A12) * 100 AS increment_rate FROM loan JOIN account ON loan.account_id = account.account_id JOIN district ON account.district_id = district.district_id WHERE loan.status = 'D' ORDER BY increment_rate DESC;
SELECT ROUND(COUNT(CASE WHEN district.A2 = 'Decin' THEN 1 END) * 100.0 / COUNT(account.account_id), 2) FROM account JOIN district ON account.district_id = district.district_id WHERE account.date BETWEEN '1993-01-01' AND '1993-12-31';
SELECT account_id FROM account WHERE frequency = 'POPLATEK MESICNE';
SELECT district.A2, COUNT(*) FROM account JOIN client ON account.district_id = client.district_id JOIN district ON account.district_id = district.district_id WHERE client.gender = 'F' GROUP BY district.A2 ORDER BY COUNT(*) DESC LIMIT 10;
SELECT district.A2, SUM(trans.amount) AS total_amount FROM trans JOIN account ON trans.account_id = account.account_id JOIN district ON account.district_id = district.district_id WHERE trans.type = 'VYDAJ' AND trans.date LIKE '1996-01%' GROUP BY district.A2 ORDER BY total_amount DESC LIMIT 10;
SELECT COUNT(*) FROM client WHERE district_id IN (SELECT district_id FROM district WHERE A3 = 'South Bohemia') AND client_id NOT IN (SELECT client_id FROM disp WHERE type = 'OWNER');
SELECT d.A3, SUM(l.amount) AS active_loan FROM loan l JOIN account a ON l.account_id = a.account_id JOIN district d ON a.district_id = d.district_id WHERE l.status = 'C' GROUP BY d.A3 ORDER BY active_loan DESC LIMIT 1;
SELECT AVG(amount) FROM loan WHERE account_id IN (SELECT account_id FROM disp WHERE client_id IN (SELECT client_id FROM client WHERE gender = 'M'));
SELECT district.A2, district.A3, district.A4, district.A5, district.A6, district.A7, district.A8, district.A9, district.A10, district.A11, district.A12, district.A13, district.A14, district.A15, district.A16 FROM district WHERE district.A13 = (SELECT MAX(district.A13) FROM district WHERE district.A13 IN (SELECT A13 FROM district WHERE A13 IS NOT NULL AND A13 != '' AND A11 = 1996)) ORDER BY district.A13 DESC;
SELECT COUNT(*) FROM account JOIN district ON account.district_id = district.district_id WHERE district.A16 = (SELECT MAX(A16) FROM district);
SELECT COUNT(DISTINCT account_id) FROM trans WHERE balance < 0 AND account_id IN (SELECT account_id FROM account WHERE frequency = 'POPLATEK MESICNE' AND account_id IN (SELECT account_id FROM disp WHERE disp_id IN (SELECT disp_id FROM card WHERE type = 'VYBER KARTOU')));
SELECT COUNT(*) FROM loan l JOIN account a ON l.account_id = a.account_id WHERE l.date BETWEEN '1995-01-01' AND '1997-12-31' AND l.amount >= 250000 AND a.frequency = 'POPLATEK MESICNE';
SELECT COUNT(*) FROM account WHERE status = 'C' OR status = 'D' AND district_id = 1;
SELECT COUNT(*) FROM client WHERE district_id = (SELECT district_id FROM district ORDER BY A15 DESC LIMIT 1 OFFSET 1) AND gender = 'M';
SELECT COUNT(*) FROM card c JOIN disp d ON c.card_id = d.disp_id WHERE c.type = 'gold' AND d.type = 'disponent';
SELECT COUNT(*) FROM account WHERE district_id = (SELECT district_id FROM district WHERE A2 = 'Pisek');
SELECT district_id FROM (SELECT account.district_id, SUM(trans.amount) as total_amount FROM trans JOIN account ON trans.account_id = account.account_id WHERE trans.date BETWEEN '1997-01-01' AND '1997-12-31' GROUP BY account.district_id) WHERE total_amount > 10000;
SELECT account_id FROM `order` WHERE k_symbol = 'SIPO' AND bank_to = 'Pisek';
SELECT DISTINCT card.account_id FROM card WHERE card.type = 'gold' AND card.account_id IN (SELECT card.account_id FROM card WHERE card.type = 'junior');
SELECT ROUND(AVG(avg_amount), 2) FROM (SELECT AVG(amount) AS avg_amount FROM trans WHERE operation = 'VYBER KARTOU' AND strftime('%Y', date) = '2021' GROUP BY account_id, strftime('%m', date)) AS t;
SELECT account_id FROM (SELECT account_id, strftime('%m', date) AS month, SUM(amount) AS total_amount FROM trans WHERE operation = 'VYBER KARTOU' AND strftime('%Y', date) = '1998' GROUP BY account_id, month) AS t1 JOIN (SELECT AVG(total_amount) AS avg_amount FROM (SELECT account_id, strftime('%m', date) AS month,
SELECT DISTINCT client.client_id FROM client JOIN disp ON client.client_id = disp.client_id JOIN card ON disp.disp_id = card.disp_id JOIN loan ON disp.account_id = loan.account_id WHERE client.gender = 'F';
SELECT COUNT(*) FROM client WHERE district_id = (SELECT district_id FROM district WHERE A3 = 'south Bohemia') AND gender = 'F';
SELECT * FROM loan WHERE account_id IN (SELECT account_id FROM disp WHERE disp_id IN (SELECT disp_id FROM card WHERE type = 'OWNER' AND disp_id IN (SELECT disp_id FROM disp WHERE client_id IN (SELECT client_id FROM client WHERE district_id IN (SELECT district_id FROM district WHERE A2 = 'Tabor')))));
SELECT DISTINCT type FROM disp WHERE account_id NOT IN (SELECT account_id FROM loan WHERE account_id IS NOT NULL) AND district_id IN (SELECT district_id FROM district WHERE A11 > 8000 AND A11 <= 9000);
SELECT COUNT(*) FROM trans WHERE account_id IN (SELECT account_id FROM account WHERE district_id IN (SELECT district_id FROM district WHERE A3 = 'North Bohemia')) AND bank = 'AB';
SELECT DISTINCT district.A2 FROM district INNER JOIN client ON district.district_id = client.district_id INNER JOIN account ON client.client_id = disp.client_id INNER JOIN trans ON account.account_id = trans.account_id WHERE trans.type = 'VYDAJ';
SELECT AVG(A15) FROM district WHERE district_id IN (SELECT district_id FROM account WHERE date >= '1997-01-01' AND district_id IN (SELECT district_id FROM district WHERE A8 > 4000));
SELECT COUNT(*) FROM loan WHERE account_id IN (SELECT account_id FROM disp WHERE client_id IN (SELECT client_id FROM disp WHERE account_id IN (SELECT account_id FROM card WHERE type = 'classic') AND type = 'OWNER'));
SELECT COUNT(*) FROM client WHERE district_id = (SELECT district_id FROM district WHERE A2 = 'Hl.m. Praha') AND gender = 'M';
SELECT ROUND(CAST(COUNT(CASE WHEN type = 'gold' AND issued < '1998-01-01' THEN 1 END) AS REAL) / COUNT(*), 2) * 100 AS percentage FROM card;
SELECT client_id FROM disp WHERE account_id = (SELECT account_id FROM loan ORDER BY amount DESC LIMIT 1);
SELECT A15 FROM district WHERE district_id = (SELECT district_id FROM account WHERE account_id = 532);
SELECT district_id FROM account WHERE account_id = (SELECT account_id FROM `order` WHERE order_id = 33333);
SELECT amount FROM trans WHERE account_id = (SELECT account_id FROM disp WHERE client_id = 3356) AND operation = 'VYBER';
SELECT COUNT(*) FROM account WHERE frequency = 'POPLATEK TYDNE' AND account_id IN (SELECT account_id FROM loan WHERE amount < 200000);
SELECT type FROM card WHERE disp_id = (SELECT disp_id FROM disp WHERE client_id = 13539);
SELECT A3 FROM district WHERE district_id = (SELECT district_id FROM client WHERE client_id = 3541);
SELECT district_id, COUNT(*) AS num FROM account JOIN loan ON account.account_id = loan.account_id WHERE loan.status = 'A' GROUP BY district_id ORDER BY num DESC LIMIT 1;
SELECT c.client_id, c.name FROM client c JOIN disp d ON c.client_id = d.client_id JOIN account a ON d.account_id = a.account_id JOIN `order` o ON a.account_id = o.account_id WHERE o.order_id = 32423;
SELECT * FROM trans WHERE account_id IN (SELECT account_id FROM account WHERE district_id = 5);
SELECT COUNT(*) FROM account WHERE district_id = (SELECT district_id FROM district WHERE A3 = 'Jesenik');
SELECT DISTINCT client_id FROM disp WHERE type = 'junior' AND EXISTS (SELECT * FROM card WHERE card.card_id = disp.card_id AND card.issued >= '1997-01-01');
SELECT ROUND(COUNT(CASE WHEN gender = 'F' THEN 1 END) * 100.0 / COUNT(*)) FROM client WHERE district_id IN (SELECT district_id FROM district WHERE A11 > 10000);
SELECT ROUND((SUM(CASE WHEN date BETWEEN '1996-01-01' AND '1996-12-31' THEN amount ELSE 0 END) - SUM(CASE WHEN date BETWEEN '1997-01-01' AND '1997-12-31' THEN amount ELSE 0 END)) * 100.0 / SUM(CASE WHEN date BETWEEN '1996-01-01' AND '1996-12-31' THEN amount ELSE 0 END)) AS growth_rate FROM loan WHERE account_id IN (SELECT account_id FROM disp WHERE client_id IN (SELECT client_id FROM client WHERE gender = 'M'));
SELECT COUNT(*) FROM trans WHERE date > '1995-01-01' AND operation = 'VYBER KARTOU';
SELECT (SELECT SUM(A16) FROM district WHERE A3 = 'North Bohemia' AND A16 IS NOT NULL) - (SELECT SUM(A16) FROM district WHERE A3 = 'East Bohemia' AND A16 IS NOT NULL);
SELECT COUNT(*) FROM disp JOIN account ON disp.account_id = account.account_id WHERE account.account_id BETWEEN 1 AND 10;
0
SELECT birth_date FROM client WHERE client_id = (SELECT client_id FROM disp WHERE disp.account_id = (SELECT account_id FROM account WHERE account.account_id = 130));
SELECT COUNT(*) FROM account a JOIN disp d ON a.account_id = d.account_id WHERE d.type = 'OWNER' AND a.frequency = 'POPLATEK PO OBRATU';
SELECT SUM(amount), status FROM loan WHERE account_id = (SELECT account_id FROM disp WHERE client_id = 992);
SELECT SUM(balance), client.gender FROM trans JOIN disp ON trans.account_id = disp.account_id JOIN client ON disp.client_id = client.client_id WHERE client.client_id = 4 AND trans.trans_id = 851;
SELECT type FROM card WHERE disp_id = (SELECT disp_id FROM disp WHERE client_id = 9);
SELECT SUM(amount) FROM trans WHERE account_id = (SELECT account_id FROM disp WHERE client_id = 617) AND strftime('%Y', date) = '1998';
SELECT client_id, gender FROM client WHERE birth_date BETWEEN '1983-01-01' AND '1987-12-31' AND district_id IN (SELECT district_id FROM district WHERE A2 = 'East Bohemia');
SELECT client_id FROM client WHERE gender = 'F' AND client_id IN (SELECT account.client_id FROM account INNER JOIN loan ON account.account_id = loan.account_id ORDER BY loan.amount DESC LIMIT 3);
SELECT COUNT(*) FROM client WHERE gender = 'M' AND birth_date BETWEEN '1974-01-01' AND '1976-12-31' AND client_id IN (SELECT client_id FROM disp WHERE account_id IN (SELECT account_id FROM loan WHERE payments > 4000 AND k_symbol = 'SIPO'));
SELECT COUNT(*) FROM account WHERE date > '1996' AND district_id = (SELECT district_id FROM district WHERE A2 = 'Beroun');
SELECT COUNT(*) FROM client c JOIN disp d ON c.client_id = d.client_id JOIN card ca ON d.disp_id = ca.disp_id WHERE c.gender = 'F' AND ca.type = 'junior';
SELECT ROUND(CAST(COUNT(CASE WHEN gender = 'F' THEN 1 END) AS FLOAT) / COUNT(*) * 100, 2) FROM client WHERE district_id IN (SELECT district_id FROM district WHERE A3 = 'Prague');
SELECT ROUND(CAST(COUNT(CASE WHEN gender = 'M' THEN 1 END) AS FLOAT) / COUNT(*) * 100) FROM client WHERE client_id IN (SELECT client_id FROM disp WHERE account_id IN (SELECT account_id FROM account WHERE frequency = 'POPLATEK TYDNE'));
SELECT COUNT(*) FROM client WHERE gender = 'User' AND client_id IN (SELECT client_id FROM disp WHERE account_id IN (SELECT account_id FROM account WHERE frequency = 'POPLATEK TYDNE'));
SELECT account_id, amount FROM loan WHERE duration > 24 AND status = 'A' AND account_id IN (SELECT account_id FROM account WHERE date < '1997-01-01') ORDER BY amount ASC LIMIT 1;
SELECT account_id FROM disp WHERE client_id IN (SELECT client_id FROM client WHERE gender = 'F' ORDER BY birth_date ASC LIMIT 1) AND account_id IN (SELECT account_id FROM account WHERE district_id IN (SELECT district_id FROM district ORDER BY A11 ASC LIMIT 1));
SELECT COUNT(*) FROM client WHERE district_id IN (SELECT district_id FROM district WHERE A3 = 'East Bohemia') AND birth_date = '1920';
SELECT COUNT(*) FROM loan l JOIN account a ON l.account_id = a.account_id WHERE l.duration = 24 AND l.status = 'A' AND a.frequency = 'POPLATEK TYDNE';
SELECT AVG(amount) FROM loan WHERE status = 'C' OR status = 'D' AND EXISTS (SELECT * FROM trans WHERE loan.account_id = trans.account_id AND k_symbol = 'POPLATEK PO OBRATU');
SELECT client.client_id, district.district_id FROM client JOIN disp ON client.client_id = disp.client_id JOIN account ON disp.account_id = account.account_id JOIN loan ON account.account_id = loan.account_id WHERE loan.status = 'A' UNION SELECT client.client_id, district.district_id FROM client JOIN disp ON client.client_id = disp.client_id JOIN account ON disp.account_id = account.account_id JOIN `order` ON account.account_id = `order`.account_id WHERE `order`.k_symbol = 'POJISTNE';
SELECT client.client_id, (strftime('%Y', 'now') - strftime('%Y', client.birth_date)) AS age FROM client JOIN disp ON client.client_id = disp.client_id JOIN card ON disp.disp_id = card.disp_id WHERE card.type = 'gold' AND (SELECT COUNT(*) FROM loan WHERE loan.account_id = disp.account_id) > 0;
SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT(*) DESC LIMIT 1;
SELECT COUNT(DISTINCT molecule.molecule_id) FROM molecule JOIN atom ON molecule.molecule_id = atom.molecule_id JOIN connected ON atom.atom_id = connected.atom_id OR atom.atom_id = connected.atom_id2 JOIN bond ON connected.bond_id = bond.bond_id WHERE molecule.label = '-' AND atom.element = 'cl';
SELECT AVG(CASE WHEN element = 'o' THEN 1 ELSE 0 END) FROM atom WHERE molecule_id IN (SELECT molecule_id FROM bond WHERE bond_type = '-');
SELECT ROUND(CAST(SUM(bond_type = '-') AS REAL) / COUNT(DISTINCT molecule_id), 2) FROM bond WHERE molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '+') AND bond_type = '-';
SELECT COUNT(*) FROM molecule WHERE molecule_id IN (SELECT molecule_id FROM atom WHERE element = 'na') AND label = '-';
SELECT atom_id, molecule_id FROM atom WHERE molecule_id IN (SELECT molecule_id FROM bond WHERE bond_type = '#') AND molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '+');
SELECT ROUND(CAST(SUM(element = 'c') AS REAL) / COUNT(DISTINCT atom_id) * 100, 2) AS percentage FROM atom WHERE molecule_id IN (SELECT molecule_id FROM bond WHERE bond_type = ' = ');
SELECT COUNT(*) FROM bond WHERE bond_type = '#';
SELECT COUNT(*) FROM atom WHERE element != 'br';
SELECT COUNT(*) FROM molecule WHERE molecule_id BETWEEN 'TR000' AND 'TR099' AND label = '+';
SELECT DISTINCT molecule_id FROM atom WHERE element = 'si' INNER JOIN connected ON atom.atom_id = connected.atom_id OR atom.atom_id = connected.atom_id2 INNER JOIN molecule ON connected.molecule_id = molecule.molecule_id;
SELECT GROUP_CONCAT(element, ',') FROM atom WHERE atom_id IN (SELECT atom_id FROM connected WHERE bond_id = 'TR004_8_9') ORDER BY element ASC;
SELECT DISTINCT element FROM atom WHERE atom_id IN (SELECT atom_id FROM connected WHERE bond_id IN (SELECT bond_id FROM bond WHERE bond_type = ' = '));
SELECT label FROM atom JOIN connected ON atom.atom_id = connected.atom_id WHERE element = 'h' GROUP BY label ORDER BY COUNT(label) DESC LIMIT 1;
SELECT bond_type FROM bond WHERE bond_id = (SELECT bond_id FROM connected WHERE atom_id2 = (SELECT atom_id FROM atom WHERE element = 'te'));
SELECT DISTINCT atom_id, atom_id2 FROM connected WHERE bond_id IN (SELECT bond_id FROM bond WHERE bond_type = '-');
SELECT atom_id, atom_id2 FROM connected WHERE bond_id IN (SELECT bond_id FROM bond WHERE molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '-'));
0
SELECT bond_type FROM bond WHERE bond_id = (SELECT bond_id FROM connected WHERE atom_id = 'TR004_8' AND atom_id2 = 'TR004_20');
SELECT DISTINCT label FROM molecule WHERE molecule_id IN (SELECT molecule_id FROM atom WHERE element != 'sn') AND label NOT IN ('+', '-');
SELECT COUNT(*) FROM atom WHERE element = 'i' OR element = 's' AND molecule_id IN (SELECT molecule_id FROM bond GROUP BY molecule_id HAVING COUNT(*) = 1);
SELECT atom_id, atom_id2 FROM connected WHERE bond_id IN (SELECT bond_id FROM bond WHERE bond_type = '#');
SELECT atom.atom_id, atom.element FROM atom JOIN connected ON atom.atom_id = connected.atom_id2 WHERE connected.atom_id IN (SELECT atom_id FROM connected WHERE molecule_id = 'TR181');
SELECT ROUND((1 - DIVIDE(SUM(element = 'f'), COUNT(molecule_id))), 2) as percent FROM molecule WHERE label = '+';
SELECT DIVIDE(SUM(bond_type = '#'), COUNT(bond_id)) as percent FROM bond WHERE bond_id IN (SELECT bond_id FROM connected WHERE atom_id IN (SELECT atom_id FROM atom WHERE molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '+'))) AND bond_type = '#';
SELECT element, toxicology FROM atom JOIN molecule ON atom.molecule_id = molecule.molecule_id WHERE molecule.molecule_id = 'TR000';
SELECT a1.element, a2.element FROM atom a1 JOIN connected c ON a1.atom_id = c.atom_id JOIN bond b ON c.bond_id = b.bond_id JOIN molecule m ON b.molecule_id = m.molecule_id JOIN connected c2 ON c2.bond_id = b.bond_id JOIN atom a2 ON c2.atom_id2 = a2.atom_id WHERE m.molecule_id = 'TR001' AND b.bond_id = 'TR001_2_6';
SELECT SUM(label = '+') - SUM(label = '-') AS difference FROM molecule;
SELECT atom_id, atom_id2 FROM connected WHERE bond_id = 'TR_000_2_5';
SELECT DISTINCT bond_id FROM connected WHERE atom_id2 = 'TR000_2';
SELECT DISTINCT molecule_id FROM bond WHERE bond_type = ' = ' LIMIT 5;
SELECT DIVIDE(SUM(bond_type = ' = '), COUNT(bond_id)) as percent FROM bond WHERE molecule_id = 'TR008';
SELECT ROUND(CAST(SUM(label = '+') AS REAL) / CAST(COUNT(molecule_id) AS REAL), 2) as percent FROM molecule;
SELECT ROUND(DIVIDE(SUM(element = 'h'), COUNT(atom_id)) * 100, 2) as percent FROM atom WHERE molecule_id = 'TR206';
SELECT bond_type FROM bond WHERE molecule_id = 'TR000';
SELECT DISTINCT element, label FROM atom JOIN molecule ON atom.molecule_id = molecule.molecule_id WHERE molecule.molecule_id = 'TR060';
SELECT bond_type FROM bond WHERE molecule_id = 'TR018' GROUP BY bond_type ORDER BY COUNT(*) DESC LIMIT 1; SELECT label FROM molecule WHERE molecule_id = 'TR018';
SELECT molecule_id FROM molecule WHERE label = '-' AND molecule_id IN (SELECT molecule_id FROM connected WHERE bond_id IN (SELECT bond_id FROM bond WHERE bond_type = '-')) LIMIT 3;
SELECT bond_id FROM bond WHERE molecule_id = 'TR006' AND bond_id IN (SELECT bond_id FROM connected WHERE atom_id IN (SELECT atom_id FROM atom WHERE molecule_id = 'TR006') AND atom_id2 IN (SELECT atom_id FROM atom WHERE molecule_id = 'TR006'));
SELECT COUNT(*) FROM connected WHERE bond_id LIKE 'TR009_%' AND (atom_id = 'TR009_12' OR atom_id2 = 'TR009_12');
SELECT COUNT(DISTINCT molecule_id) FROM atom WHERE element = 'br' AND molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '+');
SELECT bond_type, atom_id, atom_id2 FROM bond JOIN connected ON bond.molecule_id = connected.bond_id WHERE bond.bond_id = (SELECT bond_id FROM connected WHERE atom_id = 'TR001_6_9' OR atom_id2 = 'TR001_6_9');
SELECT label FROM molecule WHERE molecule_id = (SELECT molecule_id FROM atom WHERE atom_id = 'TR001_10');
SELECT COUNT(DISTINCT molecule_id) FROM bond WHERE bond_type = '#';
SELECT COUNT(*) FROM connected WHERE atom_id = 'TR%_19' OR atom_id2 = 'TR%_19';
SELECT DISTINCT element FROM atom WHERE molecule_id = 'TR004';
SELECT COUNT(*) FROM molecule WHERE label = '-';
SELECT DISTINCT molecule_id FROM atom JOIN molecule ON atom.molecule_id = molecule.molecule_id WHERE SUBSTRING(atom_id, 7, 2) BETWEEN '21' AND '25' AND label = '+';
SELECT bond_id, bond_type FROM bond WHERE bond_id IN (SELECT bond_id FROM connected WHERE atom_id IN (SELECT atom_id FROM atom WHERE element = 'p') AND atom_id2 IN (SELECT atom_id FROM atom WHERE element = 'n'));
SELECT molecule_id FROM (SELECT molecule_id, COUNT(*) AS cnt FROM bond WHERE bond_type = ' = ' GROUP BY molecule_id ORDER BY cnt DESC LIMIT 1) AS t1 JOIN molecule ON t1.molecule_id = molecule.molecule_id WHERE label = '+';
SELECT DIVIDE(COUNT(bond_id), COUNT(atom_id)) FROM atom WHERE element = 'i';
SELECT bond_type, bond_id FROM bond WHERE bond_id = (SELECT bond_id FROM connected WHERE atom_id = 'atom45' OR atom_id2 = 'atom45') ORDER BY bond_id;
SELECT DISTINCT element FROM atom WHERE atom_id NOT IN (SELECT atom_id FROM connected UNION SELECT atom_id2 FROM connected);
SELECT a1.element, a2.element FROM atom a1, atom a2, bond b, molecule m, connected c WHERE a1.atom_id = c.atom_id AND a2.atom_id = c.atom_id2 AND b.bond_id = c.bond_id AND m.molecule_id = b.molecule_id AND m.molecule_id = 'TR447' AND b.bond_type = '#';
SELECT element FROM atom WHERE atom_id IN (SELECT atom_id FROM connected WHERE bond_id = 'TR144_8_19');
SELECT molecule_id, COUNT(*) AS double_bonds FROM bond JOIN molecule ON bond.molecule_id = molecule.molecule_id WHERE bond_type = ' = ' AND label = '+' GROUP BY molecule_id ORDER BY double_bonds DESC LIMIT 1;
SELECT element FROM atom WHERE molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '+') GROUP BY element ORDER BY COUNT(*) ASC LIMIT 1;
SELECT atom_id2 FROM connected WHERE bond_id IN (SELECT bond_id FROM bond WHERE molecule_id = (SELECT molecule_id FROM atom WHERE element = 'pb'));
SELECT DISTINCT element FROM atom WHERE atom_id IN (SELECT atom_id FROM connected WHERE bond_id IN (SELECT bond_id FROM bond WHERE bond_type = '#'));
SELECT ROUND(CAST(COUNT(bond_id) AS FLOAT) / CAST((SELECT COUNT(atom_id) FROM atom WHERE element = (SELECT element FROM atom GROUP BY element ORDER BY COUNT(*) DESC LIMIT 1)) AS FLOAT) * 100, 2) FROM connected WHERE bond_id IS NOT NULL;
SELECT ROUND(CAST(SUM(label = '+') AS REAL) / COUNT(bond_id), 2) FROM bond JOIN molecule ON bond.molecule_id = molecule.molecule_id WHERE bond_type = '-';
SELECT COUNT(*) FROM atom WHERE element in('c', 'h');
SELECT atom_id2 FROM atom WHERE element = 's';
SELECT bond_type FROM bond WHERE molecule_id IN (SELECT molecule_id FROM atom WHERE element = 'Sn');
SELECT COUNT(DISTINCT element) FROM atom WHERE atom_id IN (SELECT atom_id FROM connected WHERE bond_id IN (SELECT bond_id FROM bond WHERE bond_type = '-'));
SELECT COUNT(*) FROM atom WHERE atom_id IN (SELECT atom_id FROM connected WHERE bond_id IN (SELECT bond_id FROM bond WHERE bond_type = '#') INTERSECT SELECT atom_id FROM atom WHERE element = 'p' OR element = 'br');
SELECT bond_id FROM bond WHERE molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '+');
SELECT molecule_id FROM bond WHERE bond_type = '-' AND molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '-');
SELECT ROUND(DIVIDE(SUM(element = 'cl'), COUNT(atom_id)), 2) as percent FROM atom WHERE molecule_id IN (SELECT molecule_id FROM bond WHERE bond_type = '-') AND element = 'cl';
SELECT label FROM molecule WHERE molecule_id IN ('TR000', 'TR001', 'TR002');
SELECT molecule_id FROM molecule WHERE label = '-';
SELECT COUNT(*) FROM molecule WHERE molecule_id BETWEEN 'TR000' AND 'TR030' AND label = '+';
SELECT molecule.molecule_id, IFNULL(bond.bond_type, 'no bond') FROM molecule LEFT JOIN bond ON molecule.molecule_id = bond.molecule_id LEFT JOIN connected ON bond.bond_id = connected.bond_id LEFT JOIN atom ON connected.atom_id = atom.atom_id WHERE molecule.molecule_id BETWEEN 'TR000' AND 'TR050';
SELECT element FROM atom WHERE atom_id IN (SELECT atom_id FROM connected WHERE bond_id = 'TR001_10').
SELECT COUNT(*) FROM bond WHERE molecule_id IN (SELECT molecule_id FROM atom WHERE element = 'i');
SELECT label, COUNT(*) FROM molecule WHERE molecule_id IN (SELECT molecule_id FROM atom WHERE element = 'ca') GROUP BY label;
SELECT CASE WHEN (SELECT element FROM atom WHERE atom_id = (SELECT atom_id FROM connected WHERE bond_id = 'TR001_1_8')) = 'cl' AND (SELECT element FROM atom WHERE atom_id = (SELECT atom_id2 FROM connected WHERE bond_id = 'TR001_1_8')) = 'c' THEN 1 ELSE 0 END;
SELECT molecule_id FROM atom WHERE element = 'c' AND atom_id IN (SELECT atom_id FROM connected WHERE bond_id IN (SELECT bond_id FROM bond WHERE bond_type = '#') AND atom_id2 IN (SELECT atom_id FROM connected WHERE bond_id IN (SELECT bond_id FROM bond WHERE bond_type = '#') AND atom_id2 IN (SELECT atom_id FROM connected WHERE bond_id IN (SELECT bond_id FROM bond WHERE bond_type = '#') AND atom_id2 IN (SELECT atom_id FROM atom WHERE molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '-')))));
SELECT ROUND(DIVIDE(SUM(CASE WHEN label = '+' THEN element = 'pb' ELSE 0 END), COUNT(DISTINCT molecule_id)) * 100, 2) as percentage FROM atom JOIN molecule ON atom.molecule_id = molecule.molecule_id WHERE label = '+' AND element = 'pb';
SELECT DISTINCT a.element FROM atom a JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 WHERE c.molecule_id = 'TR001' AND a.element IN ('As', 'Cd', 'Hg', 'Pb', 'Se');
SELECT molecule_id FROM bond WHERE bond_type = ' = ';
SELECT atom_id, atom_id2 FROM connected WHERE bond_id IN (SELECT bond_id FROM bond WHERE bond_type = '#');
SELECT DISTINCT element FROM atom WHERE atom_id IN (SELECT atom_id FROM connected WHERE bond_id = 'TR005_16_26') AND element IN ('cl', 'br', 'f', 'i');
SELECT COUNT(*) FROM bond WHERE bond_type = '-' AND molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '-');
SELECT label FROM molecule WHERE molecule_id = (SELECT molecule_id FROM bond WHERE bond_id = 'TR001_10_11');
SELECT bond_id FROM bond WHERE bond_type = '#' AND molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '+' OR label = '-');
SELECT element, COUNT(*) FROM atom WHERE atom_id IN (SELECT atom_id FROM connected WHERE atom_id2 IN (SELECT atom_id FROM connected WHERE atom_id2 IN (SELECT atom_id FROM connected WHERE atom_id2 IN (SELECT atom_id FROM connected WHERE atom_id2 IN (SELECT atom_id FROM connected WHERE atom_id2 IN (SELECT atom_id FROM connected WHERE atom_id2 IN (SELECT atom_id FROM connected WHERE atom_id2 IN (SELECT atom_id FROM connected WHERE atom_id2 IN (SELECT atom_id FROM connected WHERE atom_id2 IN (SELECT atom_id FROM connected WHERE atom_id2 IN (SELECT atom_id FROM connected WHERE atom_id2 IN (SELECT atom_id FROM connected WHERE atom_id2 IN (SELECT atom_id FROM connected WHERE atom_id2 IN (SELECT atom_id FROM connected WHERE atom_id2 IN (SELECT atom_id FROM connected WHERE atom_id2 IN (SELECT atom_id FROM connected WHERE atom_id2 IN (SELECT
SELECT SUM(element = 'h') * 1.0 / COUNT(element), label FROM atom JOIN molecule ON atom.molecule_id = molecule.molecule_id WHERE molecule.molecule_id = 'TR006';
SELECT CASE WHEN label = '+' THEN '+' ELSE '-' END FROM molecule WHERE molecule_id IN (SELECT molecule_id FROM atom WHERE element = 'ca');
SELECT bond_type FROM bond WHERE molecule_id IN (SELECT molecule_id FROM atom WHERE element = 'te') LIMIT 1;
SELECT DISTINCT element FROM atom WHERE atom_id IN (SELECT atom_id FROM connected WHERE bond_id = 'TR001_10_11') UNION SELECT DISTINCT element FROM atom WHERE atom_id IN (SELECT atom_id2 FROM connected WHERE bond_id = 'TR001_10_11');
SELECT COUNT(DISTINCT molecule_id) * 100.0 / COUNT(DISTINCT bond.molecule_id) FROM bond WHERE bond_type = '#';
SELECT CAST(SUM(bond_type = ' = ') AS FLOAT) / COUNT(*) AS percent FROM bond WHERE molecule_id = 'TR047';
SELECT CASE WHEN label = '+' THEN 'YES' ELSE 'NO' END FROM molecule WHERE molecule_id IN (SELECT molecule_id FROM atom WHERE atom_id = 'TR001_1');
SELECT CASE WHEN label = '+' THEN 'YES' ELSE 'NO' END FROM molecule WHERE molecule_id = 'TR151';
SELECT DISTINCT element FROM atom WHERE molecule_id = 'TR151' AND element IN ('Cl', 'Br', 'F', 'I', 'Pb', 'Te');
SELECT COUNT(*) FROM molecule WHERE label = '+';
SELECT atom_id, molecule_id FROM atom WHERE element = 'c' AND molecule_id BETWEEN 'TR010' AND 'TR050';
SELECT COUNT(*) FROM atom WHERE molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '+');
SELECT bond_id FROM bond WHERE bond_type = ' = ' AND molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '+');
SELECT COUNT(*) FROM atom WHERE element = 'h' AND molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '+');
SELECT molecule_id FROM bond WHERE bond_id = (SELECT bond_id FROM connected WHERE atom_id = 'TR00_1' AND atom_id2 = 'TR00_2') AND molecule_id = (SELECT molecule_id FROM atom WHERE atom_id = 'TR00_1');
SELECT atom_id FROM atom WHERE element = 'c' AND molecule_id IN (SELECT molecule_id FROM molecule WHERE label != '-')
SELECT DIVIDE(SUM(label = '+' and element = 'h'), COUNT(molecule_id)) * 100.0 FROM molecule WHERE label = '+';
SELECT CASE WHEN label = '+' THEN 'YES' ELSE 'NO' END FROM molecule WHERE molecule_id = 'TR124';
SELECT atom_id FROM atom WHERE atom_id IN (SELECT atom_id FROM connected WHERE bond_id IN (SELECT bond_id FROM bond WHERE molecule_id = 'TR186')) UNION SELECT atom_id2 FROM atom WHERE atom_id2 IN (SELECT atom_id2 FROM connected WHERE bond_id IN (SELECT bond_id FROM bond WHERE molecule_id = 'TR186'));
SELECT bond_type FROM bond WHERE bond_id = (SELECT bond_id FROM connected WHERE atom_id = 'TR007_4_19' OR atom_id2 = 'TR007_4_19');
SELECT DISTINCT element FROM atom WHERE molecule_id = (SELECT molecule_id FROM bond WHERE bond_id = 'TR001_2_4') ORDER BY element ASC;
SELECT bond_type, label FROM bond JOIN molecule ON bond.molecule_id = molecule.molecule_id WHERE molecule.label = 'TR006';
SELECT molecule_id, element FROM atom WHERE molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '+') ORDER BY molecule_id;
SELECT bond.bond_id, atom.atom_id, atom2.atom_id, molecule.label, atom.element, atom2.element FROM bond JOIN connected ON bond.bond_id = connected.bond_id JOIN atom ON connected.atom_id = atom.atom_id JOIN atom AS atom2 ON connected.atom_id2 = atom2.atom_id JOIN molecule ON bond.molecule_id = molecule.molecule_id WHERE bond.bond_type = '-';
SELECT molecule_id, COUNT(element) AS num_of_elements, GROUP_CONCAT(element) AS elements FROM (SELECT DISTINCT molecule_id, atom_id, element FROM atom WHERE element IN ('cl', 'c', 'h', 'o', 's', 'n', 'p', 'na', 'br', 'f', 'i', 'sn', 'pb', 'te', 'ca') AND molecule_id IN (SELECT molecule_id FROM bond WHERE bond_type = '#') ) GROUP BY molecule_id ORDER BY num_of_elements ASC;
SELECT element FROM atom WHERE atom_id IN (SELECT atom_id FROM connected WHERE bond_id = 'TR000_2_3') UNION SELECT element FROM atom WHERE atom_id IN (SELECT atom_id2 FROM connected WHERE bond_id = 'TR000_2_3');
SELECT COUNT(*) FROM bond WHERE molecule_id IN (SELECT molecule_id FROM atom WHERE element = 'c');
SELECT atom_id FROM atom WHERE molecule_id = 'TR346'; SELECT COUNT(DISTINCT bond_type) FROM bond WHERE molecule_id = 'TR346';
SELECT COUNT(*) FROM bond WHERE bond_type = ' = ' AND molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '+');
SELECT COUNT(*) FROM molecule WHERE molecule_id NOT IN (SELECT molecule_id FROM atom WHERE element = 's') AND molecule_id NOT IN (SELECT molecule_id FROM bond WHERE bond_type = ' = ');
SELECT label FROM molecule WHERE molecule_id = (SELECT molecule_id FROM bond WHERE bond_id = 'TR001_2_4');
SELECT COUNT(*) FROM atom WHERE molecule_id = 'TR005';
SELECT COUNT(*) FROM bond WHERE bond_type = '-';
SELECT molecule_id FROM atom WHERE element = 'cl' AND molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '+');
SELECT DISTINCT molecule_id FROM atom WHERE element = 'c' AND molecule_id NOT IN (SELECT molecule_id FROM molecule WHERE label = '-');
SELECT DIVIDE(COUNT(CASE WHEN label = '+' THEN 1 END AND element = 'cl'), COUNT(molecule_id)) as percentage FROM atom JOIN molecule ON atom.molecule_id = molecule.molecule_id JOIN bond ON bond.molecule_id = molecule.molecule_id JOIN connected ON connected.bond_id = bond.bond_id WHERE label = '+';
SELECT molecule_id FROM bond WHERE bond_id = 'TR001_1_7';
SELECT COUNT(*) FROM atom WHERE element IS NOT NULL AND atom_id IN (SELECT atom_id FROM connected WHERE bond_id = 'TR001_3_4' UNION SELECT atom_id2 FROM connected WHERE bond_id = 'TR001_3_4');
SELECT bond_type FROM bond WHERE bond_id = (SELECT bond_id FROM connected WHERE atom_id = 'TR000_1' AND atom_id2 = 'TR000_2');
SELECT COUNT(*) FROM (SELECT molecule_id FROM atom WHERE atom_id = 'TR000_2') AS a JOIN (SELECT molecule_id FROM atom WHERE atom_id = 'TR000_4') AS b ON a.molecule_id = b.molecule_id;
SELECT element FROM atom WHERE atom_id = 'TR000_1';
SELECT label FROM molecule WHERE molecule_id = 'TR000';
SELECT ROUND(CAST(SUM(bond_type = '-') AS REAL) / CAST(COUNT(bond_id) AS REAL), 2) AS percentage FROM bond;
SELECT COUNT(DISTINCT molecule_id) FROM atom WHERE element = 'n' AND molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '+');
SELECT molecule_id FROM atom JOIN bond ON atom.molecule_id = bond.molecule_id JOIN connected ON atom.atom_id = connected.atom_id JOIN connected AS connected2 ON connected.bond_id = connected2.bond_id JOIN atom AS atom2 ON connected2.atom_id2 = atom2.atom_id WHERE atom.element = 's' AND bond.bond_type = ' = ';
SELECT COUNT(*) FROM molecule WHERE label = '-' AND molecule_id IN (SELECT molecule_id FROM atom GROUP BY molecule_id HAVING COUNT(atom_id) > 5);
SELECT DISTINCT element FROM atom WHERE molecule_id = 'TR024' AND atom_id IN (SELECT atom_id FROM connected WHERE bond_id IN (SELECT bond_id FROM bond WHERE bond_type = '#'));
SELECT atom.molecule_id, COUNT(atom.atom_id) as num_atoms FROM atom JOIN molecule ON atom.molecule_id = molecule.molecule_id WHERE molecule.label = '+' GROUP BY atom.molecule_id ORDER BY num_atoms DESC LIMIT 1;
SELECT DIVIDE(SUM(label = '+'), COUNT(molecule_id)) * 100.0 FROM molecule WHERE molecule_id IN (SELECT molecule_id FROM atom WHERE element = 'h' AND atom_id IN (SELECT atom_id FROM connected WHERE bond_id IN (SELECT bond_id FROM bond WHERE bond_type = '#') AND atom_id2 IN (SELECT atom_id FROM atom WHERE element = 'h')));
SELECT COUNT(*) FROM molecule WHERE label = '+';
SELECT COUNT(DISTINCT molecule_id) FROM bond WHERE bond_type = '-' AND molecule_id BETWEEN 'TR004' and 'TR010';
SELECT COUNT(*) FROM atom WHERE element = 'c' AND molecule_id = (SELECT molecule_id FROM molecule WHERE label = 'TR008');
SELECT element FROM atom WHERE atom_id = 'TR004_7' AND molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '-');
SELECT COUNT(DISTINCT molecule_id) FROM bond WHERE bond_type = ' = ' AND molecule_id IN (SELECT molecule_id FROM atom WHERE element = 'o');
SELECT COUNT(*) FROM molecule WHERE molecule_id IN (SELECT molecule_id FROM bond WHERE bond_type = '#') AND label = '-';
SELECT DISTINCT element, bond_type FROM atom JOIN bond ON atom.molecule_id = bond.molecule_id WHERE atom.molecule_id = 'TR016';
SELECT atom_id FROM atom WHERE element = 'c' AND molecule_id = 'TR012' AND atom_id IN (SELECT atom_id FROM connected WHERE bond_id IN (SELECT bond_id FROM bond WHERE bond_type = ' = ' AND molecule_id = 'TR012'));
SELECT atom_id FROM atom WHERE element = 'o' AND molecule_id IN (SELECT molecule_id FROM molecule WHERE label = '+');
SELECT name FROM cards WHERE cardKingdomFoilId = cardKingdomId AND cardKingdomId is not null;
SELECT name FROM cards WHERE borderColor = 'borderless' AND cardKingdomId IS NOT NULL AND cardKingdomFoilId IS NULL;
SELECT name, faceConvertedManaCost FROM cards WHERE faceConvertedManaCost = (SELECT MAX(faceConvertedManaCost) FROM cards);
SELECT name FROM cards WHERE frameVersion = 2015 AND edhrecRank < 100 ORDER BY name;
SELECT cards.name FROM cards JOIN legalities ON cards.uuid = legalities.uuid WHERE rarity = 'mythic' AND format = 'gladiator' AND status = 'Banned' ORDER BY cards.name;
SELECT legalities.* FROM legalities WHERE legalities.uuid IN (SELECT cards.uuid FROM cards WHERE cards.types = 'Artifact' AND cards.side IS NULL) AND legalities.format = 'vintage';
SELECT cards.id, cards.artist FROM cards JOIN legalities ON cards.uuid = legalities.uuid WHERE (cards.power = '*' OR cards.power IS NULL) AND legalities.format = 'commander' AND legalities.status = 'Legal' ORDER BY cards.artist;
SELECT cards.uuid, rulings.text, cards.hasContentWarning FROM cards JOIN rulings ON cards.uuid = rulings.uuid WHERE cards.artist = 'Stephen Daniele';
SELECT * FROM rulings WHERE uuid = (SELECT uuid FROM cards WHERE name = 'Sublime Epiphany' AND number = '74s');
SELECT cards.name, cards.artist, cards.isPromo FROM cards WHERE cards.uuid = (SELECT rulings.uuid FROM rulings GROUP BY rulings.uuid ORDER BY COUNT(rulings.uuid) DESC LIMIT 1);
SELECT language FROM foreign_data WHERE uuid = (SELECT uuid FROM cards WHERE name = 'Annul' AND number = '29');
SELECT name FROM cards WHERE uuid IN (SELECT uuid FROM foreign_data WHERE language = 'Japanese' AND uuid IS NOT NULL);
SELECT COUNT(id) * 100.0 / (SELECT COUNT(id) FROM foreign_data) AS percentage FROM foreign_data WHERE language = 'Chinese Simplified';
SELECT sets.name, sets.totalSetSize, COUNT(cards.id) AS total_cards FROM sets JOIN set_translations ON sets.code = set_translations.setCode JOIN cards ON sets.code = cards.setCode WHERE set_translations.language = 'Italian' GROUP BY sets.name ORDER BY total_cards DESC;
SELECT COUNT(DISTINCT type) FROM cards WHERE artist LIKE '%Aaron Boyd%';
SELECT keywords FROM cards WHERE name = 'Angel of Mercy';
SELECT COUNT(*) FROM cards WHERE power = '*';
SELECT promoTypes FROM cards WHERE name = 'Duress';
SELECT borderColor FROM cards WHERE name = "Ancestor's Chosen";
SELECT originalType FROM cards WHERE name = "Ancestor's Chosen";
SELECT DISTINCT language FROM set_translations WHERE setCode = (SELECT setCode FROM cards WHERE name = 'Angel of Mercy');
SELECT COUNT(*) FROM legalities l JOIN cards c ON l.uuid = c.uuid WHERE l.status = 'restricted' AND c.isTextless = 0;
SELECT text FROM rulings WHERE uuid = (SELECT uuid FROM cards WHERE name = 'Condemn');
SELECT COUNT(*) FROM legalities l JOIN cards c ON l.uuid = c.uuid WHERE l.status = 'restricted' AND c.isStarter = 1;
SELECT legalities.status FROM legalities JOIN cards ON legalities.uuid = cards.uuid WHERE cards.name = 'Cloudchaser Eagle';
SELECT type FROM cards WHERE name = 'Benalish Knight';
SELECT format FROM legalities WHERE uuid = (SELECT uuid FROM cards WHERE name = 'Benalish Knight');
SELECT DISTINCT artist FROM cards JOIN foreign_data ON cards.uuid = foreign_data.uuid WHERE foreign_data.language = 'Phyrexian';
SELECT ROUND(CAST(COUNT(*) AS FLOAT) / (SELECT COUNT(*) FROM cards) * 100, 2) FROM cards WHERE borderColor = 'borderless';
SELECT COUNT(*) FROM cards WHERE isReprint = 1 AND uuid IN (SELECT uuid FROM foreign_data WHERE language = 'German');
SELECT COUNT(*) FROM cards WHERE borderColor = 'borderless' AND uuid IN (SELECT uuid FROM foreign_data WHERE language = 'Russian');
SELECT ROUND(CAST(COUNT(CASE WHEN language = 'French' THEN 1 END) AS REAL) / COUNT(CASE WHEN isStorySpotlight = 1 THEN 1 END) * 100) FROM cards WHERE isStorySpotlight = 1;
SELECT COUNT(*) FROM cards WHERE toughness = '99';
SELECT name FROM cards WHERE artist = 'Aaron Boyd' ORDER BY name;
SELECT COUNT(*) FROM cards WHERE borderColor = 'black' AND availability = 'mtgo';
SELECT id FROM cards WHERE convertedManaCost = 0;
SELECT layout FROM cards WHERE keywords LIKE '%Flying%';
SELECT COUNT(*) FROM cards WHERE originalType = 'Summon - Angel' AND subtypes != 'Angel';
SELECT cards.cardKingdomFoilId FROM cards JOIN sets ON cards.setCode = sets.code WHERE cards.cardKingdomFoilId IS NOT NULL AND cards.cardKingdomId IS NOT NULL AND cards.isFoil = 1 AND cards.id IN (SELECT cards.id FROM cards JOIN sets ON cards.setCode = sets.code WHERE cards.isFoil = 0 AND cards.cardKingdomId IS NOT NULL AND cards.cardKingdomFoilId IS NULL);
SELECT id FROM cards WHERE duelDeck = 'a';
SELECT edhrecRank FROM cards WHERE frameVersion = '2015';
SELECT DISTINCT artist FROM cards WHERE uuid IN (SELECT uuid FROM foreign_data WHERE language = 'Chinese Simplified');
SELECT cards.name, sets.name FROM cards JOIN sets ON cards.setCode = sets.code WHERE cards.availability = 'paper' AND cards.id IN (SELECT id FROM cards WHERE language = 'Japanese');
SELECT COUNT(*) FROM cards WHERE status = 'Banned' AND borderColor = 'white';
SELECT cards.uuid, foreign_data.language FROM cards JOIN legalities ON cards.uuid = legalities.uuid JOIN foreign_data ON cards.uuid = foreign_data.uuid WHERE legalities.format = 'legacy' ORDER BY cards.uuid;
SELECT text FROM rulings WHERE uuid = (SELECT uuid FROM cards WHERE name = 'Beacon of Immortality');
SELECT COUNT(*) AS future_frame_version_cards, status FROM cards JOIN legalities ON cards.uuid = legalities.uuid WHERE frameVersion = 'future' GROUP BY status;
SELECT DISTINCT c.colors FROM cards c WHERE c.setCode = 'OGW';
SELECT DISTINCT language FROM set_translations WHERE setCode = '10E' AND translation IN (SELECT id FROM cards WHERE setCode = '10E' AND convertedManaCost = 5 AND id IN (SELECT id FROM set_translations WHERE translation IS NOT NULL));
SELECT cards.name, rulings.date FROM cards JOIN rulings ON cards.uuid = rulings.uuid WHERE cards.originalType = 'Creature - Elf' ORDER BY rulings.date ASC;
SELECT colors, format, status FROM cards JOIN legalities ON cards.uuid = legalities.uuid WHERE id BETWEEN 1 AND 20;
SELECT name FROM cards WHERE uuid IN (SELECT uuid FROM foreign_data WHERE language != 'English' AND uuid IN (SELECT uuid FROM cards WHERE originalType = 'Artifact' AND colors = 'B'));
SELECT cards.name FROM cards JOIN rulings ON cards.uuid = rulings.uuid WHERE cards.rarity = 'uncommon' ORDER BY rulings.date ASC LIMIT 3;
SELECT COUNT(*) FROM cards WHERE artist = 'Volcan BaÇµa' AND cardKingdomId IS NOT NULL AND cardKingdomFoilId IS NULL;
SELECT COUNT(*) FROM cards WHERE borderColor = 'white' AND cardKingdomFoilId = cardKingdomId AND cardKingdomId is not null;
SELECT COUNT(*) FROM cards WHERE artist = 'UDON' AND availability = 'mtgo' AND hand = -1;
SELECT COUNT(*) FROM cards WHERE frameVersion = '1993' AND availability = 'paper' AND hasContentWarning = 1;
SELECT SUM(convertedManaCost) FROM cards WHERE layout = 'normal' AND frameVersion = '2003' AND borderColor = 'black' AND availability IN ('paper', 'mtgo');
SELECT SUM(convertedManaCost) FROM cards WHERE artist = 'Rob Alexander';
SELECT types FROM cards WHERE availability = 'arena';
SELECT DISTINCT setCode FROM set_translations WHERE language = 'Spanish' ORDER BY setCode;
SELECT ROUND(DIVIDE(COUNT(hand = '+3'), COUNT(id)), 2) FROM cards WHERE frameEffects = 'legendary';
0
SELECT name FROM cards WHERE uuid IN (SELECT uuid FROM foreign_data WHERE language = 'Spanish') ORDER BY name;
SELECT language FROM set_translations WHERE setCode = (SELECT code FROM sets WHERE baseSetSize = 309);
SELECT COUNT(*) FROM set_translations WHERE language = 'Portuguese (Brasil)' AND setCode IN (SELECT code FROM sets WHERE block = 'Commander');
SELECT id FROM cards WHERE types = 'Creature' AND id IN (SELECT id FROM legalities WHERE status = 'legal') ORDER BY id ASC;
SELECT DISTINCT types FROM cards JOIN foreign_data ON cards.uuid = foreign_data.uuid WHERE language = 'German';
SELECT COUNT(*) FROM cards WHERE ruling_text = 'If you have two Lords of the Pit, you can sacrifice them to each other' AND power IS NULL;
SELECT COUNT(*) FROM cards WHERE format = 'pre-modern' AND uuid NOT IN (SELECT uuid FROM cards WHERE side IS NOT NULL) AND uuid IN (SELECT uuid FROM rulings WHERE text = 'This is a triggered mana ability');
SELECT id FROM cards WHERE artist = 'Erica Yang' AND format = 'pauper' AND availability = 'paper';
SELECT artist FROM cards WHERE uuid IN (SELECT uuid FROM foreign_data WHERE text = 'Das perfekte Gegenmittel zu einer dichten Formation' AND language = 'German');
SELECT foreign_data.name FROM cards JOIN foreign_data ON cards.uuid = foreign_data.uuid WHERE cards.artist = 'Matthew D. Wilson' AND cards.type LIKE '%Creature%' AND cards.layout = 'normal' AND cards.borderColor = 'black' AND foreign_data.language = 'French';
SELECT COUNT(*) FROM cards WHERE rarity = 'rare' AND uuid IN (SELECT uuid FROM rulings WHERE date = '2009-01-10');
SELECT language FROM set_translations WHERE setCode = 'RAV' AND baseSetSize = 180;
SELECT DIVIDE(COUNT(hasContentWarning = 0),COUNT(ID))*100 FROM cards JOIN legalities ON cards.uuid = legalities.uuid WHERE format = 'commander' AND Status = 'legal';
SELECT COUNT(language = 'French' and power is NULL or power = '*')*100.0/COUNT( power is NULL or power = '*') AS percentage FROM cards;
SELECT ROUND(DIVIDE(COUNT(DISTINCT set_translations.setCode, sets.type = 'expansion' AND set_translations.language = 'Japanese'), COUNT(DISTINCT set_translations.setCode, set_translations.language = 'Japanese'))*100) FROM set_translations JOIN sets ON set_translations.setCode = sets.code;
SELECT availability FROM cards WHERE artist = 'Daren Bader';
SELECT COUNT(*) FROM cards WHERE borderColor = 'borderless' AND edhrecRank > 12000;
SELECT COUNT(*) FROM cards WHERE isOversized = 1 OR isReprint = 1 OR isPromo = 1;
SELECT name FROM cards WHERE (power is null or power = '*') AND promoTypes = 'arenaleague' LIMIT 3;
SELECT language FROM foreign_data WHERE uuid = (SELECT uuid FROM cards WHERE multiverseId = 149934);
SELECT cardKingdomFoilId, cardKingdomId, COUNT(*) FROM cards WHERE cardKingdomFoilId = cardKingdomId AND cardKingdomId is not null GROUP BY cardKingdomFoilId, cardKingdomId ORDER BY COUNT(*) DESC LIMIT 3;
SELECT ROUND(DIVIDE(COUNT(Textless = 1 and layout = 'normal'),COUNT(Textless))*100,2) FROM cards WHERE layout = 'normal';
SELECT number FROM cards WHERE uuid IN (SELECT uuid FROM cards WHERE subtypes LIKE '%Angel%' AND subtypes LIKE '%Wizard%') AND uuid IN (SELECT uuid FROM cards WHERE side IS NULL) ORDER BY number;
SELECT sets.name FROM sets WHERE sets.mtgoCode IS NULL OR sets.mtgoCode = '' ORDER BY sets.releaseDate ASC LIMIT 3;
SELECT language FROM set_translations WHERE setCode = 'ARC' AND mcmName = 'Archenemy' ORDER BY language;
SELECT sets.name, set_translations.translation FROM sets JOIN set_translations ON sets.code = set_translations.setCode WHERE sets.id = 5;
SELECT language, type FROM sets WHERE id = 206;
SELECT set_translations.setCode, sets.id FROM set_translations JOIN sets ON set_translations.setCode = sets.code WHERE set_translations.language = 'Italian' AND sets.block = 'Shadowmoor' ORDER BY sets.id;
SELECT s.id FROM sets s WHERE s.isForeignOnly = 0 AND s.isFoilOnly = 1 AND s.id IN (SELECT setCode FROM set_translations WHERE language = 'Japanese');
SELECT setCode FROM set_translations WHERE language = 'Russian' AND setCode IN (SELECT setCode FROM sets) AND baseSetSize = (SELECT MAX(baseSetSize) FROM sets);
SELECT DIVIDE(COUNT(isOnlineOnly = 1),COUNT(isOnlineOnly))*100 FROM cards WHERE language = 'Chinese Simplified';
SELECT COUNT(*) FROM sets WHERE language = 'Japanese' AND (mtgoCode is null or mtgoCode = '');
SELECT COUNT(*), id FROM cards WHERE borderColor = 'black' GROUP BY id;
SELECT COUNT(*) FROM cards WHERE frameEffects = 'extendedart';
SELECT name, convertedManaCost FROM cards WHERE borderColor = 'black' AND isFullArt = 1;
SELECT language FROM set_translations WHERE setCode = (SELECT setCode FROM sets WHERE id = 174);
SELECT name FROM sets WHERE code = 'ALL';
SELECT language FROM foreign_data WHERE uuid = (SELECT uuid FROM cards WHERE name = 'A Pedra Fellwar');
SELECT code FROM sets WHERE releaseDate = '2007-07-13';
SELECT baseSetSize, code FROM sets WHERE block = 'Masques' OR block = 'Mirage';
SELECT code FROM sets WHERE type = 'expansion';
0
SELECT cards.types FROM cards WHERE cards.watermark = 'colorpie';
SELECT ROUND(CAST(COUNT(CASE WHEN convertedManaCost = 10 THEN 1 ELSE NULL END) AS FLOAT) / COUNT(*) * 100, 2) AS percentage FROM cards WHERE setCode = (SELECT code FROM sets WHERE name = 'Abyssal Horror');
SELECT code FROM sets WHERE type = 'expansion' OR type = 'commander';
SELECT foreign_data.name, cards.type, legalities.format, legalities.status FROM cards JOIN foreign_data ON cards.uuid = foreign_data.uuid JOIN legalities ON cards.uuid = legalities.uuid WHERE cards.watermark = 'Abzan' AND foreign_data.language != 'English';
SELECT language, type FROM cards WHERE watermark = 'Azorius';
SELECT COUNT(*) FROM cards WHERE artist = 'Aaron Miller' AND cardKingdomFoilId = cardKingdomId AND cardKingdomId is not null;
SELECT COUNT(*) FROM cards WHERE hand LIKE '+%' AND availability LIKE '%paper%';
SELECT name FROM cards WHERE isTextless = 0 ORDER BY name;
SELECT convertedManaCost FROM cards WHERE name = 'Ancestor`s Chosen';
SELECT COUNT(*) FROM cards WHERE borderColor = 'white' AND (power = '*' OR power IS NULL);<|im_end|>
SELECT name FROM cards WHERE isPromo = 1 AND side IS NOT NULL;
SELECT types FROM cards WHERE name = 'Molimo, Maro-Sorcerer';
SELECT purchaseUrls FROM cards WHERE promoTypes = 'bundle';
SELECT COUNT(DISTINCT artist) FROM cards WHERE borderColor = 'black' AND availability LIKE '%arena,mtgo%';
SELECT name, convertedManaCost FROM cards WHERE name = 'Serra Angel' OR name = 'Shrine Keeper' ORDER BY convertedManaCost DESC LIMIT 1;
SELECT artist FROM cards WHERE uuid = (SELECT uuid FROM cards WHERE flavorName = 'Battra, Dark Destroyer');
SELECT name FROM cards WHERE frameVersion = '2003' ORDER BY convertedManaCost DESC LIMIT 3;
SELECT translation FROM set_translations WHERE setCode = (SELECT setCode FROM cards WHERE name = "Ancestor's Chosen") AND language = 'Italian';
SELECT COUNT(*) FROM set_translations WHERE setCode = (SELECT setCode FROM cards WHERE name = 'Angel of Mercy');
SELECT name FROM cards WHERE setCode = (SELECT setCode FROM set_translations WHERE translation = 'Hauptset Zehnte Edition') ORDER BY name;
SELECT name FROM cards WHERE uuid IN (SELECT uuid FROM foreign_data WHERE language = 'Korean' AND uuid IN (SELECT uuid FROM cards WHERE name = "Ancestor's Chosen"));
SELECT COUNT(*) FROM cards WHERE artist = 'Adam Rex' AND setCode = (SELECT code FROM sets WHERE translation = 'Hauptset Zehnte Edition');
SELECT baseSetSize FROM sets WHERE name = 'Hauptset Zehnte Edition';
SELECT translation FROM set_translations WHERE setCode = (SELECT code FROM sets WHERE name = 'Eighth Edition') AND language = 'Simplified Chinese';
SELECT CASE WHEN mtgoCode IS NOT NULL THEN 'Yes' ELSE 'No' END FROM cards WHERE name = 'Angel of Mercy';
SELECT releaseDate FROM sets WHERE name = 'Ancestor''s Chosen';
SELECT type FROM sets WHERE code = (SELECT setCode FROM set_translations WHERE translation = 'Hauptset Zehnte Edition');
SELECT COUNT(*) FROM set_translations WHERE setCode IN (SELECT code FROM sets WHERE block = 'Ice Age') AND language = 'Italian';
SELECT CASE WHEN isForeignOnly = 1 THEN 'Yes' ELSE 'No' END FROM sets WHERE name = 'Adarkar Valkyrie';
SELECT COUNT(*) FROM set_translations WHERE language = 'Italian' AND EXISTS (SELECT * FROM sets WHERE sets.code = set_translations.setCode AND sets.baseSetSize < 10);
SELECT COUNT(*) FROM cards WHERE setCode = (SELECT code FROM sets WHERE name = 'Coldsnap') AND borderColor = 'black';
SELECT name FROM cards WHERE setCode = (SELECT code FROM sets WHERE name = 'Coldsnap') AND convertedManaCost = (SELECT MAX(convertedManaCost) FROM cards WHERE setCode = (SELECT code FROM sets WHERE name = 'Coldsnap')) ORDER BY name ASC;
SELECT DISTINCT cards.artist, cards.name FROM cards WHERE cards.setCode = (SELECT sets.code FROM sets WHERE sets.name = 'Coldsnap') AND cards.artist IN ('Jeremy Jarvis', 'Aaron Miller','Chippy');
SELECT name FROM cards WHERE uuid = (SELECT uuid FROM cards WHERE setCode = (SELECT code FROM sets WHERE name = 'Coldsnap') AND number = 4);
SELECT COUNT(*) FROM cards T1 WHERE T1.convertedManaCost > 5 AND T1.setCode = 'Coldsnap' AND (T1.power = '*' OR T1.power IS NULL);
SELECT flavorText FROM foreign_data WHERE uuid = (SELECT uuid FROM cards WHERE name = 'Ancestor''s Chosen') AND language = 'Italian';
SELECT DISTINCT language FROM foreign_data WHERE uuid = (SELECT uuid FROM cards WHERE name = 'Ancestor''s Chosen' AND flavorText IS NOT NULL);
SELECT type FROM cards WHERE uuid = (SELECT uuid FROM cards WHERE name = 'Ancestor''s Chosen');
SELECT rulings.text FROM rulings JOIN cards ON rulings.uuid = cards.uuid WHERE cards.setCode = (SELECT code FROM sets WHERE name = 'Coldsnap') AND rulings.id IN (SELECT MAX(id) FROM rulings GROUP BY uuid) AND rulings.id IN (SELECT MAX(id) FROM rulings WHERE rulings.text IS NOT NULL GROUP BY uuid) AND rulings.id IN (SELECT MAX(id) FROM rulings WHERE rulings.text IS NOT NULL AND rulings.language = 'Italian' GROUP BY uuid) ORDER BY cards.name;
0
SELECT date FROM rulings WHERE uuid = (SELECT uuid FROM cards WHERE name = 'Reminisce');
SELECT ROUND(DIVIDE(SUM(convertedManaCost = 7), SUM(convertedManaCost))*100, 2) FROM cards WHERE setCode = 'Coldsnap';<|im_end|>
SELECT ROUND(DIVIDE(SUM(cardKingdomFoilId = cardKingdomId AND cardKingdomId is not null), SUM(name = 'Coldsnap'))*100, 2) FROM cards WHERE setCode = 'CSP';
SELECT code FROM sets WHERE releaseDate = '2017-07-14';
SELECT keyruneCode FROM sets WHERE code = 'PKHC';
SELECT mcmId FROM sets WHERE code = 'SS2';
SELECT mcmName FROM set_translations WHERE setCode = (SELECT code FROM sets WHERE releaseDate = '2017-06-09');
SELECT type FROM sets WHERE name = 'From the Vault: Lore';
SELECT parentCode FROM sets WHERE name = 'Commander 2014 Oversized';
SELECT COUNT(*) FROM cards WHERE hasContentWarning = 1 AND uuid IN (SELECT uuid FROM cards WHERE artist = 'Jim Pavelec');
SELECT releaseDate FROM sets WHERE code = (SELECT setCode FROM cards WHERE name = 'Evacuation');
SELECT baseSetSize FROM sets WHERE code = (SELECT setCode FROM set_translations WHERE translation = 'Rinascita di Alara');
SELECT type FROM sets WHERE code = (SELECT setCode FROM set_translations WHERE translation = 'Huitième édition');
SELECT translation FROM set_translations WHERE setCode = (SELECT setCode FROM cards WHERE name = 'Tendo Ice Bridge') AND language = 'French';
SELECT COUNT(*) FROM set_translations WHERE setCode = (SELECT code FROM sets WHERE name = 'Salvat 2011') AND translation IS NOT NULL;
SELECT translation FROM set_translations WHERE setCode = (SELECT setCode FROM cards WHERE name = 'Fellwar Stone') AND language = 'Japanese';
SELECT name, convertedManaCost FROM cards WHERE setCode = (SELECT code FROM sets WHERE name = 'Journey into Nyx Hero''s Path') ORDER BY convertedManaCost DESC LIMIT 1;
SELECT releaseDate FROM sets WHERE code = (SELECT setCode FROM set_translations WHERE translation = 'Ola de frío');
SELECT type FROM sets WHERE code = (SELECT setCode FROM cards WHERE name = 'Samite Pilgrim');
SELECT COUNT(*) FROM cards WHERE setCode = (SELECT code FROM sets WHERE name = 'World Championship Decks 2004') AND convertedManaCost = 3;
SELECT translation FROM set_translations WHERE setCode = 'MRD' AND language = 'Chinese Simplified';
SELECT DIVIDE(SUM(isNonFoilOnly = 1), SUM(language = 'Japanese'))*100 FROM sets JOIN set_translations ON sets.code = set_translations.setCode WHERE set_translations.language = 'Japanese';
SELECT DIVIDE(SUM(isOnlineOnly = 1), SUM(language = 'Portuguese (Brazil)'))*100 FROM cards WHERE language = 'Portuguese (Brazil)';
SELECT DISTINCT availability FROM cards WHERE artist = 'Aleksi Briclot' AND isTextless = 1 AND availability IS NOT NULL;
SELECT id FROM sets WHERE baseSetSize = (SELECT MAX(baseSetSize) FROM sets);
SELECT artist FROM cards WHERE side IS NULL AND convertedManaCost = (SELECT MAX(convertedManaCost) FROM cards WHERE side IS NULL) ORDER BY artist ASC LIMIT 1;
SELECT MAX(frameEffects) FROM cards WHERE cardKingdomFoilId IS NOT NULL AND cardKingdomId IS NOT NULL;
SELECT COUNT(*) FROM cards WHERE (power IS NULL OR power = '*') AND hasFoil = 0 AND duelDeck = 'a';
SELECT id FROM sets WHERE type = 'commander' AND totalSetSize = (SELECT MAX(totalSetSize) FROM sets WHERE type = 'commander');
SELECT name, convertedManaCost FROM cards WHERE format = 'duel' ORDER BY convertedManaCost DESC LIMIT 10;
SELECT MIN(originalReleaseDate), format FROM cards JOIN legalities ON cards.uuid = legalities.uuid WHERE rarity = 'mythic' AND status = 'legal';
SELECT COUNT(*) FROM cards c JOIN foreign_data f ON c.uuid = f.uuid WHERE c.artist = 'Volkan Baga' AND f.language = 'French';
SELECT COUNT(*) FROM cards c JOIN legalities l ON c.uuid = l.uuid WHERE rarity = 'rare' AND types = 'Enchantment' AND name = 'Abundance' AND status = 'Legal';
SELECT legalities.format, cards.name FROM legalities JOIN cards ON legalities.uuid = cards.uuid WHERE legalities.status = 'banned' AND legalities.format = (SELECT legalities.format FROM legalities WHERE legalities.status = 'banned' GROUP BY legalities.format ORDER BY COUNT(*) DESC LIMIT 1) GROUP BY legalities.format, cards.name;
SELECT language FROM set_translations WHERE setCode = 'BBD';
SELECT legalities.format FROM legalities WHERE legalities.uuid IN (SELECT cards.uuid FROM cards WHERE cards.artist = (SELECT cards.artist FROM cards GROUP BY cards.artist ORDER BY COUNT(*) ASC LIMIT 1));
SELECT status FROM cards JOIN legalities ON cards.uuid = legalities.uuid WHERE frameVersion = '1997' AND artist = 'D. Alexander Gregory' AND format = 'legacy' AND (hasContentWarning = 1 OR name = 'Wizards of the Coast');
SELECT cards.name, legalities.format FROM cards JOIN legalities ON cards.uuid = legalities.uuid WHERE edhrecRank = 1 AND status = 'banned' ORDER BY cards.name;
SELECT strftime('%Y', releaseDate) AS year, AVG(id) AS avg_sets, MAX(language) AS common_language FROM sets WHERE releaseDate BETWEEN '2012-01-01' AND '2015-12-31' GROUP BY year ORDER BY year ASC;
SELECT DISTINCT artist FROM cards WHERE borderColor = 'black' AND availability = 'arena' ORDER BY artist;
SELECT uuid FROM legalities WHERE format = 'oldschool' AND status IN ('banned', 'restricted');
SELECT COUNT(*) FROM cards WHERE artist = 'Matthew D. Wilson' AND availability = 'paper';
SELECT date, text FROM rulings WHERE uuid IN (SELECT uuid FROM cards WHERE artist = 'Kev Walker') ORDER BY date DESC;
SELECT cards.name, legalities.format FROM cards JOIN sets ON cards.setCode = sets.code JOIN legalities ON cards.uuid = legalities.uuid WHERE sets.name = 'Hour of Devastation' AND legalities.status = 'legal' ORDER BY cards.name, legalities.format;
SELECT sets.name FROM sets WHERE sets.code IN (SELECT set_translations.setCode FROM set_translations WHERE set_translations.language = 'Korean') AND sets.code NOT IN (SELECT set_translations.setCode FROM set_translations WHERE set_translations.language NOT LIKE '%Japanese%') ORDER BY sets.name;
SELECT sets.frameVersion, cards.name, legalities.status FROM cards JOIN sets ON cards.setCode = sets.code JOIN legalities ON cards.uuid = legalities.uuid WHERE cards.artist = 'Allen Williams' OR legalities.status = 'banned' OR sets.frameVersion IS NOT NULL ORDER BY sets.frameVersion ASC;
SELECT DisplayName FROM users WHERE Reputation = (SELECT MAX(Reputation) FROM users);
SELECT DisplayName FROM users WHERE year(CreationDate) = 2014 ORDER BY DisplayName;
SELECT COUNT(*) FROM users WHERE LastAccessDate > '2014-09-01 00:00:00';
SELECT DisplayName FROM users WHERE Views = (SELECT MAX(Views) FROM users);
SELECT COUNT(*) FROM users WHERE Upvotes > 100 AND Downvotes > 1;
SELECT COUNT(*) FROM users WHERE Views > 10 AND year(CreationDate) > 2013;
SELECT COUNT(*) FROM posts WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'csgillespie');
SELECT Title FROM posts WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'csgillespie');
SELECT DisplayName FROM users WHERE Id = (SELECT OwnerUserId FROM posts WHERE Title = "Eliciting priors from experts");
SELECT Title FROM posts WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'csgillespie') ORDER BY ViewCount DESC LIMIT 1;
SELECT OwnerDisplayName FROM posts WHERE FavoriteCount = (SELECT MAX(FavoriteCount) FROM posts);
SELECT SUM(CommentCount) FROM posts WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'csgillespie');
SELECT MAX(AnswerCount) FROM posts WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'csgillespie') AND PostTypeId = 1;
SELECT DisplayName FROM users WHERE Id = (SELECT LastEditorUserId FROM posts WHERE Title = 'Examples for teaching: Correlation does not mean causation' AND LastEditorUserId IS NOT NULL);
SELECT COUNT(*) FROM posts WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'csgillespie') AND ParentId IS NULL;
SELECT DISTINCT users.DisplayName FROM users JOIN posts ON users.Id = posts.OwnerUserId WHERE posts.ClosedDate IS NOT NULL;
SELECT COUNT(*) FROM posts WHERE OwnerUserId IN (SELECT Id FROM users WHERE Age > 65) AND Score >= 20;
SELECT Location FROM users WHERE Id = (SELECT OwnerUserId FROM posts WHERE Id = 4);
SELECT Body FROM posts WHERE Id = (SELECT ExcerptPostId FROM tags WHERE TagName = 'bayesian');
SELECT posts.Body FROM posts JOIN tags ON posts.Id = tags.ExcerptPostId WHERE tags.Count = (SELECT MAX(Count) FROM tags);
SELECT COUNT(*) FROM badges WHERE UserId = (SELECT Id FROM users WHERE DisplayName = 'csgillespie');
SELECT Name FROM badges WHERE UserId = (SELECT Id FROM users WHERE DisplayName = 'csgillespie') ORDER BY Date;
SELECT COUNT(*) FROM badges WHERE UserId = (SELECT Id FROM users WHERE DisplayName = 'csgillespie') AND strftime('%Y', Date) = '2011';
SELECT UserDisplayName FROM badges WHERE UserId = (SELECT UserId FROM badges GROUP BY UserId ORDER BY COUNT(Id) DESC LIMIT 1);
SELECT AVG(Score) FROM posts WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'csgillespie');
SELECT AVG(badges) FROM (SELECT COUNT(Id) AS badges, DisplayName FROM badges JOIN users ON badges.UserId = users.Id WHERE users.Views > 200 GROUP BY DisplayName);
SELECT COUNT(DISTINCT users.Id)*100/COUNT(DISTINCT posts.Id) FROM posts JOIN users ON posts.OwnerUserId = users.Id WHERE posts.Score > 20 AND users.Age > 65;
SELECT COUNT(*) FROM votes WHERE UserId = 58 AND CreationDate = '2010-07-19';
SELECT CreationDate FROM votes GROUP BY CreationDate ORDER BY COUNT(Id) DESC LIMIT 1;
SELECT COUNT(*) FROM badges WHERE Name = 'Revival';
SELECT posts.Title FROM posts WHERE posts.Id = (SELECT comments.PostId FROM comments WHERE comments.Score = (SELECT MAX(comments.Score) FROM comments));
SELECT COUNT(*) FROM comments WHERE PostId = (SELECT Id FROM posts WHERE ViewCount = 1910);
SELECT FavoriteCount FROM posts WHERE Id = (SELECT PostId FROM comments WHERE UserId = 3025 AND CreationDate = '2014/4/23 20:29:39');
SELECT Text FROM comments WHERE PostId = 107829 AND CommentCount = 1;
SELECT posts.Title FROM comments JOIN posts ON comments.PostId = posts.Id WHERE comments.UserId = 23853 AND comments.CreationDate = '2013/7/12 9:08:18' AND posts.ClosedDate IS NOT NULL;
SELECT Reputation FROM users WHERE Id = (SELECT OwnerUserId FROM posts WHERE Id = 65041);
SELECT COUNT(*) FROM posts WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'Tiago Pasqualini');
SELECT DisplayName FROM users WHERE Id = (SELECT UserId FROM votes WHERE Id = 381800);
SELECT COUNT(*) FROM votes WHERE PostId = (SELECT Id FROM posts WHERE Title LIKE '%data visualization%');
SELECT badges.Name FROM badges JOIN users ON badges.UserId = users.Id WHERE users.DisplayName = "DatEpicCoderGuyWhoPrograms";
SELECT ROUND(CAST(COUNT(posts.Id) AS FLOAT) / CAST(COUNT(votes.Id) AS FLOAT), 2) FROM posts JOIN users ON posts.OwnerUserId = users.Id JOIN votes ON posts.Id = votes.PostId WHERE users.Id = 24;
SELECT ViewCount FROM posts WHERE Title = 'Integration of Weka and/or RapidMiner into Informatica PowerCenter/Developer';
SELECT Text FROM comments WHERE Score = 17 ORDER BY CreationDate;
SELECT DisplayName FROM users WHERE WebsiteUrl = 'http://blue-feet.com?';
SELECT Name FROM badges WHERE UserId = (SELECT Id FROM users WHERE DisplayName = 'SilentGhost');
SELECT DisplayName FROM users WHERE Id = (SELECT UserId FROM comments WHERE Text = 'thank you user93!' AND PostId = 102);
SELECT comments.PostId, comments.Text FROM comments JOIN users ON comments.UserId = users.Id JOIN posts ON comments.PostId = posts.Id WHERE users.DisplayName = 'A Lion.';
SELECT users.DisplayName, users.Reputation FROM users JOIN posts ON users.Id = posts.OwnerUserId WHERE posts.Title = 'Understanding what Dassault iSight is doing?';
SELECT Text FROM comments WHERE PostId = (SELECT Id FROM posts WHERE Title = 'How does gentle boosting differ from AdaBoost?');
SELECT DisplayName FROM users WHERE Id IN (SELECT UserId FROM badges WHERE Name = 'Necromancer');
SELECT users.DisplayName FROM users JOIN posts ON users.Id = posts.LastEditorUserId WHERE posts.Title = 'Open source tools for visualizing multi-dimensional data';
SELECT posts.Title FROM posts JOIN postHistory ON posts.Id = postHistory.PostId WHERE postHistory.LastEditorUserId = (SELECT Id FROM users WHERE DisplayName = 'Vebjorn Ljosa') ORDER BY postHistory.CreationDate DESC;
SELECT SUM(posts.Score), users.WebsiteUrl FROM posts JOIN users ON posts.LastEditorUserId = users.Id WHERE users.DisplayName = 'Yevgeny';
SELECT comments.Text FROM comments JOIN postHistory ON comments.PostId = postHistory.Id JOIN users ON postHistory.UserId = users.Id JOIN posts ON postHistory.PostId = posts.Id WHERE posts.Title = 'Why square the difference instead of taking the absolute value in standard deviation?' AND comments.UserId = users.Id;
SELECT SUM(BountyAmount) FROM votes WHERE PostId IN (SELECT Id FROM posts WHERE Title LIKE '%data%');
SELECT users.DisplayName FROM users JOIN votes ON users.Id = votes.UserId JOIN posts ON posts.Id = votes.PostId WHERE posts.Title = 'Variance of a difference in marginal proportions in a three-way contingency table' AND votes.BountyAmount = 50;
SELECT posts.Title, comments.Text, posts.Score, AVG(posts.ViewCount) FROM posts JOIN postLinks ON posts.Id = postLinks.PostId JOIN tags ON tags.Id = postLinks.RelatedPostId JOIN comments ON comments.PostId = posts.Id WHERE tags.TagName = 'humor' GROUP BY posts.Title ORDER BY posts.Score DESC;
SELECT COUNT(*) FROM comments WHERE UserId = 13;
SELECT Id FROM users ORDER BY Reputation DESC LIMIT 1;
SELECT Id FROM users WHERE Views = (SELECT MIN(Views) FROM users);
SELECT COUNT(DISTINCT UserId) FROM badges WHERE Name = 'Supporter' AND year(Date) = 2011;
SELECT COUNT(DISTINCT UserId) FROM badges GROUP BY UserId HAVING COUNT(Name) > 5;
SELECT COUNT(*) FROM badges WHERE Name = 'Teacher' AND UserId IN (SELECT UserId FROM badges WHERE Name = 'Supporter' AND UserId IN (SELECT Id FROM users WHERE Location = 'New York'));
SELECT users.DisplayName, users.Reputation FROM users JOIN posts ON users.Id = posts.OwnerUserId WHERE posts.Id = 1;
SELECT DISTINCT u.Id, u.DisplayName FROM users u JOIN (SELECT p.OwnerUserId, COUNT(*) AS cnt FROM posts p JOIN postHistory ph ON p.Id = ph.PostId GROUP BY p.Id HAVING cnt = 1) p ON u.Id = p.OwnerUserId JOIN postLinks pl ON p.Id = pl.PostId JOIN posts p2 ON pl.RelatedPostId = p2.Id WHERE p2.ViewCount >= 1000;
SELECT users.*, badges.* FROM users JOIN (SELECT UserId, COUNT(Id) AS comment_count FROM comments GROUP BY UserId ORDER BY comment_count DESC LIMIT 1) AS user_comments ON users.Id = user_comments.UserId JOIN badges ON users.Id = badges.UserId;
SELECT COUNT(*) FROM badges WHERE UserId IN (SELECT Id FROM users WHERE Location = 'India') AND Name = 'Teacher';
SELECT ROUND((CAST((SELECT COUNT(Name) FROM badges WHERE strftime('%Y', Date) = '2010') AS FLOAT) / CAST((SELECT COUNT(Name) FROM badges) AS FLOAT) * 100 - CAST((SELECT COUNT(Name) FROM badges WHERE strftime('%Y', Date) = '2011') AS FLOAT) / CAST((SELECT COUNT(Name) FROM badges) AS FLOAT) * 100) , 2) AS percentage_difference;
SELECT postHistoryTypeId FROM postHistory WHERE PostId = 3720; SELECT COUNT(DISTINCT UserId) FROM comments WHERE PostId = 3720;
SELECT * FROM postLinks WHERE PostId = 61217 OR RelatedPostId = 61217; SELECT ViewCount FROM posts WHERE Id = 61217;
SELECT Score, LinkTypeId FROM posts WHERE Id = 395;
SELECT posts.Id, posts.OwnerUserId FROM posts WHERE Score > 60 ORDER BY posts.Id ASC;
SELECT SUM(FavoriteCount) FROM posts WHERE OwnerUserId = 686 AND CreaionDate BETWEEN '2011-01-01' AND '2011-12-31';
SELECT AVG(Divide(Sum(UpVotes), Count(UserId))) AS avg_up_votes, AVG(Divide(Sum(Age), Count(UserId))) AS avg_user_age FROM users WHERE (SELECT COUNT(*) FROM posts WHERE OwnerUserId = users.Id) > 10;
SELECT COUNT(DISTINCT UserId) FROM badges WHERE Name = 'Announcer';
SELECT Name FROM badges WHERE Date = '2010-07-19 19:39:08' ORDER BY Name;
SELECT COUNT(*) FROM comments WHERE score > 60;
SELECT Text FROM comments WHERE CreationDate = '2010-07-19 19:25:47';
SELECT COUNT(*) FROM posts WHERE Score = 10;
SELECT Name FROM badges WHERE UserId IN (SELECT Id FROM users WHERE Reputation = (SELECT MAX(Reputation) FROM users)) ORDER BY Name ASC;
SELECT users.Reputation FROM users JOIN badges ON users.Id = badges.UserId WHERE badges.Date = '2010-07-19 19:39:08' ORDER BY users.Reputation DESC;
SELECT badges.Name FROM badges JOIN users ON badges.UserId = users.Id WHERE users.DisplayName = 'Pierre';
SELECT Date FROM badges WHERE UserId IN (SELECT Id FROM users WHERE Location = 'Rochester, NY') ORDER BY Date;
SELECT COUNT(DISTINCT UserId) * 100 / (SELECT COUNT(DISTINCT UserId) FROM badges WHERE Name = 'Teacher') FROM users WHERE Reputation = (SELECT MAX(Reputation) FROM users WHERE Id IN (SELECT DISTINCT UserId FROM badges WHERE Name = 'Teacher'));
SELECT ROUND(CAST(COUNT(CASE WHEN age BETWEEN 13 AND 18 THEN 1 ELSE NULL END) AS FLOAT) / COUNT(users.Id) * 100, 2) AS percentage FROM badges JOIN users ON badges.UserId = users.Id WHERE badges.Name = 'Organizer';
SELECT SUM(Score) FROM comments WHERE PostId = (SELECT Id FROM posts WHERE CreaionDate = '2010-07-19 19:14:43');
SELECT Text FROM comments WHERE PostId = (SELECT Id FROM posts WHERE CreaionDate = '2010-07-19 19:37:33') LIMIT 1;
SELECT age FROM users WHERE Location = 'Vienna, Austria' AND Id IN (SELECT UserId FROM badges WHERE Name IS NOT NULL);
SELECT COUNT(*) FROM badges WHERE Name = 'Supporter' AND UserId IN (SELECT Id FROM users WHERE Age BETWEEN 19 AND 65);
SELECT SUM(views) FROM users WHERE Id IN (SELECT UserId FROM badges WHERE Date = '2010-07-19 19:39:08');
SELECT Name FROM badges WHERE UserId IN (SELECT Id FROM users WHERE Reputation = (SELECT MIN(Reputation) FROM users));
SELECT Name FROM badges WHERE UserId = (SELECT Id FROM users WHERE DisplayName = 'Sharpie');
SELECT COUNT(*) FROM badges WHERE Name = 'Supporter' AND UserId IN (SELECT Id FROM users WHERE Age > 65);
SELECT DisplayName FROM users WHERE Id = 30;
SELECT COUNT(*) FROM users WHERE Location = 'New York';
SELECT COUNT(*) FROM votes WHERE YEAR(CreationDate) = 2010;
SELECT COUNT(*) FROM users WHERE Age BETWEEN 19 and 65;
SELECT DisplayName, Views FROM users ORDER BY Views DESC LIMIT 10;
SELECT COUNT(Id) FROM votes WHERE YEAR(CreationDate) = 2010; SELECT COUNT(Id) FROM votes WHERE YEAR(CreationDate) = 2011; SELECT COUNT(Id where YEAR(CreationDate) = 2010) / COUNT(Id where YEAR(CreationDate) = 2011) FROM votes;
SELECT tags.TagName FROM tags JOIN postTags ON tags.Id = postTags.TagId JOIN posts ON postTags.PostId = posts.Id WHERE posts.OwnerUserId = 48;
SELECT COUNT(*) FROM posts WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'Daniel Vassallo');
SELECT COUNT(*) FROM votes WHERE UserId = (SELECT Id FROM users WHERE DisplayName = 'Harlan');
SELECT Id FROM posts WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'slashnick') AND AnswerCount = (SELECT MAX(AnswerCount) FROM posts);
SELECT MAX(SUM(ViewCount)) FROM posts WHERE OwnerDisplayName = 'Harvey Motulsky' OR OwnerDisplayName = 'Noah Snyder';
SELECT COUNT(*) FROM votes WHERE PostId IN (SELECT Id FROM posts WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'Matt Parker')) AND VoteTypeId = 2 AND PostId > 100;
SELECT COUNT(*) FROM comments WHERE UserId = (SELECT Id FROM users WHERE DisplayName = 'Neil McGuigan') AND Score < 60;
SELECT tags.TagName FROM tags JOIN posts ON tags.Id = posts.Id JOIN users ON posts.OwnerUserId = users.Id WHERE users.DisplayName = 'Mark Meckes' AND posts.CommentCount > 10 ORDER BY tags.TagName ASC;
SELECT DisplayName FROM users WHERE Id IN (SELECT UserId FROM badges WHERE Name = 'Organizer') ORDER BY DisplayName;
SELECT ROUND(CAST(COUNT(CASE WHEN DisplayName = 'Community' THEN PostId END AND TagName = 'r') AS FLOAT) / COUNT(CASE WHEN DisplayName = 'Community' THEN PostId END), 2) AS percentage FROM posts JOIN users ON posts.OwnerUserId = users.Id JOIN postTags ON posts.Id = postTags.PostId JOIN tags ON postTags.TagId = tags.Id;
SELECT (SELECT SUM(ViewCount) FROM posts WHERE OwnerDisplayName = 'Mornington') - (SELECT SUM(ViewCount) FROM posts WHERE OwnerDisplayName = 'Amos') AS difference;
SELECT COUNT(*) FROM badges WHERE Name = 'commentator' AND year(Date) = 2014;
SELECT COUNT(*) FROM posts WHERE CreationDate BETWEEN '2010-07-21 00:00:00' and '2012-07-21 23:59:59';
SELECT DisplayName, Age FROM users WHERE Views = (SELECT MAX(Views) FROM users);
SELECT LastEditDate, LastEditorUserId FROM posts WHERE Title = 'Detecting a given face in a database of facial images';
SELECT COUNT(*) FROM comments WHERE Score < 60 AND UserId = 13;
SELECT posts.Title, comments.UserDisplayName FROM posts JOIN comments ON posts.Id = comments.PostId WHERE comments.Score > 60 ORDER BY comments.CreationDate;
SELECT badges.Name FROM badges JOIN users ON badges.UserId = users.Id WHERE users.Location = 'North Pole' AND strftime('%Y', badges.Date) = '2011' ORDER BY badges.Name;
SELECT users.DisplayName, users.WebsiteUrl FROM users JOIN posts ON users.Id = posts.OwnerUserId WHERE posts.FavoriteCount > 150 ORDER BY users.DisplayName;
SELECT COUNT(*) AS post_history_counts, MAX(CreationDate) AS last_edit_date FROM postHistory WHERE PostId = (SELECT Id FROM posts WHERE Title = 'What is the best introductory Bayesian statistics textbook?');
SELECT users.LastAccessDate, users.Location FROM badges JOIN users ON badges.UserId = users.Id WHERE badges.Name = 'Outliers' ORDER BY users.LastAccessDate;
SELECT posts.Title FROM posts WHERE posts.Id = (SELECT postLinks.RelatedPostId FROM postLinks WHERE postLinks.PostId = (SELECT posts.Id FROM posts WHERE posts.Title = 'How to tell if something happened in a data set which monitors a value over time'));
SELECT posts.Id, badges.Name FROM posts JOIN badges ON badges.UserId = posts.OwnerUserId JOIN users ON users.Id = badges.UserId WHERE users.UserDisplayName = 'Samuel' AND YEAR(posts.CreaionDate) = 2013 AND YEAR(badges.Date) = 2013 ORDER BY posts.Id ASC;
SELECT users.DisplayName FROM posts JOIN users ON posts.OwnerUserId = users.Id WHERE ViewCount = (SELECT MAX(ViewCount) FROM posts) AND CreationDate = (SELECT MAX(CreationDate) FROM posts WHERE ViewCount = (SELECT MAX(ViewCount) FROM posts));
SELECT OwnerDisplayName, Location FROM posts JOIN tags ON posts.Id = tags.ExcerptPostId JOIN users ON posts.OwnerUserId = users.Id WHERE tags.TagName = 'hypothesis-testing';
SELECT Title, LinkTypeId FROM posts JOIN postLinks ON posts.Id = postLinks.RelatedPostId WHERE posts.Title = 'What are principal component scores?';
SELECT u.DisplayName FROM posts p1 JOIN users u ON p1.OwnerUserId = u.Id JOIN posts p2 ON p1.ParentId = p2.Id JOIN users u2 ON p2.OwnerUserId = u2.Id WHERE p1.ParentId IS NOT NULL AND p1.Score = (SELECT MAX(Score) FROM posts WHERE ParentId IS NOT NULL) AND p1.CreationDate = (SELECT MIN(CreationDate) FROM posts WHERE ParentId IS NOT NULL AND Score = (SELECT MAX(Score) FROM posts WHERE ParentId IS NOT NULL))
SELECT users.DisplayName, users.WebsiteUrl FROM votes JOIN users ON votes.UserId = users.Id WHERE votes.VoteTypeId = 8 AND votes.BountyAmount = (SELECT MAX(BountyAmount) FROM votes WHERE VoteTypeId = 8);
SELECT Title FROM posts WHERE ViewCount IN (SELECT ViewCount FROM posts ORDER BY ViewCount DESC LIMIT 5);
SELECT COUNT(*) FROM tags WHERE Count BETWEEN 5000 and 7000;
SELECT OwnerUserId FROM posts WHERE FavoriteCount = (SELECT MAX(FavoriteCount) FROM posts);
SELECT FLOOR((JULIANDAY('now') - JULIANDAY(CreationDate))/365) AS age FROM users WHERE Reputation = (SELECT MAX(Reputation) FROM users);
SELECT COUNT(*) FROM posts JOIN votes ON posts.Id = votes.PostId WHERE YEAR(CreationDate) = 2011 AND BountyAmount = 50;
SELECT Id FROM users WHERE Age = (SELECT MIN(Age) FROM users);
SELECT Score FROM posts WHERE Id = (SELECT PostId FROM postTags WHERE TagId = (SELECT Id FROM tags WHERE Count = (SELECT MAX(Count) FROM tags)));
SELECT COUNT(*)/12 FROM postLinks WHERE PostId IN (SELECT Id FROM posts WHERE YEAR(CreationDate) = 2010 AND AnswerCount <= 2);
SELECT Id FROM posts WHERE Id IN (SELECT PostId FROM votes WHERE UserId = 14730) AND FavoriteCount = (SELECT MAX(FavoriteCount) FROM posts WHERE Id IN (SELECT PostId FROM votes WHERE UserId = 14730));
SELECT posts.Title FROM postLinks JOIN posts ON postLinks.PostId = posts.Id WHERE postLinks.CreationDate = (SELECT MIN(CreationDate) FROM postLinks);
SELECT users.DisplayName FROM badges JOIN users ON badges.UserId = users.Id GROUP BY badges.UserId ORDER BY COUNT(Name) DESC LIMIT 1;
SELECT MIN(CreationDate) FROM votes WHERE UserId = (SELECT Id FROM users WHERE DisplayName = 'chl');
SELECT strftime('%Y-%m-%d', MIN(p.CreaionDate)) FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE u.Age = (SELECT MIN(Age) FROM users);
SELECT users.DisplayName FROM badges JOIN users ON badges.UserId = users.Id WHERE badges.Name = 'Archeologist' AND badges.Date = (SELECT MIN(Date) FROM badges WHERE Name = 'Archeologist');
SELECT COUNT(DISTINCT users.Id) FROM users JOIN posts ON users.Id = posts.OwnerUserId WHERE users.Location = 'United Kingdom' GROUP BY users.Id HAVING SUM(posts.FavoriteCount) >= 4;
SELECT AVG(PostId) FROM votes WHERE UserId IN (SELECT Id FROM users WHERE Age > 50 AND Age = (SELECT MAX(Age) FROM users));
SELECT DisplayName FROM users WHERE Reputation = (SELECT MAX(Reputation) FROM users);
SELECT COUNT(*) FROM users WHERE Reputation > 2000 AND Views > 1000;
SELECT DisplayName FROM users WHERE Age BETWEEN 19 and 65 ORDER BY Reputation DESC;
SELECT COUNT(*) FROM posts WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'Jay Stevens') AND YEAR(CreationDate) = 2010;
SELECT Id, Title FROM posts WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'Harvey Motulsky') ORDER BY ViewCount DESC LIMIT 1;
SELECT Id, Title FROM posts WHERE Score = (SELECT MAX(Score) FROM posts);
SELECT AVG(Score) FROM posts WHERE OwnerUserId = (SELECT Id FROM users WHERE DisplayName = 'Stephen Turner');
SELECT DISTINCT users.DisplayName FROM posts JOIN users ON posts.OwnerUserId = users.Id WHERE posts.ViewCount > 20000 AND strftime('%Y', posts.CreaionDate) = '2011' ORDER BY users.DisplayName;
SELECT p.Id, u.DisplayName FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE year(p.CreaionDate) = 2010 AND p.FavoriteCount = (SELECT MAX(FavoriteCount) FROM posts WHERE year(CreationDate) = 2010);
SELECT ROUND(DIVIDE(COUNT(posts.Id), COUNT(posts.Id)) * 100) as percentage FROM posts JOIN users ON posts.OwnerUserId = users.Id WHERE users.Reputation > 1000 AND strftime('%Y', posts.CreaionDate) = '2011';
SELECT COUNT(CASE WHEN Age BETWEEN 13 AND 18 THEN Id END) * 100.0 / COUNT(Id) AS percentage FROM users;
SELECT posts.ViewCount, users.DisplayName FROM posts JOIN users ON posts.OwnerUserId = users.Id WHERE posts.Title = 'Computer Game Datasets';
SELECT COUNT(*) FROM posts WHERE ViewCount > (SELECT AVG(ViewCount) FROM posts);
SELECT COUNT(*) FROM comments WHERE PostId = (SELECT Id FROM posts WHERE Score = (SELECT MAX(Score) FROM posts));
SELECT COUNT(*) FROM posts WHERE ViewCount > 35000 AND CommentCount = 0;
SELECT u.DisplayName, u.Location FROM users u JOIN posts p ON u.Id = p.LastEditorUserId WHERE p.Id = 5465;
SELECT Name, Date FROM badges WHERE UserId = (SELECT Id FROM users WHERE DisplayName = 'Emmett') AND Date = (SELECT MAX(Date) FROM badges WHERE UserId = (SELECT Id FROM users WHERE DisplayName = 'Emmett'));
SELECT COUNT(*) FROM users WHERE Age BETWEEN 19 and 65 AND UpVotes > 5000;
SELECT julianday(b.CreationDate) - julianday(a.CreationDate) FROM users a JOIN badges b ON a.Id = b.UserId WHERE a.DisplayName = 'Zolomon' AND b.Name = 'badge';
0
SELECT comments.Text, comments.UserDisplayName FROM posts JOIN comments ON posts.Id = comments.PostId WHERE posts.Title = 'Analysing wind data with R' AND comments.CreationDate = (SELECT MAX(CreationDate) FROM comments WHERE PostId = (SELECT Id FROM posts WHERE Title = 'Analysing wind data with R'));
SELECT COUNT(*) FROM badges WHERE Name = 'Citizen Patrol';
SELECT COUNT(*) FROM posts WHERE Id IN (SELECT PostId FROM postTags WHERE TagId IN (SELECT Id FROM tags WHERE TagName = 'careers'));
SELECT Reputation, Views FROM users WHERE DisplayName = 'Jarrod Dixon';
SELECT COUNT(*) FROM comments WHERE PostId = (SELECT Id FROM posts WHERE Title = 'Clustering 1D data') OR PostId = (SELECT AcceptedAnswerId FROM posts WHERE Title = 'Clustering 1D data');
SELECT strftime('%Y-%m-%d', CreationDate) FROM users WHERE DisplayName = 'IrishStat';
SELECT COUNT(*) FROM votes WHERE BountyAmount >= 30;
SELECT ROUND(CAST(COUNT(stats_posts.Id) FILTER (WHERE Score >= 50) AS FLOAT) / COUNT(stats_posts.Id) FILTER (WHERE MAX(Reputation) = (SELECT MAX(Reputation) FROM users)) * 100, 2) AS percentage FROM posts AS stats_posts WHERE stats_posts.OwnerUserId = (SELECT Id FROM users WHERE Reputation = (SELECT MAX(Reputation) FROM users));
SELECT COUNT(*) FROM posts WHERE Score < 20;
SELECT COUNT(*) FROM tags WHERE Id < 15 AND Count <= 20;
SELECT ExcerptPostId, WikiPostId FROM tags WHERE TagName = 'sample';
SELECT users.Reputation, users.UpVotes FROM comments JOIN users ON comments.UserId = users.Id WHERE comments.Text = 'fine, you win :)';
SELECT Text FROM comments WHERE PostId = (SELECT Id FROM posts WHERE Title = 'How can I adapt ANOVA for binary data?') ORDER BY CreationDate ASC;
SELECT Text FROM comments WHERE PostId IN (SELECT Id FROM posts WHERE ViewCount BETWEEN 100 AND 150) AND Score = (SELECT MAX(Score) FROM comments WHERE PostId IN (SELECT Id FROM posts WHERE ViewCount BETWEEN 100 AND 150));
0
SELECT COUNT(*) FROM posts WHERE ViewCount < 5 AND Id IN (SELECT PostId FROM comments WHERE Score = 0);
SELECT COUNT(*) FROM comments WHERE Score = 0 AND PostId IN (SELECT Id FROM posts WHERE CommentCount = 1);
SELECT COUNT(DISTINCT UserId) FROM comments WHERE Score = 0 AND UserId IN (SELECT Id FROM users WHERE Age = 40);
SELECT comments.Id, comments.Text FROM comments WHERE comments.PostId = (SELECT posts.Id FROM posts WHERE posts.Title = 'Group differences on a five point Likert item');
SELECT UpVotes FROM users WHERE Id = (SELECT UserId FROM comments WHERE Text = 'R is also lazy evaluated.');
SELECT Text, CreationDate FROM comments WHERE UserId = (SELECT Id FROM users WHERE DisplayName = 'Random');
SELECT DISTINCT users.DisplayName FROM comments JOIN users ON comments.UserId = users.Id WHERE comments.Score BETWEEN 1 AND 5 AND comments.DownVotes = 0;
SELECT ROUND(CAST(COUNT(CASE WHEN UpVotes = 0 THEN UserId END) AS FLOAT) / COUNT(CASE WHEN Score BETWEEN 5 AND 10 THEN UserId END), 2) AS percentage FROM comments;
SELECT power_name FROM superpower WHERE id IN (SELECT power_id FROM hero_power WHERE hero_id = (SELECT id FROM superhero WHERE superhero_name = '3-D Man'));
SELECT COUNT(*) FROM hero_power WHERE power_id = (SELECT id FROM superpower WHERE power_name = 'Super Strength');
SELECT COUNT(*) FROM superhero s JOIN hero_power hp ON s.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id WHERE sp.power_name = 'Super Strength' AND s.height_cm > 200;
SELECT superhero.full_name FROM superhero JOIN hero_power ON superhero.id = hero_power.hero_id GROUP BY superhero.id HAVING COUNT(full_name) > 15 ORDER BY superhero.superhero_name ASC;
SELECT COUNT(*) FROM superhero WHERE eye_colour_id = (SELECT id FROM colour WHERE colour = 'Blue');
SELECT colour.colour FROM superhero JOIN colour ON superhero.skin_colour_id = colour.id WHERE superhero.superhero_name = 'Apocalypse';
SELECT COUNT(*) FROM superhero s JOIN colour c ON s.eye_colour_id = c.id JOIN hero_power hp ON s.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id WHERE c.colour = 'Blue' AND sp.power_name = 'Agility';
SELECT superhero_name FROM superhero WHERE eye_colour_id = (SELECT id FROM colour WHERE colour = 'Blue') AND hair_colour_id = (SELECT id FROM colour WHERE colour = 'Blond');
SELECT COUNT(*) FROM superhero WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics');
SELECT full_name FROM superhero WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics') AND height_cm = (SELECT MAX(height_cm) FROM superhero WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics'));
SELECT publisher_name FROM publisher WHERE id = (SELECT publisher_id FROM superhero WHERE superhero_name = 'Sauron');
SELECT COUNT(*) FROM superhero WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics') AND eye_colour_id = (SELECT id FROM colour WHERE colour = 'Blue');
SELECT AVG(height_cm) FROM superhero WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics');
SELECT ROUND((COUNT(DISTINCT hero_power.hero_id) * 1.0 / COUNT(DISTINCT superhero.id)) * 100) FROM superhero JOIN publisher ON superhero.publisher_id = publisher.id JOIN hero_power ON superhero.id = hero_power.hero_id JOIN superpower ON hero_power.power_id = superpower.id WHERE publisher.publisher_name = 'Marvel Comics' AND superpower.power_name = 'Super Strength';
SELECT COUNT(*) FROM superhero WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'DC Comics');
SELECT publisher.publisher_name FROM publisher JOIN superhero ON superhero.publisher_id = publisher.id JOIN hero_attribute ON hero_attribute.hero_id = superhero.id JOIN attribute ON attribute.id = hero_attribute.attribute_id WHERE attribute.attribute_name = 'Speed' AND hero_attribute.attribute_value = (SELECT MIN(attribute_value) FROM hero_attribute JOIN attribute ON attribute.id = hero_attribute.attribute_id WHERE attribute.attribute_name = 'Speed');
SELECT COUNT(*) FROM superhero WHERE eye_colour_id = (SELECT id FROM colour WHERE colour = 'Gold') AND publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics');
SELECT publisher_name FROM publisher WHERE id = (SELECT publisher_id FROM superhero WHERE superhero_name = 'Blue Beetle II');
SELECT COUNT(*) FROM superhero WHERE hair_colour_id = (SELECT id FROM colour WHERE colour = 'Blond');
SELECT superhero.superhero_name FROM hero_attribute JOIN superhero ON hero_attribute.hero_id = superhero.id WHERE hero_attribute.attribute_id = (SELECT id FROM attribute WHERE attribute_name = 'Intelligence') AND hero_attribute.attribute_value = (SELECT MIN(attribute_value) FROM hero_attribute WHERE attribute_id = (SELECT id FROM attribute WHERE attribute_name = 'Intelligence'));
SELECT race.race FROM race JOIN superhero ON race.id = superhero.race_id WHERE superhero.superhero_name = 'Copycat';
SELECT COUNT(DISTINCT hero_id) FROM hero_attribute WHERE attribute_name = 'Durability' AND attribute_value < 50;
SELECT superhero_name FROM superhero WHERE id IN (SELECT hero_id FROM hero_power WHERE power_id = (SELECT id FROM superpower WHERE power_name = 'Death Touch'));
SELECT COUNT(*) FROM superhero s JOIN gender g ON s.gender_id = g.id JOIN hero_attribute ha ON s.id = ha.hero_id JOIN attribute a ON ha.attribute_id = a.id WHERE g.gender = 'Female' AND a.attribute_name = 'Strength' AND ha.attribute_value = 100;
SELECT superhero.superhero_name FROM superhero JOIN hero_power ON superhero.id = hero_power.hero_id GROUP BY superhero.superhero_name ORDER BY COUNT(hero_power.power_id) DESC LIMIT 1;
SELECT COUNT(*) FROM superhero WHERE race_id = (SELECT id FROM race WHERE race = 'Vampire');
SELECT ROUND((CAST(COUNT(CASE WHEN alignment = 'Bad' THEN 1 END) AS FLOAT) / COUNT(id) * 100), 0) FROM superhero WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics');
SELECT SUM(publisher_name = 'Marvel Comics') - SUM(publisher_name = 'DC Comics') FROM superhero JOIN publisher ON superhero.publisher_id = publisher.id;
SELECT id FROM publisher WHERE publisher_name = 'Star Trek';
SELECT AVG(attribute_value) FROM hero_attribute JOIN superhero ON hero_attribute.hero_id = superhero.id;
SELECT COUNT(*) FROM superhero WHERE full_name IS NULL;
SELECT colour.colour FROM superhero JOIN colour ON superhero.eye_colour_id = colour.id WHERE superhero.id = 75;
SELECT superpower.power_name FROM hero_power JOIN superpower ON hero_power.power_id = superpower.id WHERE hero_power.hero_id = (SELECT id FROM superhero WHERE superhero_name = 'Deathlok');
SELECT AVG(weight_kg) FROM superhero WHERE gender_id = 2;
SELECT DISTINCT power_name FROM superpower JOIN hero_power ON superpower.id = hero_power.power_id JOIN superhero ON hero_power.hero_id = superhero.id JOIN gender ON superhero.gender_id = gender.id WHERE gender.gender = 'Male';
SELECT superhero_name FROM superhero WHERE race_id = (SELECT id FROM race WHERE race = 'Alien') ORDER BY superhero_name;
SELECT superhero_name FROM superhero WHERE height_cm BETWEEN 170 AND 190 AND eye_colour_id = 1 ORDER BY superhero_name ASC;
SELECT power_name FROM superpower WHERE id = (SELECT power_id FROM hero_power WHERE hero_id = 56);
SELECT full_name FROM superhero WHERE race_id = (SELECT id FROM race WHERE race = 'Demi-God');
SELECT COUNT(*) FROM superhero WHERE alignment_id = (SELECT id FROM alignment WHERE alignment = 'Bad');
SELECT race.race FROM superhero JOIN race ON superhero.race_id = race.id WHERE superhero.weight_kg = 169;
SELECT colour.colour FROM superhero JOIN colour ON superhero.hair_colour_id = colour.id WHERE superhero.race_id = (SELECT id FROM race WHERE race = 'human') AND superhero.height_cm = 185;
SELECT colour.colour FROM superhero JOIN colour ON superhero.eye_colour_id = colour.id WHERE weight_kg = (SELECT MAX(weight_kg) FROM superhero);
SELECT ROUND(MULTIPLY(DIVIDE(SUM(publisher_id = 13), COUNT(publisher_id), 100))) FROM superhero WHERE height_cm BETWEEN 150 AND 180;
SELECT full_name FROM superhero WHERE gender_id = 1 AND weight_kg > (SELECT AVG(weight_kg) * 0.79 FROM superhero) ORDER BY full_name ASC;
SELECT power_name FROM superpower WHERE id = (SELECT power_id FROM hero_power GROUP BY power_id ORDER BY COUNT(*) DESC LIMIT 1);
SELECT attribute_value FROM hero_attribute WHERE hero_id = (SELECT id FROM superhero WHERE superhero_name = 'Abomination') AND attribute_id = (SELECT id FROM attribute WHERE attribute_name = 'Durability');
SELECT power_name FROM superpower WHERE id IN (SELECT power_id FROM hero_power WHERE hero_id = 1);
SELECT COUNT(DISTINCT hero_id) FROM hero_power WHERE power_id = (SELECT id FROM superpower WHERE power_name = 'stealth');
SELECT full_name FROM superhero WHERE id = (SELECT hero_id FROM hero_attribute WHERE attribute_id = (SELECT id FROM attribute WHERE attribute_name = 'strength') AND attribute_value = (SELECT MAX(attribute_value) FROM hero_attribute WHERE attribute_id = (SELECT id FROM attribute WHERE attribute_name = 'strength')));
SELECT ROUND(CAST(SUM(CASE WHEN skin_colour_id IS NULL THEN 1 ELSE 0 END) AS FLOAT) / CAST(COUNT(*) AS FLOAT), 2) FROM superhero;
SELECT COUNT(*) FROM superhero WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Dark Horse Comics');
SELECT superhero.superhero_name, MAX(hero_attribute.attribute_value) FROM superhero JOIN publisher ON superhero.publisher_id = publisher.id JOIN hero_attribute ON superhero.id = hero_attribute.hero_id JOIN attribute ON hero_attribute.attribute_id = attribute.id WHERE publisher.publisher_name = 'Dark Horse Comics' AND attribute.attribute_name = 'durability';
SELECT colour.colour FROM colour WHERE colour.id = (SELECT superhero.eye_colour_id FROM superhero WHERE superhero.full_name = 'Abraham Sapien');
SELECT superhero_name FROM superhero WHERE id IN (SELECT hero_id FROM hero_power WHERE power_id = (SELECT id FROM superpower WHERE power_name = 'Flight')) ORDER BY superhero_name;
SELECT superhero.superhero_name, colour.colour AS eyes, colour_1.colour AS hair, colour_2.colour AS skin FROM superhero JOIN colour ON superhero.eye_colour_id = colour.id JOIN colour AS colour_1 ON superhero.hair_colour_id = colour_1.id JOIN colour AS colour_2 ON superhero.skin_colour_id = colour_2.id JOIN gender ON superhero.gender_id = gender.id JOIN publisher ON superhero.publisher_id = publisher.id WHERE gender.gender = 'Female' AND publisher.publisher_name = 'Dark Horse Comics' ORDER BY superhero.superhero_name;
SELECT s.superhero_name, p.publisher_name FROM superhero s JOIN publisher p ON s.publisher_id = p.id WHERE s.eye_colour_id = s.hair_colour_id AND s.hair_colour_id = s.skin_colour_id ORDER BY s.superhero_name;
SELECT race.race FROM superhero JOIN race ON superhero.race_id = race.id WHERE superhero.superhero_name = 'A-Bomb';
SELECT 100 * COUNT(CASE WHEN gender.gender = 'Female' THEN 1 END AND CASE WHEN colour.colour = 'Blue' THEN 1 END) / COUNT(CASE WHEN gender.gender = 'Female' THEN 1 END) FROM superhero JOIN gender ON superhero.gender_id = gender.id JOIN colour ON superhero.eye_colour_id = colour.id WHERE gender.gender = 'Female';
SELECT superhero.superhero_name, race.race FROM superhero JOIN race ON superhero.race_id = race.id WHERE superhero.full_name = 'Charles Chandler';
SELECT gender.gender FROM superhero JOIN gender ON superhero.gender_id = gender.id WHERE superhero.superhero_name = 'Agent 13';
SELECT superhero_name FROM superhero WHERE id IN (SELECT hero_id FROM hero_power WHERE power_id = (SELECT id FROM superpower WHERE power_name = 'Adaptation'));
SELECT COUNT(*) FROM hero_power WHERE hero_id = (SELECT id FROM superhero WHERE superhero_name = 'Amazo');
SELECT power_name FROM superpower WHERE id IN (SELECT power_id FROM hero_power WHERE hero_id = (SELECT id FROM superhero WHERE full_name = 'Hunter Zolomon'));
SELECT height_cm FROM superhero WHERE eye_colour_id = (SELECT id FROM colour WHERE colour = 'Amber') ORDER BY height_cm DESC;
SELECT superhero_name FROM superhero WHERE eye_colour_id AND hair_colour_id IN (SELECT id FROM colour WHERE colour = 'Black') ORDER BY superhero_name;
SELECT colour.colour FROM superhero JOIN colour ON superhero.eye_colour_id = colour.id WHERE superhero.skin_colour_id = (SELECT id FROM colour WHERE colour = 'Gold') ORDER BY colour.colour;
SELECT full_name FROM superhero WHERE race_id = (SELECT id FROM race WHERE race = 'Vampire') ORDER BY height_cm ASC;
SELECT superhero_name FROM superhero WHERE alignment_id = (SELECT id FROM alignment WHERE alignment = 'Neutral') ORDER BY superhero_name;
SELECT COUNT(*) FROM hero_attribute WHERE attribute_name = 'Strength' AND attribute_value = (SELECT MAX(attribute_value) FROM hero_attribute WHERE attribute_name = 'Strength');
SELECT race.race, alignment.alignment FROM superhero JOIN race ON superhero.race_id = race.id JOIN alignment ON superhero.alignment_id = alignment.id WHERE superhero.superhero_name = 'Cameron Hicks';
SELECT ROUND((SUM(gender_id = (SELECT id FROM gender WHERE gender = 'Female')) * 1.0 / COUNT(*)) * 100) FROM superhero WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics');
SELECT AVG(weight_kg) FROM superhero WHERE race_id = (SELECT id FROM race WHERE race = 'Alien');
SELECT (SELECT SUM(weight_kg) FROM superhero WHERE full_name = 'Emil Blonsky') - (SELECT SUM(weight_kg) FROM superhero WHERE full_name = 'Charles Chandler') AS difference;
SELECT superhero.superhero_name, AVG(superhero.height_cm) FROM superhero GROUP BY superhero.superhero_name;
SELECT power_name FROM superpower WHERE id = (SELECT power_id FROM hero_power WHERE hero_id = (SELECT id FROM superhero WHERE superhero_name = 'Abomination'));
SELECT COUNT(*) FROM superhero WHERE race_id = 21 AND gender_id = 1;
SELECT superhero.superhero_name FROM superhero JOIN hero_attribute ON superhero.id = hero_attribute.hero_id WHERE hero_attribute.attribute_name = 'Speed' AND hero_attribute.attribute_value = (SELECT MAX(attribute_value) FROM hero_attribute WHERE attribute_name = 'Speed');
SELECT COUNT(*) FROM superhero WHERE alignment_id = 3;
SELECT attribute_name, attribute_value FROM hero_attribute JOIN attribute ON hero_attribute.attribute_id = attribute.id WHERE hero_attribute.hero_id = (SELECT id FROM superhero WHERE superhero_name = '3-D Man');
SELECT superhero_name, full_name FROM superhero WHERE eye_colour_id = 7 AND hair_colour_id = 9;
SELECT publisher.publisher_name FROM superhero JOIN publisher ON superhero.publisher_id = publisher.id WHERE superhero.superhero_name = 'Hawkman' OR superhero.superhero_name = 'Karate Kid' OR superhero.superhero_name = 'Speedy';
SELECT COUNT(*) FROM superhero WHERE publisher_id IS NULL;
SELECT ROUND(CAST(COUNT(superhero_name WHERE eye_colour_id = 7) AS FLOAT) / CAST(COUNT(superhero_name) AS FLOAT) * 100.0, 2) AS percentage FROM superhero;
SELECT ROUND(CAST(SUM(gender_id = 1) AS REAL) / CAST(SUM(gender_id = 2) AS REAL), 2) FROM superhero;
SELECT superhero_name, MAX(height_cm) FROM superhero;
SELECT id FROM superpower WHERE power_name = 'cryokinesis';
SELECT superhero_name FROM superhero WHERE id = 294;
SELECT full_name FROM superhero WHERE weight_kg = 0 OR weight_kg IS NULL ORDER BY superhero_name;
SELECT colour.colour FROM superhero JOIN colour ON superhero.eye_colour_id = colour.id WHERE superhero.full_name = 'Karen Beecher-Duncan';
SELECT sp.power_name FROM superhero s JOIN hero_power hp ON s.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id WHERE s.full_name = 'Helen Parr';
SELECT race.race FROM superhero JOIN race ON superhero.race_id = race.id WHERE height_cm = 188 AND weight_kg = 108;
SELECT publisher_name FROM publisher WHERE id = (SELECT publisher_id FROM superhero WHERE id = 38);
SELECT race.race FROM race JOIN superhero ON race.id = superhero.race_id WHERE superhero.id = (SELECT hero_id FROM hero_attribute WHERE attribute_id = (SELECT id FROM attribute WHERE attribute_name = 'intelligence') ORDER BY attribute_value DESC LIMIT 1);
SELECT alignment.alignment, superpower.power_name FROM superhero JOIN alignment ON superhero.alignment_id = alignment.id JOIN hero_power ON superhero.id = hero_power.hero_id JOIN superpower ON hero_power.power_id = superpower.id WHERE superhero.superhero_name = 'Atom IV';
SELECT full_name FROM superhero WHERE eye_colour_id = (SELECT id FROM colour WHERE colour = 'Blue');
SELECT AVG(attribute_value) FROM hero_attribute WHERE hero_id IN (SELECT id FROM superhero WHERE alignment_id = 3);
SELECT colour.colour FROM superhero JOIN colour ON superhero.skin_colour_id = colour.id JOIN hero_attribute ON superhero.id = hero_attribute.hero_id WHERE hero_attribute.attribute_value = 100 ORDER BY colour.colour;
SELECT COUNT(*) FROM superhero WHERE alignment_id = 1 AND gender_id = 2;
SELECT superhero_name FROM superhero JOIN hero_attribute ON superhero.id = hero_attribute.hero_id WHERE attribute_value BETWEEN 75 AND 80 ORDER BY superhero_name ASC;
SELECT race.race FROM superhero JOIN race ON superhero.race_id = race.id WHERE superhero.gender_id = (SELECT id FROM gender WHERE gender = 'male') AND superhero.hair_colour_id = (SELECT id FROM colour WHERE colour = 'blue');
SELECT ROUND((SUM(gender.id = 2 AND alignment.id = 2) * 100.0 / COUNT(alignment.id = 2)), 2) FROM superhero WHERE alignment_id = 2;
SELECT SUM(CASE WHEN eye_colour_id = 7 THEN 1 ELSE 0 END) - SUM(CASE WHEN eye_colour_id = 1 THEN 1 ELSE 0 END) AS difference FROM superhero LEFT JOIN (SELECT id, weight_kg FROM superhero WHERE weight_kg = 0 OR weight_kg IS NULL) AS T1 ON superhero.id = T1.id;
SELECT attribute_value FROM hero_attribute WHERE hero_id = (SELECT id FROM superhero WHERE superhero_name = 'Hulk') AND attribute_id = (SELECT id FROM attribute WHERE attribute_name = 'Strength');
SELECT power_name FROM superpower WHERE id IN (SELECT power_id FROM hero_power WHERE hero_id = (SELECT id FROM superhero WHERE superhero_name = 'Ajax'));
SELECT COUNT(*) FROM superhero WHERE skin_colour_id = (SELECT id FROM colour WHERE colour = 'Green') AND alignment_id = (SELECT id FROM alignment WHERE alignment = 'Bad');
SELECT COUNT(*) FROM superhero WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics') AND gender_id = (SELECT id FROM gender WHERE gender = 'Female');
SELECT superhero_name FROM superhero WHERE id IN (SELECT hero_id FROM hero_power WHERE power_id IN (SELECT id FROM superpower WHERE power_name = 'Wind Control')) ORDER BY superhero_name ASC;
SELECT gender.gender FROM superhero JOIN gender ON superhero.gender_id = gender.id WHERE superhero.id IN (SELECT hero_id FROM hero_power WHERE power_id = (SELECT id FROM superpower WHERE power_name = 'Phoenix Force'));
SELECT superhero_name, weight_kg FROM superhero WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'DC Comics') ORDER BY weight_kg DESC LIMIT 1;
SELECT AVG(height_cm) FROM superhero WHERE race_id <> 1 AND publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Dark Horse Comics');
SELECT COUNT(*) FROM hero_attribute WHERE attribute_id = (SELECT id FROM attribute WHERE attribute_name = 'Speed') AND attribute_value = 100;
SELECT SUM(publisher_name = 'DC Comics') - SUM(publisher_name = 'Marvel Comics') FROM superhero JOIN publisher ON superhero.publisher_id = publisher.id;
SELECT attribute_name FROM attribute WHERE id = (SELECT attribute_id FROM hero_attribute WHERE hero_id = (SELECT id FROM superhero WHERE superhero_name = 'Black Panther') AND attribute_value = (SELECT MIN(attribute_value) FROM hero_attribute WHERE hero_id = (SELECT id FROM superhero WHERE superhero_name = 'Black Panther')));
SELECT colour.colour FROM superhero JOIN colour ON superhero.eye_colour_id = colour.id WHERE superhero.superhero_name = 'Abomination';
SELECT superhero_name FROM superhero WHERE height_cm = (SELECT MAX(height_cm) FROM superhero);
SELECT superhero_name FROM superhero WHERE full_name = 'Charles Chandler';
SELECT ROUND(MULTIPLY(DIVIDE(SUM(gender = 'Female' AND publisher_name = 'George Lucas'), COUNT(publisher_name = 'George Lucas')), 100.0), 2) FROM superhero JOIN gender ON superhero.gender_id = gender.id JOIN publisher ON superhero.publisher_id = publisher.id;
SELECT 100.0 * SUM(alignment = 'Good') / COUNT(*) FROM superhero WHERE publisher_id = (SELECT id FROM publisher WHERE publisher_name = 'Marvel Comics');<|im_end|>
SELECT COUNT(*) FROM superhero WHERE full_name LIKE 'John%';
SELECT hero_id FROM hero_attribute WHERE attribute_id = (SELECT id FROM attribute WHERE attribute_name = 'intelligence') ORDER BY attribute_value ASC LIMIT 1;
SELECT full_name FROM superhero WHERE superhero_name = 'Alien';
SELECT full_name FROM superhero WHERE weight_kg < 100 AND eye_colour_id = (SELECT id FROM colour WHERE colour = 'brown') ORDER BY superhero_name;
SELECT attribute_value FROM hero_attribute WHERE hero_id = (SELECT id FROM superhero WHERE superhero_name = 'Aquababy');
SELECT weight_kg, race.race FROM superhero JOIN race ON superhero.race_id = race.id WHERE superhero.id = 40;
SELECT AVG(height_cm) FROM superhero WHERE alignment_id IS NULL;
SELECT hero_id FROM hero_power WHERE power_id = (SELECT id FROM superpower WHERE power_name = 'Intelligence') ORDER BY hero_id ASC;
SELECT colour.colour FROM superhero JOIN colour ON superhero.eye_colour_id = colour.id WHERE superhero.superhero_name = 'Blackwulf';
SELECT superpower.power_name FROM superpower JOIN hero_power ON superpower.id = hero_power.power_id JOIN superhero ON hero_power.hero_id = superhero.id WHERE superhero.height_cm > (SELECT AVG(height_cm) * 0.8 FROM superhero) ORDER BY superpower.power_name;
SELECT driverRef FROM qualifying WHERE raceId = (SELECT raceId FROM races WHERE round = 18) AND q1 = (SELECT MAX(q1) FROM qualifying WHERE raceId = (SELECT raceId FROM races WHERE round = 18) LIMIT 5);
SELECT drivers.surname FROM drivers JOIN (SELECT driverId FROM lapTimes WHERE raceId = (SELECT raceId FROM races WHERE round = 19) AND lapTimes.lap = 2 AND lapTimes.time = (SELECT MIN(q2) FROM qualifying WHERE raceId = (SELECT raceId FROM races WHERE round = 19))) AS q2 ON drivers.driverId = q2.driverId;
SELECT year FROM races WHERE circuitId = (SELECT circuitId FROM circuits WHERE location = 'Shanghai');
SELECT url FROM races WHERE circuitId = (SELECT circuitId FROM circuits WHERE name = 'Circuit de Barcelona-Catalunya');
SELECT name FROM races WHERE circuitId = (SELECT circuitId FROM circuits WHERE country = 'Germany');
SELECT circuits.position FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId JOIN constructors ON results.constructorId = constructors.constructorId WHERE constructors.name = 'Renault' ORDER BY circuits.position;
SELECT COUNT(*) FROM races WHERE year = 2009 AND circuitId = (SELECT circuitId FROM circuits WHERE name = 'Albert Park Grand Prix Circuit');
SELECT races.name FROM races JOIN circuits ON races.circuitId = circuits.circuitId WHERE circuits.country = 'Spain' ORDER BY races.year;
SELECT lat, lng FROM circuits WHERE circuitRef = 'albert_park';
SELECT url FROM races WHERE circuitId = (SELECT circuitId FROM circuits WHERE name = 'Sepang International Circuit') AND year IN (SELECT year FROM races WHERE circuitId = (SELECT circuitId FROM circuits WHERE name = 'Sepang International Circuit'));
SELECT time FROM races WHERE circuitId = (SELECT circuitId FROM circuits WHERE name = 'Sepang International Circuit');
SELECT lat, lng FROM circuits WHERE name = 'Abu Dhabi Grand Prix';
SELECT circuits.country FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId JOIN constructorResults ON results.resultId = constructorResults.raceId WHERE results.raceId = 24 AND constructorResults.points = 1;
SELECT q1 FROM qualifying WHERE driverId = (SELECT driverId FROM drivers WHERE forename = 'Bruno' AND surname = 'Senna') AND raceId = 354;
SELECT drivers.nationality FROM qualifying JOIN drivers ON qualifying.driverId = drivers.driverId WHERE qualifying.q2 = '0:01:40' AND qualifying.raceId = 355;
SELECT number FROM qualifying WHERE raceId = (SELECT raceId FROM races WHERE round = 903) AND q3 = '0:01:54';
SELECT COUNT(*) FROM results WHERE raceId = (SELECT raceId FROM races WHERE year = 2007 AND name = 'Bahrain Grand Prix') AND time > 0;
SELECT seasons.year, races.round, races.name, races.date, circuits.name, circuits.location, circuits.country, circuits.url FROM seasons JOIN races ON seasons.year = races.year JOIN circuits ON races.circuitId = circuits.circuitId WHERE races.raceId = (SELECT raceId FROM results WHERE number = 901);
SELECT COUNT(*) FROM results WHERE raceId = (SELECT raceId FROM races WHERE date = '2015-11-29') AND time > 0;
SELECT forename || ' ' || surname FROM drivers WHERE driverId IN (SELECT driverId FROM results WHERE raceId = 592 AND time > 0) ORDER BY dob DESC LIMIT 1;
SELECT url FROM drivers WHERE driverId = (SELECT driverId FROM lapTimes WHERE raceId = 161 AND time = '0:01:27');
SELECT nationality FROM drivers WHERE driverId = (SELECT driverId FROM results WHERE raceId = 933 AND fastestLapSpeed = (SELECT MIN(fastestLapSpeed) FROM results WHERE raceId = 933));
SELECT location, lat, lng FROM circuits WHERE circuitRef = 'sepang';
SELECT constructors.url FROM constructors WHERE constructors.constructorId = (SELECT constructorResults.constructorId FROM constructorResults WHERE constructorResults.raceId = 9 ORDER BY constructorResults.points DESC LIMIT 1);
SELECT q1 FROM qualifying WHERE raceId = 345 AND driverId = (SELECT driverId FROM drivers WHERE forename = 'Lucas' AND surname = 'di Grassi') LIMIT 1;
SELECT nationality FROM drivers WHERE driverId = (SELECT driverId FROM qualifying WHERE raceId = 347 AND q2 = '0:01:15');
SELECT d.code FROM drivers d JOIN qualifying q ON d.driverId = q.driverId JOIN races r ON q.raceId = r.raceId WHERE r.raceId = 45 AND q.q3 = '0:01:33';
SELECT time FROM results WHERE driverId = (SELECT driverId FROM drivers WHERE surname = 'McLaren' AND forename = 'Bruce') AND raceId = 743;
SELECT drivers.forename, drivers.surname, drivers.nationality FROM results JOIN drivers ON results.driverId = drivers.driverId WHERE results.raceId = (SELECT raceId FROM races WHERE name = 'San Marino Grand Prix' AND year = 2006) AND results.position = 2;
SELECT seasons.year, races.round, races.name, races.date, circuits.name, circuits.location, circuits.country, circuits.url FROM seasons JOIN races ON seasons.year = races.year JOIN circuits ON races.circuitId = circuits.circuitId WHERE races.raceId = 901;
SELECT COUNT(*) FROM results WHERE raceId = (SELECT raceId FROM races WHERE date = '2015-11-29') AND statusId != 1;
SELECT * FROM drivers WHERE driverId IN (SELECT driverId FROM results WHERE raceId = 872 AND time > 0) AND dob = (SELECT MAX(dob) FROM drivers WHERE driverId IN (SELECT driverId FROM results WHERE raceId = 872 AND time > 0));
SELECT drivers.forename || ' ' || drivers.surname FROM lapTimes JOIN drivers ON lapTimes.driverId = drivers.driverId WHERE lapTimes.raceId = 348 AND lapTimes.time = (SELECT MIN(time) FROM lapTimes WHERE raceId = 348);
SELECT nationality FROM drivers WHERE driverId = (SELECT driverId FROM results WHERE fastestLapSpeed = (SELECT MAX(fastestLapSpeed) FROM results WHERE raceId = 841));
SELECT ROUND((fastestLapSpeed (raceId = 853) - fastestLapSpeed (raceId = 854)) / fastestLapSpeed (raceId = 853) * 100, 2) as percentage FROM results WHERE driverId = (SELECT driverId FROM drivers WHERE forename = 'Paul' AND surname = 'di Resta') AND raceId = 853;
SELECT COUNT(driverid) * 1.0 / (SELECT COUNT(driverid) FROM results WHERE date = '1983-07-16') FROM results WHERE date = '1983-07-16' AND time > 0;
SELECT MIN(year) FROM races WHERE name = 'Singapore Grand Prix';
SELECT name FROM races WHERE year = 2005 ORDER BY name DESC;
SELECT * FROM races WHERE strftime('%Y-%m', date) = (SELECT strftime('%Y-%m', date) FROM races ORDER BY date ASC LIMIT 1) ORDER BY date ASC;
SELECT races.name, races.date FROM races WHERE races.year = 1999 AND races.round = (SELECT MAX(races.round) FROM races WHERE races.year = 1999);
SELECT year FROM races GROUP BY year ORDER BY COUNT(*) DESC LIMIT 1;
SELECT name FROM races WHERE year = 2017 AND name NOT IN (SELECT name FROM races WHERE year = 2000);
SELECT circuits.country, circuits.name, circuits.location, races.year, races.date FROM races JOIN circuits ON races.circuitId = circuits.circuitId WHERE races.name = 'European Grand Prix' ORDER BY races.year ASC LIMIT 1;
SELECT year FROM seasons WHERE year = (SELECT year FROM races WHERE circuitId = (SELECT circuitId FROM circuits WHERE name = 'Brands Hatch') AND name = 'British Grand Prix');
SELECT COUNT(*) FROM races WHERE circuitId = (SELECT circuitId FROM circuits WHERE name = 'Silverstone Circuit') AND name = 'British Grand Prix';
SELECT drivers.forename, drivers.surname FROM driverStandings JOIN drivers ON driverStandings.driverId = drivers.driverId WHERE driverStandings.raceId = (SELECT raceId FROM races WHERE name = 'Singapore Grand Prix' AND year = 2010) ORDER BY driverStandings.position;
SELECT forename || ' ' || surname, MAX(points) FROM drivers JOIN results USING(driverId);
SELECT drivers.forename || ' ' || drivers.surname AS driver_name, results.points FROM results JOIN drivers ON results.driverId = drivers.driverId WHERE results.raceId = (SELECT raceId FROM races WHERE year = 2017 AND name = 'Chinese Grand Prix') ORDER BY results.points DESC LIMIT 3;
SELECT MIN(time), driverId, raceId FROM results;
SELECT ROUND(AVG(milliseconds), 3) FROM lapTimes WHERE raceId = (SELECT raceId FROM races WHERE year = 2009 AND name = 'Chinese Grand Prix') AND driverId = (SELECT driverId FROM drivers WHERE surname = 'Vettel' AND forename = 'Sebastian');
SELECT DIVIDE(COUNT(CASE WHEN position > 1 THEN raceId END), COUNT(raceId)) as percentage FROM results WHERE year > 2010 AND surname = 'Hamilton';
SELECT drivers.forename || ' ' || drivers.surname AS driver_name, drivers.nationality, AVG(results.points) AS avg_points FROM drivers JOIN results ON drivers.driverId = results.driverId WHERE results.position = 1 GROUP BY drivers.driverId ORDER BY COUNT(results.wins) DESC LIMIT 1;
SELECT 2022 - year(MIN(dob)) + 1, forename || ' ' || surname, name FROM drivers JOIN results USING(driverId) JOIN constructors USING(constructorId) WHERE nationality = 'Japanese';
SELECT circuits.name FROM races JOIN circuits ON races.circuitId = circuits.circuitId WHERE year(date) BETWEEN 1990 AND 2000 GROUP BY races.circuitId HAVING COUNT(raceId) = 4 ORDER BY circuits.name;
SELECT races.name, circuits.name, circuits.location FROM races JOIN circuits ON races.circuitId = circuits.circuitId WHERE races.year = 2006 AND circuits.country = 'USA' ORDER BY races.name;
SELECT races.name, circuits.name, circuits.location FROM races JOIN circuits ON races.circuitId = circuits.circuitId WHERE month(date) = 9 AND year = 2005 ORDER BY races.name;
SELECT raceId FROM results WHERE driverId = (SELECT driverId FROM drivers WHERE surname = 'Yoong' AND forename = 'Alex') AND position < 10;
SELECT COUNT(*) FROM results WHERE raceId IN (SELECT raceId FROM races WHERE circuitId = (SELECT circuitId FROM circuits WHERE location = 'Kuala Lumpur' AND country = 'Malaysia')) AND driverId = (SELECT driverId FROM drivers WHERE surname = 'Schumacher' AND forename = 'Michael') AND points = (SELECT MAX(points) FROM results WHERE raceId IN (SELECT raceId FROM races WHERE circuitId = (SELECT circuitId FROM circuits WHERE location = 'Kuala Lumpur' AND country = 'Malaysia')) AND driverId = (SELECT driverId FROM drivers WHERE surname = 'Schumacher' AND forename = 'Michael'));
SELECT races.name, races.year FROM races JOIN results ON races.raceId = results.raceId WHERE results.driverId = (SELECT driverId FROM drivers WHERE surname = 'Schumacher' AND forename = 'Michael') AND results.milliseconds = (SELECT MIN(milliseconds) FROM results WHERE driverId = (SELECT driverId FROM drivers WHERE surname = 'Schumacher' AND forename = 'Michael'));
SELECT AVG(points) FROM results WHERE year = 2000 AND driverId = 9;
SELECT points, position FROM results WHERE raceId = (SELECT MIN(raceId) FROM races WHERE year = (SELECT MIN(year) FROM drivers JOIN results USING(driverId) WHERE drivers.surname = 'Hamilton' AND drivers.forename = 'Lewis')) AND driverId = (SELECT driverId FROM drivers WHERE surname = 'Hamilton' AND forename = 'Lewis');
SELECT races.name, circuits.country, races.date FROM races JOIN circuits ON races.circuitId = circuits.circuitId WHERE races.year = 2017 ORDER BY races.date;
SELECT races.name, seasons.year, circuits.location FROM races JOIN circuits ON races.circuitId = circuits.circuitId JOIN seasons ON races.year = seasons.year WHERE laps = (SELECT MAX(laps) FROM results);
SELECT COUNT(CASE WHEN name = 'European Grand Prix' THEN 1 END) AS total_races, COUNT(CASE WHEN name = 'European Grand Prix' AND country = 'Germany' THEN 1 END) AS german_races, (COUNT(CASE WHEN name = 'European Grand Prix' AND country = 'Germany' THEN 1 END) * 1.0 / COUNT(CASE WHEN name = 'European Grand Prix' THEN 1 END)) * 100 AS percentage FROM races;
SELECT lat, lng FROM circuits WHERE circuitRef = 'silverstone';
SELECT name FROM circuits WHERE alt = (SELECT max(alt) FROM circuits);
SELECT circuitRef FROM circuits WHERE name = 'Marina Bay Street Circuit';
SELECT country FROM circuits WHERE alt = (SELECT MAX(alt) FROM circuits);
SELECT COUNT(*) FROM drivers WHERE code IS NULL;
SELECT nationality FROM drivers WHERE dob = (SELECT MIN(dob) FROM drivers);
SELECT surname FROM drivers WHERE nationality = 'Italian' ORDER BY surname;
SELECT url FROM drivers WHERE forename = 'Anthony' AND surname = 'Davidson';
SELECT driverRef FROM drivers WHERE forename = 'Lewis' AND surname = 'Hamilton';
SELECT circuits.name FROM circuits JOIN races ON circuits.circuitId = races.circuitId WHERE races.year = 2009 AND races.name = 'Spanish Grand Prix';
SELECT year FROM races WHERE circuitId = (SELECT circuitId FROM circuits WHERE name = 'Silverstone Circuit') ORDER BY year ASC;
SELECT * FROM races WHERE circuitId = (SELECT circuitId FROM circuits WHERE name = 'Silverstone Circuit');
SELECT time FROM races WHERE year = 2008 AND circuitId = (SELECT circuitId FROM circuits WHERE name = 'Albert Park Grand Prix Circuit');
SELECT COUNT(*) FROM races WHERE circuitId IN (SELECT circuitId FROM circuits WHERE country = 'Italy');
SELECT date FROM races WHERE circuitId = (SELECT circuitId FROM circuits WHERE name = 'Albert Park Grand Prix Circuit');
SELECT url FROM circuits WHERE circuitRef = (SELECT circuitRef FROM races WHERE year = 2009 AND name = 'Spanish Grand Prix');
SELECT MIN(fastestLapTime) FROM results WHERE driverId = (SELECT driverId FROM drivers WHERE driverRef = 'hamilton');
SELECT drivers.forename, drivers.surname FROM drivers JOIN results ON drivers.driverId = results.driverId WHERE results.fastestLapSpeed = (SELECT MAX(fastestLapSpeed) FROM results);
SELECT driverRef FROM drivers WHERE driverId = (SELECT driverId FROM results WHERE raceId = (SELECT raceId FROM races WHERE name = 'Australian Grand Prix' AND year = 2008) AND position = 1);
SELECT seasons.year, races.name, circuits.location FROM drivers JOIN results ON drivers.driverId = results.driverId JOIN races ON results.raceId = races.raceId JOIN seasons ON races.year = seasons.year WHERE drivers.forename = 'Lewis' AND drivers.surname = 'Hamilton';
SELECT raceId FROM results WHERE driverId = (SELECT driverId FROM drivers WHERE surname = 'Hamilton' AND forename = 'Lewis') AND rank = (SELECT MIN(rank) FROM results WHERE driverId = (SELECT driverId FROM drivers WHERE surname = 'Hamilton' AND forename = 'Lewis'));
SELECT MAX(fastestLapSpeed) FROM results WHERE raceId = (SELECT raceId FROM races WHERE year = 2009 AND name = 'Spanish Grand Prix');
SELECT DISTINCT year FROM races WHERE raceId IN (SELECT raceId FROM results WHERE driverId = (SELECT driverId FROM drivers WHERE driverRef = 'hamilton'));
SELECT positionOrder FROM results WHERE driverId = (SELECT driverId FROM drivers WHERE surname = 'Hamilton' AND forename = 'Lewis') AND raceId = (SELECT raceId FROM races WHERE year = 2008 AND name = 'Australian Grand Prix');
SELECT drivers.forename, drivers.surname FROM results JOIN drivers ON results.driverId = drivers.driverId WHERE results.raceId = (SELECT raceId FROM races WHERE year = 2008 AND name = 'Australian Grand Prix') AND results.grid = 4;
SELECT COUNT(*) FROM results WHERE raceId = (SELECT raceId FROM races WHERE year = 2008 AND name = 'Australian Grand Prix') AND time IS NOT NULL;
SELECT fastestLapTime FROM results WHERE driverId = (SELECT driverId FROM drivers WHERE surname = 'Hamilton' AND forename = 'Lewis') AND raceId = (SELECT raceId FROM races WHERE year = 2008 AND name = 'Australian Grand Prix');
SELECT time FROM results WHERE raceId = (SELECT raceId FROM races WHERE year = 2008 AND name = 'Australian Grand Prix') AND position = 2;
SELECT drivers.forename, drivers.surname, drivers.url FROM drivers JOIN results ON drivers.driverId = results.driverId WHERE results.raceId = (SELECT raceId FROM races WHERE year = 2008 AND name = 'Australian Grand Prix') AND results.rank = 1;
SELECT COUNT(*) FROM results WHERE raceId = (SELECT raceId FROM races WHERE year = 2008 AND name = 'Australian Grand Prix') AND driverId IN (SELECT driverId FROM drivers WHERE nationality = 'American');
SELECT COUNT(*) FROM (SELECT DISTINCT driverId FROM results WHERE raceId = (SELECT raceId FROM races WHERE name = 'Australian Grand Prix' AND year = 2008)) WHERE (SELECT COUNT(raceId) FROM results WHERE driverId = (SELECT DISTINCT driverId FROM results WHERE raceId = (SELECT raceId FROM races WHERE name = 'Australian Grand Prix' AND year = 2008))) > 0;
SELECT SUM(points) FROM results WHERE driverId = 1;
SELECT ROUND(AVG(fastestLapTime), 3) FROM results WHERE driverId = (SELECT driverId FROM drivers WHERE surname = 'Hamilton' AND forename = 'Lewis');
SELECT CAST(COUNT(CASE WHEN time IS NOT NULL THEN 1 END) AS FLOAT) / COUNT(*) AS rate FROM results WHERE raceId = (SELECT raceId FROM races WHERE year = 2008 AND name = 'Australian Grand Prix') AND time IS NOT NULL;
SELECT (SELECT (SELECT time FROM results WHERE raceId = (SELECT raceId FROM races WHERE year = 2008 AND name = 'Australian Grand Prix') AND position = 1) - (SELECT time FROM results WHERE raceId = (SELECT raceId FROM races WHERE year = 2008 AND name = 'Australian Grand Prix') AND position = (SELECT COUNT(*) FROM results WHERE raceId = (SELECT raceId FROM races WHERE year = 2008 AND name = 'Australian Grand Prix')))) / (SELECT time FROM results WHERE raceId = (SELECT raceId FROM races WHERE year = 2008 AND name = 'Australian Grand Prix') AND position = (SELECT COUNT(*) FROM results WHERE raceId = (SELECT raceId FROM
SELECT COUNT(*) FROM circuits WHERE location = 'Melbourne' AND country = 'Australia';
SELECT lat, lng FROM circuits WHERE country = 'USA';
SELECT COUNT(*) FROM drivers WHERE strftime('%Y', dob) > '1980' AND nationality = 'British';
SELECT AVG(points) FROM constructorResults WHERE constructorId IN (SELECT constructorId FROM constructors WHERE nationality = 'British');
SELECT constructorId, SUM(points) as total_points FROM constructorResults GROUP BY constructorId ORDER BY total_points DESC LIMIT 1;
SELECT name FROM constructors WHERE constructorId IN (SELECT constructorId FROM constructorResults WHERE raceId = 291 AND points = 0);
SELECT COUNT(*) FROM constructorStandings WHERE constructorId IN (SELECT constructorId FROM constructors WHERE nationality = 'Japanese') AND points = 0 AND raceId IN (SELECT raceId FROM races GROUP BY year, round HAVING COUNT(raceID) = 2);
SELECT constructors.name, COUNT(*) FROM constructorStandings JOIN constructors ON constructorStandings.constructorId = constructors.constructorId WHERE constructorStandings.position = 1 GROUP BY constructors.name;
SELECT COUNT(DISTINCT constructors.constructorId) FROM constructors JOIN results ON constructors.constructorId = results.constructorId JOIN races ON races.raceId = results.raceId WHERE constructors.nationality = 'French' AND races.laps > 50;
SELECT ROUND(COUNT(DISTINCT r.driverId)*1.0/COUNT(DISTINCT d.driverId)*100,2) AS percentage FROM results r JOIN drivers d ON r.driverId = d.driverId WHERE r.time IS NOT NULL AND d.nationality = 'Japanese' AND r.year BETWEEN 2007 AND 2009;
SELECT year, SUM(time)/SUM(round) FROM races GROUP BY year;
SELECT forename, surname FROM drivers WHERE year(dob) > 1975 AND driverId IN (SELECT driverId FROM results WHERE position = 2) ORDER BY surname;
SELECT COUNT(*) FROM results WHERE driverId IN (SELECT driverId FROM drivers WHERE nationality = 'Italian') AND raceId IN (SELECT raceId FROM races WHERE time IS NULL);
SELECT forename, surname FROM drivers WHERE driverId = (SELECT driverId FROM results WHERE fastestLapTime = (SELECT MIN(fastestLapTime) FROM results));
SELECT fastestLap FROM results WHERE rank = 1 AND year = 2009;
SELECT AVG(fastestLapSpeed) FROM results WHERE raceId = (SELECT raceId FROM races WHERE name = 'Spanish Grand Prix' AND year = 2009);
SELECT races.name, races.year FROM races, results WHERE races.raceId = results.raceId AND results.milliseconds = (SELECT MIN(milliseconds) FROM results WHERE milliseconds IS NOT NULL);
SELECT COUNT(driverId)/(COUNT(DriverID)*1.0)*100 FROM results WHERE year(dob) < 1985 AND laps > 50 AND year BETWEEN 2000 AND 2005;
SELECT COUNT(*) FROM lapTimes WHERE driverId IN (SELECT driverId FROM drivers WHERE nationality = 'French') AND time < '01:00.00';
SELECT code FROM drivers WHERE nationality = 'American';
SELECT raceId FROM races WHERE year = 2009;
SELECT COUNT(*) FROM results WHERE raceId = 18;
SELECT number, dob, nationality FROM drivers ORDER BY (strftime('%Y', 'now') - strftime('%Y', dob)) ASC LIMIT 3;
SELECT driverRef FROM drivers WHERE forename = 'Robert' AND surname = 'Kubica';
SELECT COUNT(*) FROM drivers WHERE dob LIKE '1980%' AND nationality = 'Australian';
SELECT drivers.driverId, drivers.forename, drivers.surname, drivers.dob, lapTimes.time FROM drivers JOIN lapTimes ON drivers.driverId = lapTimes.driverId WHERE drivers.nationality = 'German' AND drivers.dob BETWEEN '1980-01-01' AND '1990-12-31' ORDER BY lapTimes.time ASC LIMIT 3;
SELECT driverRef FROM drivers WHERE dob = (SELECT MIN(dob) FROM drivers WHERE nationality = 'Japanese');
SELECT driverId, code FROM drivers WHERE dob LIKE '1971%' AND driverId IN (SELECT driverId FROM results WHERE time = (SELECT MIN(time) FROM results));
SELECT driverId, forename, surname, dob, MAX(time) FROM drivers JOIN lapTimes USING(driverId) WHERE nationality = 'Spanish' AND dob < 1982 GROUP BY driverId ORDER BY MAX(time) DESC LIMIT 10;
SELECT races.year FROM results JOIN races ON results.raceId = races.raceId GROUP BY races.year ORDER BY MIN(results.time) LIMIT 1;
SELECT year FROM races WHERE raceId = (SELECT raceId FROM lapTimes WHERE time = (SELECT MAX(time) FROM lapTimes));
SELECT driverId FROM lapTimes WHERE lap = 1 GROUP BY driverId ORDER BY MIN(time) LIMIT 5;
SELECT COUNT(*) FROM results WHERE raceId>50 AND raceId<100 AND time! = null AND statusId = 2;
SELECT COUNT(*) FROM races WHERE circuitId IN (SELECT circuitId FROM circuits WHERE country = 'Austria');
SELECT races.round, COUNT(*) AS finishers FROM races JOIN results ON races.raceId = results.raceId WHERE results.time IS NOT NULL GROUP BY races.raceId ORDER BY finishers DESC LIMIT 1;
SELECT drivers.driverRef, drivers.nationality, drivers.dob FROM drivers JOIN qualifying ON drivers.driverId = qualifying.driverId WHERE qualifying.q2 IS NOT NULL AND qualifying.raceId = 23 ORDER BY drivers.dob ASC;
SELECT races.name, races.date, races.time FROM qualifying JOIN races ON qualifying.raceId = races.raceId WHERE qualifying.driverId = (SELECT driverId FROM drivers WHERE dob = (SELECT MIN(dob) FROM drivers));
SELECT COUNT(*) FROM results WHERE statusId = 2 AND driverId IN (SELECT driverId FROM drivers WHERE nationality = 'American');
SELECT constructors.url FROM constructors WHERE constructors.constructorId = (SELECT constructorResults.constructorId FROM constructorResults WHERE constructorResults.points = (SELECT MAX(total_points) FROM (SELECT constructorResults.constructorId, SUM(constructorResults.points) AS total_points FROM constructorResults, constructors WHERE constructors.nationality = 'Italian' AND constructors.constructorId = constructorResults.constructorId GROUP BY constructorResults.constructorId ORDER BY total_points DESC)));
SELECT url FROM constructors WHERE constructorId = (SELECT constructorId FROM constructorStandings ORDER BY wins DESC LIMIT 1);
SELECT drivers.forename || ' ' || drivers.surname FROM lapTimes JOIN drivers ON lapTimes.driverId = drivers.driverId WHERE lapTimes.raceId = (SELECT raceId FROM races WHERE name = 'French Grand Prix') AND lapTimes.lap = 3 AND lapTimes.time = (SELECT MAX(time) FROM lapTimes WHERE lapTimes.raceId = (SELECT raceId FROM races WHERE name = 'French Grand Prix') AND lapTimes.lap = 3);
SELECT races.name, MIN(lapTimes.milliseconds) FROM lapTimes JOIN races ON lapTimes.raceId = races.raceId WHERE lapTimes.lap = 1 GROUP BY lapTimes.raceId ORDER BY MIN(lapTimes.milliseconds) ASC;
SELECT AVG(fastestLapTime) FROM results WHERE raceId = (SELECT raceId FROM races WHERE year = 2006 AND name = 'United States Grand Prix') AND rank < 11;
SELECT drivers.forename || ' ' || drivers.surname AS driver_name, MIN(avg_duration) AS average_pitstop_duration FROM drivers JOIN pitStops ON drivers.driverId = pitStops.driverId WHERE drivers.nationality = 'German' AND strftime('%Y', drivers.dob) > '1980' AND strftime('%Y', drivers.dob) < '1985' GROUP BY drivers.driverId ORDER BY average_pitstop_duration LIMIT 5;
SELECT drivers.forename || ' ' || drivers.surname AS champion, results.time FROM results JOIN drivers ON results.driverId = drivers.driverId WHERE results.raceId = (SELECT raceId FROM races WHERE name = 'Canadian Grand Prix' AND year = 2008) AND results.position = 1;
SELECT constructors.constructorRef, constructors.url FROM constructors JOIN results ON constructors.constructorId = results.constructorId WHERE results.raceId = (SELECT raceId FROM races WHERE year = 2009 AND name = 'Singapore Grand Prix') AND results.position = 1;
SELECT forename || ' ' || surname AS full_name, dob FROM drivers WHERE nationality = 'Asian' AND year(dob) BETWEEN '1981' AND '1991' ORDER BY dob;
SELECT forename || ' ' || surname AS full_name, url, dob FROM drivers JOIN results ON drivers.driverId = results.driverId WHERE nationality = 'German' AND year(dob) BETWEEN '1971' AND '1985' ORDER BY dob DESC;
SELECT location, country, lat, lng FROM circuits WHERE circuitRef = 'hungaroring';
SELECT SUM(points) AS score, name, nationality FROM constructors WHERE constructorId IN (SELECT constructorId FROM constructorResults WHERE raceId IN (SELECT raceId FROM races WHERE name = 'Monaco Grand Prix' AND year BETWEEN 1980 AND 2010)) GROUP BY constructorId ORDER BY score DESC LIMIT 1;
SELECT AVG(points) FROM results WHERE driverId = (SELECT driverId FROM drivers WHERE surname = 'Hamilton' AND forename = 'Lewis') AND raceId = (SELECT raceId FROM races WHERE name = 'British Grand Prix' AND year = 2011);
SELECT AVG(race_count) FROM (SELECT COUNT(*) AS race_count FROM races WHERE date BETWEEN '2000-01-01' AND '2010-12-31' GROUP BY year) AS subquery;
SELECT nationality FROM drivers GROUP BY nationality ORDER BY COUNT(*) DESC LIMIT 1;
SELECT SUM(points) FROM results WHERE driverId = (SELECT driverId FROM driverStandings WHERE raceId = (SELECT raceId FROM races WHERE year = 2017 AND position = 91)) AND raceId IN (SELECT raceId FROM races WHERE year = 2017);
SELECT races.name FROM races JOIN (SELECT raceId, MIN(fastestLapTime) AS fastestLapTime FROM results GROUP BY raceId) AS sub ON races.raceId = sub.raceId JOIN results ON sub.raceId = results.raceId AND sub.fastestLapTime = results.fastestLapTime;
SELECT location || ', ' || country AS full_location FROM circuits WHERE circuitId = (SELECT circuitId FROM races WHERE date = (SELECT MAX(date) FROM races));
SELECT forename || ' ' || surname FROM drivers WHERE driverId = (SELECT driverId FROM qualifying WHERE raceId = (SELECT raceId FROM races WHERE name = 'Singapore' AND year = 2008) AND q3 = (SELECT MIN(q3) FROM qualifying WHERE raceId = (SELECT raceId FROM races WHERE name = 'Singapore' AND year = 2008)));
SELECT d.forename || ' ' || d.surname AS full_name, d.nationality, r.name AS race_name FROM drivers d JOIN results rs ON d.driverId = rs.driverId JOIN races r ON rs.raceId = r.raceId WHERE d.dob = (SELECT MIN(dob) FROM drivers);
SELECT COUNT(*) FROM results WHERE raceId = (SELECT raceId FROM races WHERE name = 'Canadian Grand Prix') AND statusId = 3 AND driverId = (SELECT driverId FROM results WHERE raceId = (SELECT raceId FROM races WHERE name = 'Canadian Grand Prix') GROUP BY driverId ORDER BY COUNT(*) DESC LIMIT 1);
SELECT drivers.forename || ' ' || drivers.surname AS full_name, COUNT(*) AS wins FROM drivers JOIN results ON drivers.driverId = results.driverId WHERE drivers.dob = (SELECT MIN(dob) FROM drivers) AND results.position = 1;
SELECT MAX(milliseconds) FROM pitStops;
SELECT time FROM lapTimes ORDER BY milliseconds ASC LIMIT 1;
SELECT MAX(milliseconds) FROM pitStops WHERE driverId = (SELECT driverId FROM drivers WHERE surname = 'Hamilton' AND forename = 'Lewis');
SELECT lap FROM pitStops WHERE raceId = (SELECT raceId FROM races WHERE year = 2011 AND name = 'Australian Grand Prix') AND driverId = (SELECT driverId FROM drivers WHERE surname = 'Hamilton' AND forename = 'Lewis');
SELECT driverId, duration FROM pitStops WHERE raceId = (SELECT raceId FROM races WHERE year = 2011 AND name = 'Australian Grand Prix') ORDER BY duration DESC;
SELECT milliseconds FROM lapTimes WHERE driverId = (SELECT driverId FROM drivers WHERE surname = 'Hamilton' AND forename = 'Lewis') AND lap = (SELECT MIN(lap) FROM lapTimes WHERE driverId = (SELECT driverId FROM drivers WHERE surname = 'Hamilton' AND forename = 'Lewis') AND raceId = (SELECT raceId FROM races WHERE name LIKE '%Grand Prix%' AND year = 2018)) AND raceId = (SELECT raceId FROM races WHERE name LIKE '%Grand Prix%' AND year = 2018);
SELECT drivers.forename || ' ' || drivers.surname FROM lapTimes JOIN drivers ON lapTimes.driverId = drivers.driverId WHERE lapTimes.time = (SELECT MIN(time) FROM lapTimes);
SELECT circuits.name, circuits.location, circuits.country, circuits.lat, circuits.lng, circuits.alt, circuits.url, results.position FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN results ON races.raceId = results.raceId WHERE results.driverId = 1 AND results.time = (SELECT MIN(time) FROM results WHERE driverId = 1) ORDER BY results.position ASC;
SELECT milliseconds FROM lapTimes WHERE raceId = (SELECT raceId FROM races WHERE circuitId = (SELECT circuitId FROM circuits WHERE name = 'Albert Park Grand Prix Circuit')) ORDER BY milliseconds ASC LIMIT 1;
SELECT circuits.name, drivers.forename || ' ' || drivers.surname AS driver_name, lapTimes.time, races.year FROM circuits JOIN races ON circuits.circuitId = races.circuitId JOIN lapTimes ON races.raceId = lapTimes.raceId JOIN results ON lapTimes.raceId = results.raceId AND lapTimes.driverId = results.driverId JOIN drivers ON results.driverId = drivers.driverId WHERE circuits.country = 'Italy' ORDER BY lapTimes.time ASC;
SELECT races.name, MIN(lapTimes.time) FROM races JOIN lapTimes ON races.raceId = lapTimes.raceId WHERE races.circuitId = (SELECT circuitId FROM circuits WHERE circuits.name = 'Albert Park Grand Prix Circuit') GROUP BY races.name;
SELECT milliseconds FROM pitStops WHERE raceId = (SELECT raceId FROM races WHERE name = 'Australian Grand Prix' AND year = 2019) AND driverId = (SELECT driverId FROM lapTimes WHERE raceId = (SELECT raceId FROM races WHERE name = 'Australian Grand Prix' AND year = 2019) AND lap = (SELECT MIN(lap) FROM lapTimes WHERE raceId = (SELECT raceId FROM races WHERE name = 'Australian Grand Prix' AND year = 2019)) AND milliseconds = (SELECT MIN(milliseconds) FROM lapTimes WHERE raceId = (SELECT raceId FROM races WHERE name = 'Australian Grand Prix' AND year = 2019) AND lap = (SELECT MIN(lap) FROM lapTimes WHERE raceId = (SELECT raceId FROM races WHERE name = '
SELECT lat, lng FROM circuits WHERE circuitId = (SELECT circuitId FROM races WHERE raceId = (SELECT raceId FROM lapTimes WHERE time = '1:29.488'));
SELECT AVG(milliseconds) FROM pitStops WHERE driverId = (SELECT driverId FROM drivers WHERE surname = 'Hamilton' AND forename = 'Lewis') AND raceId IN (SELECT raceId FROM races WHERE year >= 2010) AND milliseconds IS NOT NULL;
SELECT AVG(milliseconds) FROM lapTimes WHERE lapTimes.lap IS NOT NULL AND lapTimes.time IS NOT NULL AND lapTimes.raceId IN (SELECT races.raceId FROM races WHERE races.circuitId IN (SELECT circuits.circuitId FROM circuits WHERE circuits.country = 'Italy'));
SELECT player_api_id FROM Player_Attributes WHERE overall_rating = (SELECT MAX(overall_rating) FROM Player_Attributes);
SELECT player_name, height FROM Player WHERE height = (SELECT MAX(height) FROM Player);
SELECT preferred_foot FROM Player_Attributes WHERE potential = (SELECT MIN(potential) FROM Player_Attributes);
SELECT COUNT(*) FROM Player_Attributes WHERE overall_rating >= 60 AND overall_rating < 66 AND defensive_work_rate = 'low';
SELECT player_fifa_api_id FROM Player_Attributes ORDER BY crossing DESC LIMIT 5;
SELECT League.name FROM Match JOIN League ON Match.league_id = League.id WHERE season = '2015/2016' GROUP BY league_id ORDER BY SUM(home_team_goal + away_team_goal) DESC LIMIT 1;
SELECT home_team_api_id FROM (SELECT home_team_api_id, COUNT(*) AS lost FROM Match WHERE season = '2015/2016' AND home_team_goal < away_team_goal GROUP BY home_team_api_id ORDER BY lost ASC) LIMIT 1;
SELECT player_name FROM Player WHERE player_api_id IN (SELECT player_api_id FROM Player_Attributes WHERE penalties = (SELECT MAX(penalties) FROM Player_Attributes) ) ORDER BY player_name LIMIT 10;
SELECT Team.team_long_name FROM Match JOIN Team ON Match.away_team_api_id = Team.team_api_id JOIN League ON Match.league_id = League.id WHERE League.name = 'Scotland Premier League' AND Match.season = '2009/2010' AND (Match.away_team_goal - Match.home_team_goal) = (SELECT MAX(Match.away_team_goal - Match.home_team_goal) FROM Match JOIN League ON Match.league_id = League.id WHERE League.name = 'Scotland Premier League' AND Match.season = '2009/2010');
SELECT buildUpPlaySpeed FROM Team_Attributes WHERE buildUpPlayDribblingClass = 'Little' ORDER BY buildUpPlaySpeed DESC LIMIT 4;
SELECT l.name, MAX(SUM(home_team_goal = away_team_goal)) FROM Match m JOIN League l ON m.league_id = l.id WHERE m.season = '2015/2016' GROUP BY l.name;
SELECT AVG(SUBTRACT((DATETIME(), birthday))) FROM Player WHERE sprint_speed >= 97 AND date > = '2013-01-01 00:00:00' AND date < = '2015-12-31 00:00:00';
SELECT League.name, COUNT(League.name) FROM Match JOIN League ON Match.league_id = League.id GROUP BY League.name ORDER BY COUNT(League.name) DESC LIMIT 1;
SELECT AVG(height) FROM Player WHERE birthday >= '1990-01-01 00:00:00' AND birthday < '1996-01-01 00:00:00';
SELECT player_api_id FROM Player_Attributes WHERE overall_rating > (SELECT AVG(overall_rating) FROM Player_Attributes WHERE substr(date,1,4) = '2010') ORDER BY player_api_id;
SELECT team_fifa_api_id FROM Team_Attributes WHERE buildUpPlaySpeed BETWEEN 51 AND 59;
SELECT team_long_name FROM Team_Attributes WHERE buildUpPlayPassing > (SELECT AVG(buildUpPlayPassing) FROM Team_Attributes WHERE buildUpPlayPassing IS NOT NULL) AND strftime('%Y', date) = '2012' ORDER BY team_long_name;
SELECT (SUM(preferred_foot = 'left') * 1.0) / COUNT(player_fifa_api_id) FROM Player_Attributes JOIN Player ON Player.player_api_id = Player_Attributes.player_api_id WHERE birthday BETWEEN '1987-01-01 00:00:00' AND '1992-12-31 00:00:00';
SELECT l.name, SUM(m.home_team_goal + m.away_team_goal) AS goals FROM Match m JOIN League l ON m.league_id = l.id GROUP BY l.name ORDER BY goals ASC LIMIT 5;
SELECT AVG(long_shots) FROM Player_Attributes WHERE player_fifa_api_id = 200389;
SELECT player_name FROM Player JOIN Player_Attributes ON Player.player_api_id = Player_Attributes.player_api_id WHERE height > 180 OR height < 180 GROUP BY player_fifa_api_id ORDER BY AVG(heading_accuracy) DESC LIMIT 10;
SELECT team_long_name FROM Team JOIN Team_Attributes ON Team.team_api_id = Team_Attributes.team_api_id WHERE buildUpPlayDribblingClass = 'normal' AND date > = '2014-01-01 00:00:00' AND date < = '2014-01-31 00:00:00' GROUP BY Team.team_api_id HAVING DIVIDE(SUM(chanceCreationPassing), COUNT(id)) > chanceCreationPassing ORDER BY chanceCreationPassing DESC;
SELECT l.name FROM Match m JOIN League l ON m.league_id = l.id WHERE m.season = '2009/2010' GROUP BY m.league_id HAVING AVG(m.home_team_goal) > AVG(m.away_team_goal) ORDER BY l.name;
SELECT team_short_name FROM Team WHERE team_long_name = 'Queens Park Rangers';
SELECT player_name, birthday FROM Player WHERE substr(birthday,1,4) = '1970' AND substr(birthday,6,2) = '10' ORDER BY player_name;
SELECT attacking_work_rate FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Franco Zennaro');
SELECT buildUpPlayPositioningClass FROM Team_Attributes WHERE team_api_id = (SELECT team_api_id FROM Team WHERE team_long_name = 'ADO Den Haag');
SELECT heading_accuracy FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Francois Affolter') AND date = '2014-09-18 00:00:00';
SELECT pa.overall_rating FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id JOIN Match m ON p.player_api_id = m.home_player_1 OR p.player_api_id = m.home_player_2 OR p.player_api_id = m.home_player_3 OR p.player_api_id = m.home_player_4 OR p.player_api_id = m.home_player_5 OR p.player_api_id = m.home_player_6 OR p.player_api_id = m.home_player_7 OR p.player_api_id = m.home_player_8 OR p.player_api_id = m.home_player_9 OR p.player_api_id = m.home_player_10 OR p.player_api_id = m.home_player_11 OR p.player_api_id = m.away_player_1 OR p.player_api_id = m.away_player_2 OR p.player_api_id =
SELECT COUNT(*) FROM Match WHERE season = '2015/2016' AND league_id = (SELECT id FROM League WHERE name = 'Scotland Premier League');
SELECT preferred_foot FROM Player_Attributes WHERE birthday = (SELECT MAX(birthday) FROM Player);
SELECT * FROM Player_Attributes WHERE potential = (SELECT MAX(potential) FROM Player_Attributes);
SELECT COUNT(*) FROM Player_Attributes WHERE weight < 130 AND attacking_work_rate LIKE '%left%';
SELECT team_short_name FROM Team JOIN Team_Attributes ON Team.team_api_id = Team_Attributes.team_api_id WHERE chanceCreationPassingClass = 'Risky' LIMIT 10;
SELECT defensive_work_rate FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'David Wilson');
SELECT birthday FROM Player WHERE player_api_id = (SELECT player_api_id FROM Player_Attributes WHERE overall_rating = (SELECT MAX(overall_rating) FROM Player_Attributes));
SELECT name FROM League WHERE country_id = (SELECT id FROM Country WHERE name = 'Netherlands');
SELECT AVG(home_team_goal) FROM Match WHERE country_id = (SELECT id FROM Country WHERE name = 'Poland') AND league_id = (SELECT id FROM League WHERE name = 'Poland Ekstraklasa' AND season = '2010/2011');
SELECT player_name, AVG(finishing) AS avg_finishing FROM Player JOIN Player_Attributes ON Player.player_api_id = Player_Attributes.player_api_id WHERE height = (SELECT MAX(height) FROM Player) OR height = (SELECT MIN(height) FROM Player) GROUP BY player_name HAVING COUNT(*) >= 10 ORDER BY avg_finishing DESC LIMIT 1;
SELECT player_name FROM Player WHERE height > 180;
SELECT COUNT(*) FROM Player WHERE strftime('%Y', birthday) >= '1990';
SELECT COUNT(*) FROM Player WHERE player_name LIKE 'Adam%' AND weight > 170;
SELECT DISTINCT player_name FROM Player JOIN Player_Attributes ON Player.player_api_id = Player_Attributes.player_api_id WHERE overall_rating > 80 AND strftime('%Y', date) BETWEEN '2008' AND '2010' ORDER BY player_name;
SELECT potential FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Aaron Doran');
SELECT * FROM Player_Attributes WHERE preferred_foot = 'left';
SELECT DISTINCT team_long_name FROM Team_Attributes JOIN Team ON Team_Attributes.team_api_id = Team.team_api_id WHERE buildUpPlaySpeedClass = 'Fast';
SELECT buildUpPlayPassingClass FROM Team_Attributes WHERE team_api_id = (SELECT team_api_id FROM Team WHERE team_short_name = 'CLB');
SELECT team_short_name FROM Team JOIN Team_Attributes ON Team.team_api_id = Team_Attributes.team_api_id WHERE buildUpPlayPassing > 70;
SELECT AVG(overall_rating) FROM Player_Attributes WHERE height > 170 AND strftime('%Y', date) BETWEEN '2010' AND '2015';
SELECT player_name, height FROM Player WHERE height = (SELECT MIN(height) FROM Player);
SELECT country.name FROM country JOIN league ON country.id = league.country_id WHERE league.name = 'Italy Serie A';
SELECT team_short_name FROM Team WHERE team_api_id IN (SELECT team_api_id FROM Team_Attributes WHERE buildUpPlaySpeed = 31 AND buildUpPlayDribbling = 53 AND buildUpPlayPassing = 32);
SELECT AVG(overall_rating) FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Aaron Doran');
SELECT COUNT(*) FROM Match WHERE league_id = (SELECT id FROM League WHERE name = 'Germany 1. Bundesliga') AND strftime('%Y-%m', date) BETWEEN '2008-08' AND '2008-10';
SELECT DISTINCT team_short_name FROM Team JOIN Match ON Team.team_api_id = Match.home_team_api_id WHERE home_team_goal = 10;
SELECT * FROM Player_Attributes WHERE balance = (SELECT MAX(balance) FROM Player_Attributes WHERE potential = 61) AND potential = 61;
SELECT AVG(ball_control) FROM Player_Attributes WHERE player_name = 'Aaron Meijers' UNION SELECT AVG(ball_control) FROM Player_Attributes WHERE player_name = 'Lukas Hinterseer';
SELECT team_long_name FROM Team WHERE team_short_name = 'GEN';
SELECT player_name FROM Player WHERE player_name = 'Aaron Lennon' OR player_name = 'Abdelaziz Barrada' ORDER BY birthday ASC LIMIT 1;
SELECT player_name, height FROM Player WHERE height = (SELECT MAX(height) FROM Player);
SELECT COUNT(*) FROM Player_Attributes WHERE preferred_foot = 'left' AND attacking_work_rate = 'low';
SELECT name FROM country WHERE id = (SELECT country_id FROM League WHERE name = 'Belgium Jupiler League');
SELECT Country.name, League.name FROM League JOIN Country ON League.country_id = Country.id WHERE Country.name = 'Germany';
SELECT player_name, overall_rating FROM Player_Attributes JOIN Player ON Player.player_api_id = Player_Attributes.player_api_id WHERE overall_rating = (SELECT MAX(overall_rating) FROM Player_Attributes);
SELECT COUNT(*) FROM Player_Attributes WHERE strftime('%Y', birthday)<'1986' AND defensive_work_rate = 'high';
SELECT player_name FROM Player WHERE player_api_id = (SELECT player_api_id FROM Player_Attributes WHERE player_api_id IN (SELECT player_api_id FROM Player WHERE player_name IN ('Alexis', 'Ariel Borysiuk', 'Arouna Kone')) AND crossing = (SELECT MAX(crossing) FROM Player_Attributes WHERE player_api_id IN (SELECT player_api_id FROM Player WHERE player_name IN ('Alexis', 'Ariel Borysiuk', 'Arouna Kone'))));
SELECT heading_accuracy FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Ariel Borysiuk');
SELECT COUNT(*) FROM Player_Attributes WHERE height > 180 AND volleys > 70;
SELECT player_name FROM Player_Attributes JOIN Player ON Player.player_api_id = Player_Attributes.player_api_id WHERE volleys > 70 AND dribbling > 70 ORDER BY player_name;
SELECT COUNT(*) FROM Match WHERE season = '2008/2009' AND country_id = (SELECT id FROM Country WHERE name = 'Belgium');
SELECT long_passing FROM Player_Attributes WHERE birthday = (SELECT MIN(birthday) FROM Player);
SELECT COUNT(*) FROM Match WHERE league_id = (SELECT id FROM League WHERE name = 'Belgium Jupiler League') AND strftime('%Y', date) = '2009' AND strftime('%m', date) = '04';
SELECT League.name, COUNT(*) FROM Match JOIN League ON Match.league_id = League.id WHERE season = '2008/2009' GROUP BY league_id ORDER BY COUNT(*) DESC LIMIT 1;
SELECT AVG(overall_rating) FROM Player_Attributes WHERE strftime('%Y', birthday) < '1986';
SELECT ROUND((overall_rating WHERE player_name = 'Ariel Borysiuk' - overall_rating WHERE player_name = 'Paulin Puel') * 100 / overall_rating WHERE player_name = 'Paulin Puel', 1) FROM Player_Attributes;
SELECT AVG(buildUpPlaySpeed) FROM Team_Attributes WHERE team_api_id = (SELECT team_api_id FROM Team WHERE team_long_name = 'Heart of Midlothian');
SELECT AVG(T1.overall_rating) FROM Player_Attributes T1 WHERE T1.player_api_id = (SELECT T2.player_api_id FROM Player T2 WHERE T2.player_name = 'Pietro Marino');
SELECT SUM(crossing) FROM Match AS T1 JOIN Player AS T2 ON T1.home_player_1 = T2.player_api_id OR T1.home_player_2 = T2.player_api_id OR T1.home_player_3 = T2.player_api_id OR T1.home_player_4 = T2.player_api_id OR T1.home_player_5 = T2.player_api_id OR T1.home_player_6 = T2.player_api_id OR T1.home_player_7 = T2.player_api_id OR T1.home_player_8 = T2.player_api_id OR T1.home_player_9 = T2.player_api_id OR T1.home_player_10 = T2.player_api_id OR T1.home_player_11 = T2.player_api_id OR T1.away_player_
SELECT chanceCreationPassing, chanceCreationPassingClass FROM Team_Attributes WHERE team_api_id = (SELECT team_api_id FROM Team WHERE team_long_name = 'Ajax') AND chanceCreationPassing = (SELECT MAX(chanceCreationPassing) FROM Team_Attributes WHERE team_api_id = (SELECT team_api_id FROM Team WHERE team_long_name = 'Ajax'));
SELECT preferred_foot FROM Player_Attributes WHERE player_name = 'Abdou Diallo';
SELECT MAX(overall_rating) FROM Player_Attributes T1 JOIN Player T2 ON T1.player_api_id = T2.player_api_id WHERE T2.player_name = 'Dorlan Pabon';
SELECT AVG(away_team_goal) FROM Match WHERE away_team_api_id = (SELECT team_api_id FROM Team WHERE team_long_name = 'Parma') AND country_id = (SELECT id FROM Country WHERE name = 'Italy');
SELECT player_name FROM Player WHERE birthday = (SELECT MIN(birthday) FROM Player WHERE player_api_id IN (SELECT player_api_id FROM Player_Attributes WHERE overall_rating = 77 AND date = '2016/6/23'));
SELECT overall_rating FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Aaron Mooy') AND date = '2016-02-04 00:00:00';
SELECT potential FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Francesco Parravicini') AND date = '2010-08-30 00:00:00';
SELECT attacking_work_rate FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Francesco Migliore') AND date = '2015-05-01 00:00:00';
SELECT defensive_work_rate FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Kevin Berigaud') AND date = '2013-02-22 00:00:00';
SELECT date FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Kevin Constant') AND crossing = (SELECT MAX(crossing) FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Kevin Constant'));
SELECT buildUpPlaySpeedClass FROM Team_Attributes WHERE team_api_id = (SELECT team_api_id FROM Team WHERE team_long_name = 'Willem II') AND date = '2012-02-22 00:00:00';
SELECT buildUpPlayDribblingClass FROM Team_Attributes WHERE team_api_id = (SELECT team_api_id FROM Team WHERE team_short_name = 'LEI') AND date = '2015-09-10 00:00:00';
SELECT buildUpPlayPassingClass FROM Team_Attributes WHERE team_api_id = (SELECT team_api_id FROM Team WHERE team_long_name = 'FC Lorient') AND date = '2010-02-22';
SELECT chanceCreationPassingClass FROM Team_Attributes WHERE team_api_id = (SELECT team_api_id FROM Team WHERE team_long_name = 'PEC Zwolle') AND date = '2013-09-20 00:00:00';
SELECT chanceCreationCrossingClass FROM Team_Attributes WHERE team_api_id = (SELECT team_api_id FROM Team WHERE team_long_name = 'Hull City') AND date = '2010-02-22 00:00:00';
SELECT defenceAggressionClass FROM Team_Attributes WHERE team_api_id = (SELECT team_api_id FROM Team WHERE team_long_name = 'Hannover 96') AND date = '2015-09-10 00:00:00';
SELECT AVG(overall_rating) FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Marko Arnautovic') AND date BETWEEN '2007-02-22 00:00:00' and '2016-04-21 00:00:00';
SELECT ROUND(DIVIDE(SUBTRACT((SELECT overall_rating FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Landon Donovan') AND date = '2013-07-12'), (SELECT overall_rating FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Jordan Bowery') AND date = '2013-07-12')), (SELECT overall_rating FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Landon Donovan') AND date = '2013-07-12'))*100, 2) AS percentage;
SELECT player_name FROM Player WHERE height = (SELECT MAX(height) FROM Player) LIMIT 5;
SELECT player_api_id FROM Player ORDER BY weight DESC LIMIT 10;
SELECT player_name FROM Player WHERE datetime(CURRENT_TIMESTAMP,'localtime') - datetime(birthday) > 34 ORDER BY player_name;
SELECT COUNT(home_team_goal) FROM Match WHERE match_api_id IN (SELECT match_api_id FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Aaron Lennon'));
SELECT SUM(away_team_goal) FROM Match WHERE match_api_id IN (SELECT match_api_id FROM Player_Attributes WHERE player_api_id IN (SELECT player_api_id FROM Player WHERE player_name = 'Daan Smith' OR player_name = 'Filipe Ferreira'));
SELECT SUM(home_team_goal) FROM Match WHERE home_team_goal > 0 AND home_player_1 IN (SELECT player_api_id FROM Player WHERE SUBTRACT(datetime(CURRENT_TIMESTAMP,'localtime'), datetime(birthday)) < 31) OR home_player_2 IN (SELECT player_api_id FROM Player WHERE SUBTRACT(datetime(CURRENT_TIMESTAMP,'localtime'), datetime(birthday)) < 31) OR home_player_3 IN (SELECT player_api_id FROM Player WHERE SUBTRACT(datetime(CURRENT_TIMESTAMP,'localtime'), datetime(birthday)) < 31) OR home_player_4 IN (SELECT player_api_id FROM Player WHERE SUBTRACT(datetime(CURRENT_TIMESTAMP,'localtime'), datetime(birthday)) < 31) OR home_player_5 IN (SELECT player_api_id FROM Player WHERE SUBTRACT(datetime(CURRENT_TIMESTAMP,'localtime'), datetime(birthday)) < 31) OR home_player_6 IN (SELECT player
SELECT player_name FROM Player WHERE player_api_id IN (SELECT player_api_id FROM Player_Attributes WHERE overall_rating = (SELECT MAX(overall_rating) FROM Player_Attributes));
SELECT player_name FROM Player WHERE player_api_id = (SELECT player_api_id FROM Player_Attributes WHERE potential = (SELECT MAX(potential) FROM Player_Attributes));
SELECT player_name FROM Player_Attributes WHERE attacking_work_rate = 'high';
SELECT player_name FROM Player WHERE birthday = (SELECT MAX(SUBTRACT(datetime(CURRENT_TIMESTAMP,'localtime'),datetime(birthday))) FROM Player_Attributes WHERE finishing = 1);
SELECT player_name FROM Player WHERE player_api_id IN (SELECT player_api_id FROM Player_Attributes WHERE player_api_id IN (SELECT player_api_id FROM Player WHERE player_fifa_api_id IN (SELECT team_fifa_api_id FROM Team WHERE team_api_id IN (SELECT home_team_api_id FROM Match WHERE country_id = (SELECT id FROM Country WHERE name = 'Belgium')) OR team_api_id IN (SELECT away_team_api_id FROM Match WHERE country_id = (SELECT id FROM Country WHERE name = 'Belgium')))));
SELECT DISTINCT country.name FROM country JOIN player ON country.id = player.country_id JOIN player_attributes ON player.player_api_id = player_attributes.player_api_id WHERE player_attributes.vision > 89;
SELECT country.name FROM country JOIN (SELECT AVG(weight) AS avg_weight, country_id FROM player JOIN (SELECT team_api_id FROM team) AS team ON player.player_api_id = team.team_api_id GROUP BY country_id) AS country_weight ON country.id = country_weight.country_id ORDER BY avg_weight DESC LIMIT 1;
SELECT team_long_name FROM Team WHERE team_api_id IN (SELECT team_api_id FROM Team_Attributes WHERE buildUpPlaySpeedClass = 'Slow');
SELECT team_short_name FROM Team JOIN Team_Attributes ON Team.team_api_id = Team_Attributes.team_api_id WHERE chanceCreationPassingClass = 'Safe';
SELECT AVG(height) FROM Player WHERE country_id = (SELECT id FROM Country WHERE name = 'Italy');
SELECT player_name FROM Player WHERE height > 180 LIMIT 3;
SELECT COUNT(*) FROM Player WHERE birthday > '1990' AND player_name LIKE 'Aaron%';
SELECT (SELECT jumping FROM Player_Attributes WHERE id = 23) - (SELECT jumping FROM Player_Attributes WHERE id = 6);
SELECT id FROM Player_Attributes WHERE potential = (SELECT MIN(potential) FROM Player_Attributes) AND preferred_foot = 'right' LIMIT 3;
SELECT COUNT(*) FROM Player_Attributes WHERE crossing = (SELECT MAX(crossing) FROM Player_Attributes) AND preferred_foot = 'left';
SELECT ROUND(CAST(COUNT(*) AS FLOAT) / CAST((SELECT COUNT(*) FROM Player) AS FLOAT) * 100) FROM Player_Attributes WHERE strength > 80 AND stamina > 80;
SELECT name FROM Country WHERE id = (SELECT country_id FROM League WHERE name = 'English Premier League');
SELECT home_team_goal, away_team_goal FROM Match WHERE date LIKE '2008-09-24%' AND league_id = (SELECT id FROM League WHERE name = 'Belgian Jupiler League');
SELECT sprint_speed, agility, acceleration FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player WHERE player_name = 'Alexis Blin');
SELECT team_long_name, buildUpPlaySpeedClass FROM Team_Attributes WHERE team_long_name = 'KSV Cercle Brugge';
SELECT COUNT(*) FROM Match WHERE season = '2015/2016' AND league_id = 10257;
SELECT MAX(home_team_goal) FROM Match WHERE league_id = (SELECT id FROM League WHERE name = 'Netherlands Eredivisie');
SELECT finishing / overall_rating AS finishing_rate, curve / overall_rating AS curve_score FROM Player_Attributes WHERE weight = (SELECT MAX(weight) FROM Player);
SELECT name FROM League WHERE id = (SELECT league_id FROM (SELECT league_id, COUNT(id) AS num FROM Match WHERE season = '2015/2016' GROUP BY league_id ORDER BY num DESC LIMIT 1));
SELECT team_long_name FROM Team WHERE team_api_id = (SELECT away_team_api_id FROM Match GROUP BY away_team_api_id ORDER BY COUNT(away_team_goal) DESC LIMIT 1);
SELECT player_name FROM Player_Attributes JOIN Player ON Player_Attributes.player_api_id = Player.player_api_id WHERE overall_rating = (SELECT MAX(overall_rating) FROM Player_Attributes) GROUP BY player_name;
SELECT ROUND(CAST(COUNT(height < 180 AND overall_rating > 70) AS FLOAT) / COUNT(id) * 100, 2) AS percentage FROM Player_Attributes;
SELECT ROUND((COUNT(CASE WHEN SEX = 'M' AND Admission = '+' THEN ID END) - COUNT(CASE WHEN SEX = 'M' AND Admission = '-' THEN ID END)) * 100.0 / COUNT(CASE WHEN SEX = 'M' THEN ID END), 2) FROM Patient;
SELECT ROUND(DIVIDE(COUNT(CASE WHEN year(Birthday) > 1930 THEN ID END AND SEX = 'F'), COUNT(CASE WHEN SEX = 'F' THEN ID END)) * 100, 2) FROM Patient;
SELECT COUNT(*)*100.0/COUNT(DISTINCT ID) FROM Examination WHERE Admission = '+' AND year(Birthday) BETWEEN '1930-01-01' AND '1940-01-01';
SELECT COUNT(ID) WHERE Diagnosis = 'SLE' AND Admission = '-' / COUNT(ID) WHERE Diagnosis = 'SLE' AND Admission = '+';
SELECT Diagnosis, Date FROM Examination WHERE ID = 30609;
SELECT Patient.SEX, Patient.Birthday, Examination.`Examination Date`, Examination.Symptoms FROM Patient JOIN Examination ON Patient.ID = Examination.ID WHERE Patient.ID = 163109;
SELECT Patient.ID, SEX, Birthday FROM Patient JOIN Laboratory ON Patient.ID = Laboratory.ID WHERE LDH > 500 ORDER BY Patient.ID;
SELECT ID, year(current_timestamp) - year(Birthday) as age FROM Patient WHERE ID IN (SELECT ID FROM Examination WHERE RVVT = '+');
SELECT Examination.ID, Patient.SEX, Examination.Diagnosis FROM Examination JOIN Patient ON Examination.ID = Patient.ID WHERE Examination.Thrombosis = 2;
SELECT * FROM Laboratory WHERE ID IN (SELECT ID FROM Patient WHERE strftime('%Y', Birthday) = '1937') AND `T-CHO` >= '250';
SELECT Patient.ID, SEX, Diagnosis FROM Patient JOIN Laboratory ON Patient.ID = Laboratory.ID WHERE ALB < 3.5 ORDER BY Patient.ID;
SELECT ROUND(CAST(COUNT(CASE WHEN SEX = 'F' AND (TP < 6.0 OR TP > 8.5) THEN ID END) AS FLOAT) / COUNT(CASE WHEN SEX = 'F' THEN ID END) * 100, 2) FROM Patient;
SELECT AVG(`aCL IgG`) FROM Examination WHERE ID IN (SELECT ID FROM Patient WHERE Admission = '+' AND SUBTRACT(year(current_timestamp), year(Birthday)) > '50');
SELECT COUNT(*) FROM Patient WHERE SEX = 'F' AND year(Description) = '1997' AND Admission = '-';
SELECT MIN(YEAR(`First Date`) - YEAR(Birthday)) FROM Patient;
SELECT COUNT(*) FROM Examination e JOIN Patient p ON e.ID = p.ID WHERE Thrombosis = '1' AND SEX = 'F' AND YEAR(`Examination Date`) = 1997;
SELECT MAX(year(Birthday)) - MIN(year(Birthday)) FROM Patient WHERE TG >= 200;
SELECT Symptoms, Diagnosis FROM Examination WHERE ID = (SELECT ID FROM Patient WHERE Birthday = (SELECT MIN(Birthday) FROM Patient));
SELECT DIVIDE(COUNT(ID), 12) FROM Patient WHERE SEX = 'M' AND year(`First Date`) = 1998;
SELECT Laboratory.Date, (SUBTRACT(year(`First Date`)), year(Birthday))) AS age FROM Laboratory JOIN Patient ON Laboratory.ID = Patient.ID WHERE Diagnosis = 'Aortitis' AND Birthday = (SELECT MAX(Birthday) FROM Patient WHERE Diagnosis = 'Aortitis');
SELECT ROUND(DIVIDE(SUM(UA > '8.0' and SEX = 'M'), SUM(UA > '6.5' and SEX = 'F')), 2) FROM Laboratory l JOIN Patient p ON l.ID = p.ID WHERE (SEX = 'M' AND UA <= '8.0') OR (SEX = 'F' AND UA > '6.5');
SELECT COUNT(*) FROM Examination WHERE year(`Examination Date`) - year(`First Date`) >= 1;
SELECT COUNT(*) FROM Examination WHERE `Examination Date` BETWEEN '1990-01-01' AND '1993-12-31' AND (SELECT year(`Birthday`) FROM Patient WHERE Examination.ID = Patient.ID) < 18;
SELECT COUNT(*) FROM Patient p JOIN Laboratory l ON p.ID = l.ID WHERE p.SEX = 'M' AND l.`T-BIL` > 2.0;
SELECT Diagnosis FROM Examination WHERE `Examination Date` BETWEEN '1985-01-01' AND '1995-12-31' GROUP BY Diagnosis ORDER BY COUNT(Diagnosis) DESC LIMIT 1;
SELECT AVG(SUBTRACT('1991', year(Birthday))) FROM Patient WHERE ID IN (SELECT ID FROM Examination WHERE Date BETWEEN '1991-10-01' AND '1991-10-30');
SELECT `Examination Date`, Diagnosis, MAX(HGB), SUBTRACT(year(`Examination Date`), year(Birthday)) FROM Examination JOIN Laboratory ON Examination.ID = Laboratory.ID WHERE HGB = (SELECT MAX(HGB) FROM Laboratory) GROUP BY Examination.ID;
SELECT ANA FROM Examination WHERE ID = 3605340 AND `Examination Date` = '1996-12-02';
SELECT `T-CHO` < 250 FROM Laboratory WHERE ID = 2927464 AND Date = '1995-09-04';
SELECT SEX FROM Patient WHERE Diagnosis = 'AORTITIS' ORDER BY Birthday LIMIT 1;
SELECT aCL_IgM FROM Examination WHERE Diagnosis = 'SLE' AND Description = '1994-02-19' AND ID = (SELECT ID FROM Patient WHERE Description = '1993/11/12');
SELECT SEX FROM Patient WHERE ID = (SELECT ID FROM Examination WHERE GPT = '9' AND Date = '1992-06-12');
SELECT SUBTRACT('1991-10-21', year(Birthday)) AS age FROM Patient WHERE UA = '8.4' AND Date = '1991-10-21';
SELECT COUNT(ID) FROM Laboratory WHERE ID = (SELECT ID FROM Patient WHERE `First Date` = '1991-06-13' AND Diagnosis = 'SJS') AND Date LIKE '1995%';
SELECT Diagnosis FROM Examination WHERE Diagnosis != 'SLE' AND ID = (SELECT ID FROM Examination WHERE Diagnosis = 'SLE' AND `Examination Date` = '1997-01-27') AND `Examination Date` = (SELECT MIN(`Examination Date`) FROM Examination WHERE ID = (SELECT ID FROM Examination WHERE Diagnosis = 'SLE' AND `Examination Date` = '1997-01-27'));
SELECT Symptoms FROM Examination WHERE ID = (SELECT ID FROM Patient WHERE Birthday = '1959/3/1') AND `Examination Date` = '1993/9/27';
SELECT (SUM(Birthday = '1959-02-18' and Date like '1981-11-%' THEN `T-CHO`) - SUM(Birthday = '1959-02-18' and Date like '1981-12-%' THEN `T-CHO`)) / SUM(Birthday = '1959-02-18' and Date like '1981-11-%' THEN `T-CHO`);
SELECT ID FROM Examination WHERE Diagnosis = 'Behcet' AND YEAR(Description) >= '1997-1-1' AND YEAR(Description) < '1998-1-1' ORDER BY ID;
SELECT ID FROM Examination WHERE `Examination Date` BETWEEN '1987-07-06' AND '1996-01-31' AND GPT > 30 AND ALB < 4;
SELECT COUNT(*) FROM Patient WHERE SEX = 'F' AND YEAR(Birthday) = 1964 AND Admission = '+'; SELECT ID FROM Patient WHERE SEX = 'F' AND YEAR(Birthday) = 1964 AND Admission = '+';
SELECT COUNT(*) FROM Examination WHERE Thrombosis = 2 AND `ANA Pattern` = 'S' AND `aCL IgM` > (SELECT AVG(`aCL IgM`) * 1.2 FROM Examination);
SELECT ROUND(COUNT(CASE WHEN UA <= 6.5 THEN 1 END) * 100.0 / COUNT(CASE WHEN `U-PRO` > 0 AND `U-PRO` < 30 THEN 1 END)) FROM Examination;
SELECT DIVIDE(SUM(Diagnosis = 'BEHCET' AND SEX = 'M' AND YEAR(`FIRST DATE`) = '1981'), MULTIPLY(COUNT(Diagnosis = 'BEHCET' AND SEX = 'M' AND YEAR(`FIRST DATE`) = '1981'), 100) FROM Examination JOIN Patient ON Examination.ID = Patient.ID;
SELECT Examination.ID, Examination.`Examination Date` FROM Examination JOIN Patient ON Examination.ID = Patient.ID JOIN Laboratory ON Examination.ID = Laboratory.ID AND Examination.`Examination Date` = Laboratory.Date WHERE Admission = '-' AND Examination.`Examination Date` LIKE '1991-10%' AND `T-BIL` < 2.0;
SELECT COUNT(*) FROM Examination e JOIN Patient p ON e.ID = p.ID WHERE `ANA Pattern` != 'p' AND SEX = 'F' AND strftime('%Y', Birthday) BETWEEN '1980' AND '1989';
SELECT Patient.SEX FROM Examination JOIN Patient ON Examination.ID = Patient.ID JOIN Laboratory ON Examination.ID = Laboratory.ID WHERE Examination.Diagnosis = 'PSS' AND Laboratory.CRP > 2 AND Laboratory.CRE = 1 AND Laboratory.LDH = 123;
SELECT AVG(ALB) FROM Laboratory WHERE PLT > 400 AND ID IN (SELECT ID FROM Examination WHERE Diagnosis = 'SLE' AND ID IN (SELECT ID FROM Patient WHERE SEX = 'F'));
SELECT MAX(Symptoms) FROM Examination WHERE Diagnosis = 'SLE';
SELECT Examination.`Examination Date`, Examination.Diagnosis FROM Examination WHERE Examination.ID = 48473 ORDER BY Examination.`Examination Date` ASC LIMIT 1;
SELECT COUNT(*) FROM Patient WHERE Diagnosis = 'APS' AND SEX = 'F';
SELECT COUNT(*) FROM Examination WHERE YEAR(`Examination Date`) = '1997' AND (tp < 6 OR tp > 8.5);
SELECT ROUND((SUM(Symptoms LIKE '%thrombocytopenia%') * 100.0 / SUM(Diagnosis LIKE '%SLE%')), 0) FROM Examination;
SELECT ROUND(DIVIDE((SELECT COUNT(*) FROM Patient WHERE YEAR(Birthday) = '1980' AND Diagnosis = 'RA' AND SEX = 'F'), (SELECT COUNT(*) FROM Patient WHERE YEAR(Birthday) = '1980' AND Diagnosis = 'RA')) * 100);
SELECT COUNT(*) FROM Examination e JOIN Patient p ON e.ID = p.ID WHERE SEX = 'M' AND `Examination Date` BETWEEN '1995' AND '1997' AND Diagnosis = 'BEHCET' AND Admission = '-';
SELECT COUNT(*) FROM Laboratory WHERE ID IN (SELECT ID FROM Patient WHERE SEX = 'F') AND WBC < 3.5;
SELECT DATEDIFF((SELECT `Examination Date` FROM Examination WHERE ID = 821298), (SELECT `First Date` FROM Patient WHERE ID = 821298));
SELECT SEX FROM Patient p JOIN Laboratory l ON p.ID = l.ID WHERE p.ID = 57266 AND ((p.SEX = 'M' AND l.UA > 8.0) OR (p.SEX = 'F' AND l.UA > 6.5));
SELECT * FROM Laboratory WHERE ID = 48473 AND GOT >= 60;
SELECT Patient.ID, SEX, Birthday FROM Patient JOIN Examination ON Patient.ID = Examination.ID JOIN Laboratory ON Examination.ID = Laboratory.ID AND Examination.`Examination Date` = Laboratory.Date WHERE year(Examination.`Examination Date`) = 1994 AND GOT < 60;
SELECT DISTINCT Patient.ID FROM Patient JOIN Laboratory ON Patient.ID = Laboratory.ID WHERE Laboratory.GPT >= 60 AND Patient.SEX = 'M';
SELECT Patient.Diagnosis FROM Examination JOIN Patient ON Examination.ID = Patient.ID WHERE Examination.GPT > 60 AND Examination.Diagnosis IS NOT NULL ORDER BY Patient.Birthday ASC;
SELECT AVG(LDH) FROM Laboratory WHERE LDH < 500;
SELECT ID, year(current_timestamp) - year(Birthday) as age FROM Patient WHERE LDH BETWEEN 600 AND 800;
SELECT Admission FROM Patient WHERE ALP < 300;
SELECT ID, ALP FROM Laboratory WHERE Birthday = '1982-04-01' AND ALP < 300;
SELECT Patient.ID, Patient.SEX, Patient.Birthday FROM Patient JOIN Laboratory ON Patient.ID = Laboratory.ID WHERE Laboratory.TP < 6.0;
SELECT SUBTRACT(TP, 8.5) FROM Laboratory WHERE ID IN (SELECT ID FROM Patient WHERE SEX = 'F') AND TP > 8.5;
SELECT * FROM Patient WHERE SEX = 'M' AND (ALB < = 3.5 OR ALB > = 5.5) ORDER BY Birthday DESC;
SELECT COUNT(*) FROM Laboratory WHERE ID IN (SELECT ID FROM Patient WHERE strftime('%Y', Birthday) = '1982') AND ALB BETWEEN 3.5 AND 5.5;
SELECT COUNT(*)*1.0/COUNT(SEX) FROM Examination e JOIN Patient p ON e.ID = p.ID WHERE UA > 6.5 AND SEX = 'F';
SELECT AVG(UA) FROM (SELECT ID, UA FROM Laboratory WHERE Date = (SELECT MAX(Date) FROM Laboratory WHERE ID = l.ID) AND (SEX = 'F' AND UA < 8.0 OR SEX = 'M' AND UA < 6.5)) l;
SELECT ID, SEX, Birthday FROM Patient WHERE UN = 29 AND UN IS NOT NULL;
SELECT ID, SEX, Birthday FROM Patient WHERE Diagnosis = 'RA' AND UN < 30 ORDER BY Birthday;
SELECT COUNT(*) FROM Laboratory l JOIN Patient p ON l.ID = p.ID WHERE CRE >= 1.5 AND SEX = 'M';
SELECT SUM(SEX = 'M') > SUM(SEX = 'F') FROM Patient JOIN Laboratory ON Patient.ID = Laboratory.ID WHERE CRE >= 1.5;
SELECT Laboratory.`T-BIL`, Patient.ID, Patient.SEX, Patient.Birthday FROM Laboratory JOIN Patient ON Laboratory.ID = Patient.ID WHERE Laboratory.`T-BIL` = (SELECT MAX(`T-BIL`) FROM Laboratory);
SELECT Patient.SEX, Laboratory.`T-BIL` FROM Patient JOIN Laboratory ON Patient.ID = Laboratory.ID WHERE Laboratory.`T-BIL` >= 2.0 AND Laboratory.`T-BIL` IS NOT NULL GROUP BY Patient.SEX;
SELECT Laboratory.ID, `T-CHO` FROM Laboratory JOIN (SELECT ID, MIN(Birthday) AS Birthday FROM Patient) AS Patient ON Laboratory.ID = Patient.ID WHERE `T-CHO` = (SELECT MAX(`T-CHO`) FROM Laboratory);
SELECT DIVIDE(SUM(SUBTRACT(YEAR(NOW()), YEAR(birthday))), COUNT(ID)) FROM Patient WHERE SEX = 'M' AND `T-CHO` >= 250;
SELECT Patient.ID, Examination.Diagnosis FROM Patient JOIN Examination ON Patient.ID = Examination.ID JOIN Laboratory ON Patient.ID = Laboratory.ID WHERE Laboratory.TG > 300;
SELECT COUNT(*) FROM Laboratory l JOIN Patient p ON l.ID = p.ID WHERE TG >= 200 AND SUBTRACT(year(current_timestamp), year(Birthday)) > 50;
SELECT DISTINCT ID FROM Laboratory WHERE Admission = '-' AND CPK < 250 ORDER BY ID;
SELECT COUNT(*) FROM Laboratory WHERE ID IN (SELECT ID FROM Patient WHERE year(Birthday) BETWEEN '1936' AND '1956' AND SEX = 'M') AND CPK >= 250;
SELECT ID, SEX, year(current_timestamp) - year(Birthday) AS age FROM Patient WHERE GLU >= 180 AND `T-CHO` < 250 ORDER BY age ASC;
SELECT ID, GLU FROM Laboratory WHERE GLU < 180 AND year(Description) >= 1991 ORDER BY ID;
SELECT p.ID, p.SEX, p.Birthday, (strftime('%Y', 'now') - strftime('%Y', p.Birthday)) AS age FROM Patient p JOIN Laboratory l ON p.ID = l.ID WHERE l.WBC <= 3.5 OR l.WBC >= 9.0 ORDER BY p.SEX, age ASC;
SELECT Examination.Diagnosis, Examination.ID, SUBTRACT(year(current_timestamp), year(Birthday)) as age FROM Examination JOIN Patient ON Examination.ID = Patient.ID WHERE Examination.RBC < 3.5 ORDER BY age ASC;
SELECT Patient.ID, Patient.SEX, Patient.Birthday, Laboratory.RBC, Patient.Admission FROM Patient JOIN Laboratory ON Patient.ID = Laboratory.ID WHERE Patient.SEX = 'F' AND SUBTRACT(year(current_timestamp), year(Birthday)) >= 50 AND (Laboratory.RBC <= 3.5 OR Laboratory.RBC >= 6.0) AND Patient.Admission = '+';
SELECT Examination.ID, Patient.SEX FROM Examination JOIN Patient ON Examination.ID = Patient.ID WHERE Admission = '-' AND HGB < 10 ORDER BY Examination.ID;
SELECT ID, SEX FROM Patient WHERE Diagnosis = 'SLE' AND HGB >= 17 AND Birthday = (SELECT MIN(Birthday) FROM Patient WHERE Diagnosis = 'SLE' AND HGB >= 17);
SELECT Examination.ID, SUBTRACT(year(current_timestamp), year(Birthday)) AS age FROM Examination JOIN Patient ON Examination.ID = Patient.ID WHERE HCT >= 52 GROUP BY Examination.ID HAVING COUNT(Examination.ID) > 2;
SELECT AVG(HCT) FROM Laboratory WHERE HCT < 29 AND Date LIKE '1991%';
SELECT (SELECT COUNT(*) FROM Examination WHERE PLT < 100) - (SELECT COUNT(*) FROM Examination WHERE PLT > 400);
SELECT Examination.ID, Examination.`Examination Date` FROM Examination JOIN Patient ON Examination.ID = Patient.ID WHERE Examination.`Examination Date` LIKE '1984%' AND SUBTRACT(year(current_timestamp), year(Birthday)) < 50 AND Examination.PLT BETWEEN 100 AND 400;
SELECT MULTIPLY(DIVIDE(SUM(PT > = 14 AND SEX = 'F'), SUM(PT > = 14)), 1.0) FROM Examination WHERE SUBTRACT(year(current_timestamp), year(Birthday)) > 55;
SELECT Examination.ID, `Examination Date` FROM Examination JOIN Patient ON Examination.ID = Patient.ID WHERE `First Date` >= 1992 AND PT < 14 ORDER BY `Examination Date`;
SELECT COUNT(*) FROM Examination WHERE `Examination Date` >= '1997-01-01' AND APTT < 45;
SELECT COUNT(DISTINCT ID) FROM Examination WHERE APTT > 45 AND Thrombosis = 3;
SELECT COUNT(*) FROM Laboratory WHERE ID IN (SELECT ID FROM Patient WHERE SEX = 'M') AND WBC BETWEEN 3.5 AND 9.0 AND (FG < 150 OR FG > 450);
SELECT COUNT(DISTINCT ID) FROM Examination WHERE FG < 150 OR FG > 450 AND ID IN (SELECT ID FROM Patient WHERE Birthday > = '1980-01-01');
SELECT DISTINCT Diagnosis FROM Examination WHERE `U-PRO` >= 30 AND Diagnosis IS NOT NULL;
SELECT ID FROM Examination WHERE `U-PRO` < 30 AND Diagnosis = 'SLE';
SELECT COUNT(*) FROM Examination WHERE `aCL IgG` < 900 AND Symptoms = 'abortion';
SELECT COUNT(*) FROM Examination WHERE `aCL IgG` BETWEEN 900 AND 2000 AND Symptoms IS NOT NULL;
SELECT Diagnosis FROM Examination JOIN Patient ON Examination.ID = Patient.ID WHERE `aCL IgA` BETWEEN 80 AND 500 ORDER BY `aCL IgA` DESC LIMIT 1;
SELECT COUNT(*) FROM Patient WHERE `First Date` >= '1990-01-01' AND IGA BETWEEN 80 AND 500;
SELECT Diagnosis FROM Examination WHERE `aCL IgM` NOT BETWEEN 40 AND 400 GROUP BY Diagnosis ORDER BY COUNT(Diagnosis) DESC LIMIT 1;
SELECT COUNT(*) FROM Examination WHERE (CRP LIKE '+' OR CRP LIKE '-' OR CRP < 1.0) AND Description IS NULL;
SELECT COUNT(DISTINCT ID) FROM Examination WHERE CRP NOT IN('+-', '-') AND CRP >= 1.0 AND (strftime('%Y', 'now') - strftime('%Y', Birthday)) < 18;
SELECT COUNT(DISTINCT Examination.ID) FROM Examination WHERE RA IN ('-', '+-') AND KCT = '+';
SELECT DISTINCT Diagnosis FROM Examination WHERE ID IN (SELECT ID FROM Patient WHERE YEAR(Birthday) >= 1995 AND RA IN('-', '+-'));
SELECT ID FROM Examination WHERE RF < 20 AND (strftime('%Y', 'now') - strftime('%Y', Birthday)) > 60;
SELECT COUNT(*) FROM Examination WHERE RF < 20 AND Thrombosis = '0';
SELECT COUNT(DISTINCT Examination.ID) FROM Examination JOIN Laboratory ON Examination.ID = Laboratory.ID WHERE C3 > 35 AND ANA Pattern = 'P';
SELECT ID FROM Examination WHERE `aCL IgA` = (SELECT MAX(`aCL IgA`) FROM Examination WHERE C3 <= 35);
SELECT COUNT(*) FROM Examination e JOIN Laboratory l ON e.ID = l.ID WHERE e.Thrombosis = 1 AND l.C4 > 10;
SELECT COUNT(DISTINCT ID) FROM Examination WHERE RNP = '-' OR RNP = '+-' AND Admission = '+';
SELECT Birthday FROM Patient WHERE ID = (SELECT ID FROM Examination WHERE RNP NOT IN('-', '+-') ORDER BY Birthday DESC LIMIT 1);
SELECT COUNT(*) FROM Examination WHERE SM = 'negative' AND Thrombosis = '1';
SELECT ID FROM Examination WHERE SM NOT IN ('-', '+-') ORDER BY Birthday ASC LIMIT 3;
SELECT DISTINCT ID FROM Examination WHERE `Examination Date` >= '1997-01-01' AND (SC170 = '+-' OR SC170 = '-');
SELECT COUNT(DISTINCT ID) FROM Examination WHERE SC170 IN ('-', '+-') AND SEX = 'M' AND Symptoms = 'vertigo';
SELECT COUNT(DISTINCT ID) FROM Examination WHERE SSA IN ('-', '+-') AND YEAR(`First Date`) < 1990;
SELECT ID FROM Examination WHERE SSA NOT IN('-', '+-') AND `First Date` = (SELECT MIN(`First Date`) FROM Patient);
SELECT COUNT(DISTINCT ID) FROM Examination WHERE (`SSB` = '-' OR `SSB` = '+-') AND Diagnosis = 'SLE';
SELECT COUNT(DISTINCT Examination.ID) FROM Examination JOIN Patient ON Examination.ID = Patient.ID WHERE SSB IN ('-', '+-') AND Symptoms IS NOT NULL;
SELECT COUNT(*) FROM Laboratory WHERE CENTROMEA IN('-','+-') AND SSB IN('-','+-') AND ID IN (SELECT ID FROM Patient WHERE SEX = 'M');
SELECT Diagnosis FROM Examination WHERE DNA >= 8;
SELECT COUNT(DISTINCT ID) FROM Laboratory WHERE DNA < 8 AND Description IS NULL;
SELECT COUNT(*) FROM Examination WHERE `DNA-II` > 8 AND Admission = '+';
SELECT COUNT(ID WHERE DNA-II < 8 AND Diagnosis = 'SLE') / COUNT(ID WHERE DNA-II < 8) * 100.0 AS percentage FROM Laboratory WHERE DNA-II < 8;
SELECT COUNT(*) FROM Laboratory l JOIN Patient p ON l.ID = p.ID WHERE p.SEX = 'M' AND l.GOT < 60;
SELECT MIN(Birthday) FROM Patient WHERE ID IN (SELECT ID FROM Laboratory WHERE GOT >= 60);
SELECT Birthday FROM Patient WHERE ID IN (SELECT ID FROM Laboratory WHERE GOT < 60 ORDER BY GOT DESC LIMIT 3);
SELECT COUNT(*) FROM Patient p JOIN Laboratory l ON p.ID = l.ID WHERE l.GOT < 60 AND p.SEX = 'M';
SELECT MIN(Date) FROM Laboratory WHERE LDH = (SELECT MAX(LDH) FROM Laboratory WHERE LDH < 500);
SELECT `Examination Date` FROM Examination JOIN Laboratory ON Examination.ID = Laboratory.ID AND Examination.`Examination Date` = Laboratory.Date WHERE Examination.ID = (SELECT ID FROM Patient WHERE `First Date` = (SELECT MAX(`First Date`) FROM Patient)) AND LDH >= 500;
SELECT COUNT(*) FROM Patient p JOIN Laboratory l ON p.ID = l.ID WHERE l.ALP >= 300 AND p.Admission = '+';
SELECT COUNT(*) FROM Examination e JOIN Patient p ON e.ID = p.ID WHERE p.Admission = '-' AND e.ALP < 300;
SELECT Diagnosis FROM Examination WHERE ID IN (SELECT ID FROM Laboratory WHERE TP < 6.0);
SELECT COUNT(*) FROM Examination WHERE Diagnosis = 'SJS' AND TP > 6.0 AND TP < 8.5;
SELECT `Examination Date` FROM Examination WHERE ALB = (SELECT MAX(ALB) FROM Examination WHERE ALB > 3.5 and ALB < 5.5);
SELECT COUNT(*) FROM Patient p JOIN Laboratory l ON p.ID = l.ID WHERE p.SEX = 'M' AND l.ALB > 3.5 AND l.ALB < 5.5 AND l.TP BETWEEN 6.0 AND 8.5;
SELECT `aCL IgG`, `aCL IgM`, `aCL IgA` FROM Examination WHERE ID IN (SELECT ID FROM Patient WHERE SEX = 'F') AND UA = (SELECT MAX(UA) FROM Laboratory WHERE UA <= 6.50);
SELECT MAX(ANA) FROM Examination WHERE CRE < 1.5;
SELECT ID FROM Examination WHERE CRE < 1.5 ORDER BY `aCL IgA` DESC LIMIT 1;
SELECT COUNT(*) FROM Examination WHERE `T-BIL` >= 2.0 AND `ANA Pattern` LIKE '%P%';
SELECT ANA FROM Examination WHERE `T-BIL` = (SELECT MAX(`T-BIL`) FROM Examination WHERE `T-BIL` < 2.0);
SELECT COUNT(*) FROM Examination WHERE `T-CHO` >= 250 AND KCT = '-';
SELECT COUNT(*) FROM Examination WHERE `T-CHO` < 250 AND `ANA Pattern` = 'P';
SELECT COUNT(*) FROM Examination WHERE TG < 200 AND Symptoms IS NOT NULL;
SELECT Diagnosis FROM Examination WHERE TG < 200 ORDER BY TG DESC LIMIT 1;
SELECT ID FROM Laboratory WHERE Thrombosis > 0 AND CPK < 250;
SELECT COUNT(*) FROM Examination WHERE CRE < 250 AND (KCT = '+' OR RVVT = '+' OR LAC = '+');
SELECT MIN(Birthday) FROM Patient WHERE GLU > 180;
SELECT COUNT(*) FROM Examination WHERE GLU < 180 AND Thrombosis = 0;
SELECT COUNT(*) FROM Laboratory WHERE Admission = '+' AND WBC BETWEEN 3.5 AND 9.0;
SELECT COUNT(*) FROM Examination WHERE Diagnosis = 'SLE' AND WBC BETWEEN 3.5 AND 9.0;
SELECT ID FROM Laboratory WHERE (RBC < 3.5 OR RBC > 6.0) AND Admission = '-';
SELECT COUNT(*) FROM Examination WHERE PLT > 100 AND PLT < 400 AND Symptoms IS NOT NULL;
SELECT Examination.ID, Examination.`Examination Date`, Laboratory.PLT FROM Examination JOIN Laboratory ON Examination.ID = Laboratory.ID WHERE Examination.Diagnosis = 'MCTD' AND Laboratory.PLT > 100 AND Laboratory.PLT < 400;
SELECT AVG(PT) FROM Examination WHERE Sex = 'M' AND PT < 14;
SELECT COUNT(*) FROM Examination WHERE Thrombosis = 2 OR Thrombosis = 1 AND PT < 14;
SELECT major_name FROM major WHERE major_id = (SELECT link_to_major FROM member WHERE first_name = 'Angela' AND last_name = 'Sanders');
SELECT COUNT(*) FROM member WHERE link_to_major IN (SELECT major_id FROM major WHERE college = 'College of Engineering');
SELECT first_name || ' ' || last_name AS full_name FROM member WHERE link_to_major = 'major_id_of_Art_and_Design_Department' AND member_id IN (SELECT link_to_member FROM attendance WHERE link_to_event = 'event_id_of_Student_Club');
SELECT COUNT(*) FROM attendance WHERE link_to_event = (SELECT event_id FROM event WHERE event_name = "Women's Soccer");
SELECT phone FROM member WHERE member_id IN (SELECT link_to_member FROM attendance WHERE link_to_event = (SELECT event_id FROM event WHERE event_name = "Women's Soccer"));
SELECT COUNT(*) FROM member WHERE t_shirt_size = 'Medium' AND member_id IN (SELECT link_to_member FROM attendance WHERE link_to_event = (SELECT event_id FROM event WHERE event_name = "Women's Soccer"));
SELECT link_to_event, COUNT(link_to_member) AS attendance FROM attendance JOIN event ON attendance.link_to_event = event.event_id WHERE event.type = 'Student_Club' GROUP BY link_to_event ORDER BY attendance DESC LIMIT 1;
SELECT college FROM major WHERE major_id = (SELECT link_to_major FROM member WHERE position = 'Vice President' AND link_to_major = 'Student_Club');
SELECT event_name FROM event WHERE event_id IN (SELECT link_to_event FROM attendance WHERE link_to_member = (SELECT member_id FROM member WHERE first_name = 'Angela' AND last_name = 'Sanders'));
SELECT COUNT(*) FROM attendance WHERE link_to_member = 'Sacha Harrison' AND YEAR(event_date) = 2019;
SELECT COUNT(*) FROM event WHERE type = 'Meeting' AND event_id IN (SELECT link_to_event FROM attendance GROUP BY link_to_event HAVING COUNT(event_id) > 10);
SELECT event_name FROM event WHERE event_id IN (SELECT link_to_event FROM attendance GROUP BY link_to_event HAVING COUNT(event_id) > 20);
SELECT ROUND(AVG(CAST(COUNT(*) AS FLOAT) / COUNT(DISTINCT event_name)), 2) FROM attendance WHERE link_to_event IN (SELECT event_id FROM event WHERE type = 'Meeting' AND strftime('%Y', event_date) = '2020');
SELECT MAX(cost) FROM expense WHERE expense_description = 'support of club events';
SELECT COUNT(*) FROM member WHERE link_to_major = (SELECT major_id FROM major WHERE major_name = 'Environmental Engineering');
SELECT first_name || ' ' || last_name AS full_name FROM member WHERE member_id IN (SELECT link_to_member FROM attendance WHERE link_to_event = (SELECT event_id FROM event WHERE event_name = 'Lacrosse game'));
SELECT last_name FROM member WHERE link_to_major = (SELECT major_id FROM major WHERE major_name = 'Law and Constitutional Studies');
SELECT county FROM zip_code WHERE zip_code = (SELECT zip FROM member WHERE first_name = 'Sherry' AND last_name = 'Ramsey');
SELECT college FROM major WHERE major_name = (SELECT major_name FROM major WHERE major_id = (SELECT link_to_major FROM member WHERE first_name = 'Tyler' AND last_name = 'Hewitt'));
SELECT SUM(amount) FROM income WHERE link_to_member = (SELECT member_id FROM member WHERE position = 'Vice President');
SELECT SUM(cost) FROM expense WHERE link_to_budget = (SELECT budget_id FROM budget WHERE event_status = 'Active' AND event_name = 'September Meeting') AND expense_description = 'Food';
SELECT city, state FROM zip_code WHERE zip_code = (SELECT zip FROM member WHERE position = 'President');
SELECT first_name || ' ' || last_name AS full_name FROM member JOIN zip_code ON member.zip = zip_code.zip_code WHERE zip_code.state = 'IL' ORDER BY last_name;
SELECT SUM(spent) FROM budget WHERE category = 'Advertisement' AND link_to_event = (SELECT event_id FROM event WHERE event_name = 'September Meeting');
SELECT department FROM major WHERE major_id IN (SELECT link_to_major FROM member WHERE last_name IN ('Pierce', 'Guidi'));
SELECT SUM(amount) FROM budget WHERE link_to_event = (SELECT event_id FROM event WHERE event_name = 'October Speaker');
SELECT SUM(cost) FROM expense WHERE link_to_budget = (SELECT budget_id FROM budget WHERE link_to_event = (SELECT event_id FROM event WHERE event_name = 'October Meeting' AND event_date = '2019-10-08')) AND approved = 'True';
SELECT SUM(cost)/COUNT(DISTINCT event_id) FROM expense WHERE link_to_member = 'Elijah Allen' AND (MONTH(expense_date) = 9 OR MONTH(expense_date) = 10);
SELECT SUM(CASE WHEN strftime('%Y', expense_date) = '2019' THEN cost ELSE 0 END) - SUM(CASE WHEN strftime('%Y', expense_date) = '2020' THEN cost ELSE 0 END) FROM expense;
SELECT location FROM event WHERE event_name = 'Spring Budget Review';
SELECT cost FROM expense WHERE link_to_budget = (SELECT budget_id FROM budget WHERE event_status = 'active' AND link_to_event = (SELECT event_id FROM event WHERE event_name = 'Posters' AND event_date = '2019-09-04'));
SELECT remaining FROM budget WHERE amount = (SELECT MAX(amount) FROM budget WHERE category = 'Food');
SELECT notes FROM income WHERE date_received = '2019-09-14' AND source = 'Fundraising';
SELECT COUNT(*) FROM major WHERE college = 'College of Humanities and Social Sciences';
SELECT phone FROM member WHERE first_name = 'Carlo' AND last_name = 'Jacobs';
SELECT county FROM zip_code WHERE zip_code = (SELECT zip FROM member WHERE first_name = 'Adela' AND last_name = 'O''Gallagher');
SELECT COUNT(*) FROM budget WHERE event_name = 'November Meeting' AND remaining < 0;
SELECT SUM(amount) FROM budget WHERE link_to_event = (SELECT event_id FROM event WHERE event_name = 'September Speaker');
SELECT status FROM event WHERE event_id = (SELECT link_to_event FROM budget WHERE budget_id = (SELECT link_to_budget FROM expense WHERE expense_id = (SELECT expense_id FROM expense WHERE expense_description = 'Post Cards, Posters' AND expense_date = '2019-8-20')));
SELECT major_name FROM member WHERE first_name = 'Brent' AND last_name = 'Thomason';
SELECT COUNT(*) FROM member WHERE major_name = 'Human Development and Family Studies' AND t_shirt_size = 'Large';
SELECT z.type FROM member m JOIN zip_code z ON m.zip = z.zip_code WHERE m.first_name = 'Christof' AND m.last_name = 'Nielson';
SELECT major_name FROM major WHERE major_id = (SELECT link_to_major FROM member WHERE position = 'Vice President');
SELECT state FROM zip_code WHERE zip_code = (SELECT zip FROM member WHERE first_name = 'Sacha' AND last_name = 'Harrison');
SELECT department FROM major WHERE major_id = (SELECT link_to_major FROM member WHERE position = 'President');
SELECT date_received FROM income WHERE source = 'Dues' AND link_to_member = (SELECT member_id FROM member WHERE first_name = 'Connor' AND last_name = 'Hilton');
SELECT first_name || ' ' || last_name FROM member WHERE member_id = (SELECT link_to_member FROM income WHERE source = 'Dues' AND date_received = (SELECT MIN(date_received) FROM income WHERE source = 'Dues'));
SELECT ROUND((SELECT SUM(amount) FROM budget WHERE category = 'Advertisement' AND event_name = 'Yearly Kickoff') / (SELECT SUM(amount) FROM budget WHERE event_name = 'October Meeting' AND category = 'Advertisement'), 2) > 1;
SELECT ROUND((SUM(CASE WHEN category = 'Parking' AND event_name = 'November Speaker' THEN amount ELSE 0 END) / COUNT(CASE WHEN event_name = 'November Speaker' THEN 1 ELSE NULL END)) * 100) FROM budget WHERE event_name = 'November Speaker';
SELECT SUM(cost) FROM expense WHERE expense_description = 'Pizza';
SELECT COUNT(DISTINCT city) FROM zip_code WHERE county = 'Orange County' AND state = 'Virginia';
SELECT department FROM major WHERE college = 'College of Humanities and Social Sciences';
SELECT city, county, state FROM zip_code WHERE zip_code = (SELECT zip FROM member WHERE first_name = 'Amy' AND last_name = 'Firth');
SELECT expense_description FROM expense WHERE link_to_budget = (SELECT budget_id FROM budget WHERE remaining = (SELECT MIN(remaining) FROM budget));
SELECT member_id FROM attendance WHERE link_to_event = (SELECT event_id FROM event WHERE event_name = 'October Meeting');
SELECT major.college FROM member JOIN major ON member.link_to_major = major.major_id GROUP BY major.college ORDER BY COUNT(*) DESC LIMIT 1;
SELECT major_name FROM major WHERE major_id = (SELECT link_to_major FROM member WHERE phone = '809-555-3360');
SELECT event_name FROM event WHERE event_id = (SELECT link_to_event FROM budget WHERE amount = (SELECT MAX(amount) FROM budget));
SELECT * FROM expense WHERE link_to_member = (SELECT member_id FROM member WHERE position = 'Vice President');
SELECT COUNT(*) FROM attendance WHERE link_to_event = (SELECT event_id FROM event WHERE event_name = "Women's Soccer");
SELECT date_received FROM income WHERE link_to_member = (SELECT member_id FROM member WHERE first_name = 'Casey' AND last_name = 'Mason');
SELECT COUNT(*) FROM member WHERE zip IN (SELECT zip_code FROM zip_code WHERE state = 'Maryland');
SELECT COUNT(*) FROM attendance WHERE link_to_member = (SELECT member_id FROM member WHERE phone = '954-555-6240');
SELECT first_name || ' ' || last_name AS full_name FROM member WHERE link_to_major = (SELECT major_id FROM major WHERE major_name = 'School of Applied Sciences, Technology and Education');
SELECT event_name FROM budget JOIN event ON budget.link_to_event = event.event_id WHERE event.status = 'Closed' ORDER BY DIVIDE(spent, amount) DESC LIMIT 1;
SELECT COUNT(*) FROM member WHERE position = 'President';
SELECT MAX(spent) FROM budget;
SELECT COUNT(*) FROM event WHERE type = 'Meeting' AND YEAR(event_date) = 2020;
SELECT SUM(spent) FROM budget WHERE category = 'Food';
SELECT first_name || ' ' || last_name AS full_name FROM member JOIN attendance ON member.member_id = attendance.link_to_member GROUP BY member.member_id HAVING COUNT(link_to_event) > 7;
SELECT first_name, last_name FROM member WHERE link_to_major IN (SELECT major_id FROM major WHERE major_name = 'Music') AND member_id IN (SELECT link_to_member FROM attendance WHERE link_to_event IN (SELECT event_id FROM event WHERE event_name = 'Community Theater'));
SELECT first_name, last_name FROM member WHERE zip = (SELECT zip_code FROM zip_code WHERE city = 'Fleetwood' AND state = 'Pennsylvania');
SELECT COUNT(*) FROM income WHERE link_to_member = (SELECT member_id FROM member WHERE first_name = 'Grant' AND last_name = 'Gilmour');
SELECT first_name || ' ' || last_name AS full_name FROM income JOIN member ON income.link_to_member = member.member_id WHERE income.amount > 50;
SELECT SUM(cost) FROM expense WHERE link_to_budget = (SELECT budget_id FROM budget WHERE event_status = 'Yearly Kickoff');
SELECT first_name, last_name FROM member WHERE member_id = (SELECT link_to_member FROM budget WHERE link_to_event = (SELECT event_id FROM event WHERE event_name = 'Football game'));
SELECT member.first_name || ' ' || member.last_name AS name, income.source FROM member JOIN income ON member.member_id = income.link_to_member WHERE income.amount = (SELECT MAX(amount) FROM income);
SELECT event_name FROM event WHERE event_id = (SELECT link_to_event FROM budget WHERE cost = (SELECT MIN(cost) FROM expense));
SELECT ROUND((SUM(CASE WHEN event_name = 'Yearly Kickoff' THEN cost ELSE 0 END) * 1.0 / SUM(cost)) * 100, 2) FROM expense JOIN budget ON expense.link_to_budget = budget.budget_id;
SELECT ROUND(CAST(SUM(major_name = 'Finance') AS FLOAT) / CAST(SUM(major_name = 'Physics') AS FLOAT), 2) FROM member JOIN major ON member.link_to_major = major.major_id;
SELECT source FROM income WHERE date_received BETWEEN '2019-09-01' and '2019-09-30' AND amount = (SELECT MAX(amount) FROM income WHERE date_received BETWEEN '2019-09-01' and '2019-09-30');
SELECT first_name || ' ' || last_name AS full_name, email FROM member WHERE position = 'Secretary';
SELECT COUNT(*) FROM member WHERE link_to_major = (SELECT major_id FROM major WHERE major_name = 'Physics Teaching');
SELECT COUNT(*) FROM attendance WHERE link_to_event IN (SELECT event_id FROM event WHERE event_name = 'Community Theater' AND strftime('%Y', event_date) = '2019');
SELECT COUNT(*) FROM attendance WHERE link_to_member = (SELECT member_id FROM member WHERE first_name = 'Luisa' AND last_name = 'Guidi'); SELECT major_name FROM major WHERE major_id = (SELECT link_to_major FROM member WHERE first_name = 'Luisa' AND last_name = 'Guidi'); SELECT position FROM member WHERE first_name = 'Luisa' AND last_name = 'Guidi';
SELECT AVG(spent) FROM budget WHERE category = 'Food' AND event_status = 'Closed';
SELECT event_name FROM event JOIN budget ON event.event_id = budget.link_to_event WHERE category = 'Advertisement' AND spent = (SELECT MAX(spent) FROM budget WHERE category = 'Advertisement');
SELECT expense.cost FROM expense JOIN attendance ON expense.link_to_member = 'Maya Mclean' AND attendance.link_to_member = 'Maya Mclean' AND attendance.link_to_event = (SELECT event_id FROM event WHERE event_name = 'Women''s Soccer');
SELECT DIVIDE(SUM(type = 'Community Service'), COUNT(event_id)) * 100 FROM event WHERE event_date BETWEEN' 2019-01-01' and '2019-12-31';
SELECT cost FROM expense JOIN budget ON expense.link_to_budget = budget.budget_id JOIN event ON budget.link_to_event = event.event_id WHERE expense.expense_description = 'Posters' AND event.event_name = 'September Speaker';
SELECT t_shirt_size FROM member GROUP BY t_shirt_size ORDER BY COUNT(t_shirt_size) DESC LIMIT 1;
SELECT event_name FROM budget WHERE event_status = 'Closed' AND remaining < 0 AND remaining = (SELECT MIN(remaining) FROM budget WHERE event_status = 'Closed' AND remaining < 0);
SELECT expense_description, SUM(cost) as total_value FROM expense WHERE link_to_budget = (SELECT budget_id FROM budget WHERE link_to_event = (SELECT event_id FROM event WHERE event_name = 'October Meeting')) GROUP BY expense_description;
SELECT amount FROM budget WHERE link_to_event = (SELECT event_id FROM event WHERE event_name = 'April Speaker');
SELECT MAX(amount) FROM budget WHERE category = 'Food';
SELECT * FROM budget WHERE category = 'Advertising' ORDER BY amount DESC LIMIT 3;
SELECT SUM(cost) FROM expense WHERE expense_description = 'Parking';
SELECT SUM(cost) FROM expense WHERE expense_date = '2019-08-20';
SELECT first_name || ' ' || last_name AS full_name, SUM(cost) AS total_cost FROM expense JOIN member ON expense.link_to_member = member.member_id WHERE member.member_id = 'rec4BLdZHS2Blfp4v' GROUP BY full_name ORDER BY total_cost DESC;
SELECT expense_description FROM expense WHERE link_to_member = (SELECT member_id FROM member WHERE first_name = 'Trent' AND last_name = 'Smith');
SELECT expense_description FROM expense WHERE link_to_member IN (SELECT member_id FROM member WHERE t_shirt_size = 'X-Large') GROUP BY expense_description;
SELECT zip FROM member WHERE member_id IN (SELECT link_to_member FROM expense WHERE cost < 50);
SELECT major_name FROM major WHERE major_id = (SELECT link_to_major FROM member WHERE first_name = 'Phillip' AND last_name = 'Cullen');
SELECT position FROM member WHERE link_to_major = (SELECT major_id FROM major WHERE major_name = 'Journalism');
SELECT COUNT(*) FROM member WHERE link_to_major IN (SELECT major_id FROM major WHERE major_name = 'Business') AND t_shirt_size = 'Medium';
SELECT DISTINCT type FROM event WHERE event_id IN (SELECT link_to_event FROM budget WHERE remaining > 30);
SELECT category FROM budget WHERE link_to_event IN (SELECT event_id FROM event WHERE location = 'MU 215');
SELECT category FROM budget WHERE link_to_event = (SELECT event_id FROM event WHERE event_date = '2020-03-24T12:00:00');
SELECT major_name FROM major WHERE major_id = (SELECT link_to_major FROM member WHERE position = 'Vice President');
SELECT ROUND(CAST(COUNT(CASE WHEN major_name = 'Mathematics' AND position = 'Member' THEN 1 END) AS FLOAT) / COUNT(member_id) * 100, 2) FROM member;
SELECT category FROM budget WHERE link_to_event = (SELECT event_id FROM event WHERE location = '100 W. Main Street');
SELECT COUNT(*) FROM income WHERE amount = 50;
SELECT COUNT(*) FROM member WHERE t_shirt_size = 'X-Large';
SELECT COUNT(*) FROM major WHERE college = 'College of Agriculture and Applied Sciences' AND department = 'School of Applied Sciences, Technology and Education';
SELECT member.last_name, major.department, major.college FROM member JOIN major ON member.link_to_major = major.major_id WHERE major.major_name = 'Environmental Engineering' ORDER BY member.last_name;
SELECT DISTINCT category FROM budget WHERE spent = 0 AND link_to_event IN (SELECT event_id FROM event WHERE location = 'MU 215' AND type = 'Guest Speaker');
SELECT city, state FROM zip_code WHERE zip_code IN (SELECT zip FROM member WHERE link_to_major = (SELECT major_id FROM major WHERE department = 'Electrical and Computer Engineering Department') AND position = 'Member');
SELECT event_name FROM event WHERE type = 'Social' AND location = '900 E. Washington St.' AND event_id IN (SELECT link_to_event FROM attendance WHERE link_to_member IN (SELECT member_id FROM member WHERE position = 'Vice President' AND location = '900 E. Washington St.'));
SELECT member.last_name, member.position FROM member JOIN expense ON member.member_id = expense.link_to_member WHERE expense.expense_description = 'Pizza' AND expense.expense_date = '2019-09-03';
SELECT last_name FROM member WHERE position = 'Member' AND member_id IN (SELECT link_to_member FROM attendance WHERE link_to_event = (SELECT event_id FROM event WHERE event_name = 'Women''s Soccer')) ORDER BY last_name;
SELECT COUNT(amount = 50) * 100 / COUNT(member_id) FROM member WHERE t_shirt_size = 'Medium';
SELECT DISTINCT country FROM zip_code WHERE type = 'PO Box' ORDER BY country;
SELECT zip_code FROM zip_code WHERE type = 'PO Box' AND state = 'Puerto Rico' AND county = 'San Juan Municipio';
SELECT event_name FROM event WHERE type = 'Game' AND status = 'Closed' AND event_date BETWEEN '2019-03-15' and '2020-05-20' ORDER BY event_date;
SELECT DISTINCT attendance.link_to_event FROM attendance JOIN expense ON attendance.link_to_member = expense.link_to_member WHERE expense.cost > 50;
SELECT member.*, attendance.link_to_event FROM member JOIN attendance ON member.member_id = attendance.link_to_member WHERE member.member_id IN (SELECT link_to_member FROM expense WHERE approved = 'true' AND expense_date BETWEEN '2019-01-19' AND '2019-11-19');
SELECT major.college FROM member JOIN major ON member.link_to_major = major.major_id WHERE member.first_name = 'Katy' AND major.major_id = 'rec1N0upiVLy5esTO';
SELECT phone FROM member WHERE link_to_major = (SELECT major_id FROM major WHERE major_name = 'Finance') AND zip = (SELECT zip_code FROM zip_code WHERE city = 'School of Business');
SELECT DISTINCT email FROM member WHERE member_id IN (SELECT link_to_member FROM expense WHERE expense_date BETWEEN '2019-09-10' and '2019-11-19' AND cost > 20);
SELECT COUNT(*) FROM member WHERE link_to_major = 'Education' AND link_to_major IN (SELECT major_id FROM major WHERE college = 'College of Education & Human Services');
SELECT ROUND(DIVIDE(SUM(CAST(remaining < 0 AS INTEGER)), COUNT(event_id)) * 100) FROM budget;
SELECT event_id, location, status FROM event WHERE event_date BETWEEN '2019-11-01' and '2020-03-31' ORDER BY event_date;
SELECT * FROM expense GROUP BY expense_description HAVING AVG(cost) > 50;
SELECT first_name || ' ' || last_name AS full_name FROM member WHERE t_shirt_size = 'X-Large' ORDER BY last_name;
SELECT ROUND(CAST(SUM(type = 'PO Box') AS FLOAT) / CAST(COUNT(zip_code) AS FLOAT) * 100) FROM zip_code;
SELECT event_name, location FROM event JOIN budget ON event.event_id = budget.link_to_event WHERE remaining > 0 ORDER BY event_date;
SELECT event_name, event_date FROM event WHERE event_id IN (SELECT link_to_event FROM expense WHERE expense_description = 'Pizza' AND cost > 50 AND cost < 100);
SELECT first_name || ' ' || last_name AS full_name, major_name FROM member JOIN major ON member.link_to_major = major.major_id WHERE member.member_id IN (SELECT link_to_member FROM expense WHERE cost > 100);
SELECT DISTINCT location FROM event WHERE event_id IN (SELECT link_to_event FROM income GROUP BY link_to_event HAVING COUNT(*) > 50);
SELECT MAX(cost) FROM expense WHERE COUNT(event_id) > 1;
SELECT AVG(cost) FROM expense WHERE link_to_member IN (SELECT member_id FROM member WHERE position != 'Member');
SELECT event_name FROM event WHERE category = 'Parking' AND cost < (SELECT AVG(cost) FROM event WHERE category = 'Parking') ORDER BY event_date;
SELECT ROUND(DIVIDE(SUM(cost), COUNT(event_id)) * 100, 2) FROM expense WHERE link_to_budget IN (SELECT budget_id FROM budget WHERE event_status = 'Approved' AND link_to_event IN (SELECT event_id FROM event WHERE type = 'Game'));
SELECT budget_id, MAX(cost) FROM expense JOIN budget ON expense.link_to_budget = budget.budget_id WHERE expense.expense_description = 'Water, chips, cookies' GROUP BY budget_id;
SELECT member.first_name || ' ' || member.last_name AS full_name, SUM(expense.cost) AS total_cost FROM member JOIN expense ON member.member_id = expense.link_to_member GROUP BY member.member_id ORDER BY total_cost DESC LIMIT 5;
SELECT first_name || ' ' || last_name AS full_name, phone FROM member JOIN expense ON member.member_id = expense.link_to_member WHERE cost > (SELECT AVG(cost) FROM expense) ORDER BY last_name;
SELECT (SUM(state = 'Maine') * 1.0 / COUNT(position = 'Member') - SUM(state = 'Vermont') * 1.0 / COUNT(position = 'Member')) * 100 FROM member;
SELECT major_name, department FROM major WHERE major_id = (SELECT link_to_major FROM member WHERE first_name = 'Garrett' AND last_name = 'Gerke');
SELECT member.first_name || ' ' || member.last_name AS full_name, expense.cost FROM member JOIN expense ON member.member_id = expense.link_to_member WHERE expense.expense_description = 'Water' OR expense.expense_description = 'Veggie Tray' OR expense.expense_description = 'Supplies' ORDER BY expense.cost DESC;
SELECT last_name, phone FROM member WHERE link_to_major = (SELECT major_id FROM major WHERE major_name = 'Elementary Education') ORDER BY last_name;
SELECT category, amount FROM budget WHERE link_to_event = (SELECT event_id FROM event WHERE event_name = 'January Speaker');
SELECT event_name FROM event WHERE event_id IN (SELECT link_to_event FROM budget WHERE category = 'Food');
SELECT first_name || ' ' || last_name AS full_name, amount FROM income JOIN member ON income.link_to_member = member.member_id WHERE date_received = '9/9/2019' ORDER BY amount DESC;
SELECT category FROM budget WHERE budget_id = (SELECT link_to_budget FROM expense WHERE expense_description = 'Posters');
SELECT first_name || ' ' || last_name AS full_name, college FROM member WHERE position = 'Secretary';
SELECT event.event_name, budget.spent FROM event JOIN budget ON event.event_id = budget.link_to_event WHERE budget.category = 'Speaker Gifts' ORDER BY budget.spent DESC;
SELECT city FROM zip_code WHERE zip_code = (SELECT zip FROM member WHERE first_name = 'Garrett' AND last_name = 'Girke');
SELECT first_name || ' ' || last_name AS full_name, position FROM member WHERE city = 'Lincolnton' AND state = 'North Carolina' AND zip = 28092;
SELECT COUNT(*) FROM gasstations WHERE country = 'CZE' AND segment = 'Premium';
SELECT ROUND(CAST((SELECT COUNT(*) FROM customers WHERE Currency = 'EUR') AS REAL) / CAST((SELECT COUNT(*) FROM customers WHERE Currency = 'CZK') AS REAL), 2);
SELECT yearmonth.CustomerID, SUM(yearmonth.Consumption) AS Consumption FROM yearmonth JOIN transactions_1k ON yearmonth.CustomerID = transactions_1k.CustomerID AND transactions_1k.Date BETWEEN 201201 AND 201212 JOIN gasstations ON transactions_1k.GasStationID = gas
SELECT AVG(Consumption) / 12 FROM yearmonth WHERE Date BETWEEN 201301 AND 201312 AND CustomerID IN (SELECT CustomerID FROM customers WHERE Segment = 'SME');
SELECT t.CustomerID, SUM(t.Amount) AS total_amount FROM transactions_1k t JOIN gasstations g ON t.GasStationID = g.GasStationID JOIN customers c ON t.CustomerID = c.CustomerID WHERE t.Date BETWEEN 201101 AND 201112 AND c.Currency = 'CZK' GROUP BY t.CustomerID ORDER BY total_amount DESC LIMIT 1;
SELECT COUNT(*) FROM (SELECT CustomerID, SUM(Consumption) AS total_consumption FROM yearmonth WHERE CustomerID IN (SELECT CustomerID FROM customers WHERE Segment = 'KAM') AND Date BETWEEN 201201 AND 201212 GROUP BY CustomerID) WHERE total_consumption < 30000;
SELECT (SUM(CASE WHEN Currency = 'CZK' THEN Consumption ELSE Consumption * 25 END) - SUM(CASE WHEN Currency = 'EUR' THEN Consumption ELSE Consumption / 25 END)) AS Difference FROM yearmonth JOIN customers ON yearmonth.CustomerID = customers.CustomerID WHERE Date BETWEEN 201201 AND 201212;
SELECT strftime('%Y', Date) AS year, SUM(Amount * Price) AS total_amount FROM transactions_1k JOIN gasstations ON transactions_1k.GasStationID = gasstations.GasStationID WHERE gasstations.Country = 'EUR' GROUP BY year ORDER BY total_amount DESC LIMIT 1;
0
SELECT substr(t.Date, 1, 4) AS year, SUM(y.Consumption) AS total_consumption FROM transactions_1k t JOIN gasstations g ON t.GasStationID = g.GasStationID JOIN customers c ON t.CustomerID = c.CustomerID JOIN yearmonth y ON t.CustomerID = y.CustomerID AND substr(t.Date, 1, 4) = substr(y.Date, 1, 4) WHERE c.Currency = 'CZK' AND g.Country = 'Czech Republic' GROUP BY substr(t.Date, 1, 4) ORDER BY total_consumption DESC LIMIT 1
SELECT strftime('%m', yearmonth.Date) as month, SUM(yearmonth.Consumption) as consumption FROM yearmonth JOIN transactions_1k ON yearmonth.CustomerID = transactions_1k.CustomerID AND strftime('%Y', transactions_1k.Date) = '2013' AND strftime('%m', transactions_1k.Date) = strftime('%m', yearmonth.Date) JOIN customers ON transactions_1k.CustomerID
SELECT (SELECT AVG(Consumption) FROM yearmonth WHERE Date BETWEEN 201301 AND 201312 AND CustomerID IN (SELECT CustomerID FROM yearmonth WHERE Date BETWEEN 201301 AND 201312 GROUP BY Segment, CustomerID HAVING Consumption = MIN(Consumption))) - (SELECT AVG(Consumption) FROM yearmonth WHERE Date BETWEEN 201301 AND 201312 AND CustomerID IN (SELECT CustomerID FROM yearmonth WHERE Date BETWEEN 201301 AND 201312 GROUP BY Segment, CustomerID HAVING Consumption
0
SELECT SUM(Amount) FROM yearmonth JOIN transactions_1k ON yearmonth.CustomerID = transactions_1k.CustomerID WHERE transactions_1k.Date BETWEEN 201308 AND 201311 AND yearmonth.CustomerID = 6;
SELECT COUNT(*) FROM gasstations WHERE Segment = 'discount' AND Country = 'Czech Republic' - (SELECT COUNT(*) FROM gasstations WHERE Segment = 'discount' AND Country = 'Slovakia');
SELECT (SELECT consumption FROM yearmonth WHERE CustomerID = 7 AND Date = 201304) - (SELECT consumption FROM yearmonth WHERE CustomerID = 5 AND Date = 201304);
SELECT (SELECT COUNT(*) FROM transactions_1k WHERE Segment = 'SME' AND Currency = 'Czech Koruna') - (SELECT COUNT(*) FROM transactions_1k WHERE Segment = 'SME' AND Currency = 'Euro') AS Difference;
SELECT yearmonth.CustomerID, SUM(yearmonth.Consumption) as consumption FROM yearmonth JOIN customers ON yearmonth.CustomerID = customers.CustomerID WHERE customers.Segment = 'LAM' AND customers.Currency = 'Euro' AND yearmonth.Date = 201310 GROUP BY yearmonth.CustomerID ORDER BY consumption DESC LIMIT 1;
SELECT CustomerID, MAX(Consumption) FROM yearmonth WHERE CustomerID IN (SELECT CustomerID FROM customers WHERE Segment = 'KAM') GROUP BY CustomerID;
SELECT SUM(amount) FROM transactions_1k WHERE CustomerID IN (SELECT CustomerID FROM customers WHERE Segment = 'KAM') AND strftime('%Y%m', Date) = '201305';
SELECT COUNT(*) * 100.0 / (SELECT COUNT(*) FROM yearmonth WHERE Consumption > 46.73 AND CustomerID IN (SELECT CustomerID FROM customers WHERE Segment = 'LAM')) FROM yearmonth WHERE CustomerID IN (SELECT CustomerID FROM customers WHERE Segment = 'LAM');
SELECT Country, COUNT(*) FROM gasstations WHERE Segment = 'value for money' GROUP BY Country;
SELECT (CAST((SELECT COUNT(*) FROM customers WHERE Segment = 'KAM' AND Currency = 'EUR') AS FLOAT) / CAST((SELECT COUNT(*) FROM customers WHERE Segment = 'KAM') AS FLOAT)) * 100 AS percentage;
0
SELECT ROUND((COUNT(CASE WHEN Segment = 'Premium' THEN 1 END) * 1.0 / COUNT(*)) * 100) FROM gasstations WHERE Country = 'Slovakia';
SELECT CustomerID FROM yearmonth WHERE Date = '201309' ORDER BY Consumption DESC LIMIT 1;
SELECT customers.Segment, SUM(yearmonth.Consumption) AS total_consumption FROM yearmonth JOIN customers ON yearmonth.CustomerID = customers.CustomerID WHERE yearmonth.Date = '201309' GROUP BY customers.Segment ORDER BY total_consumption ASC LIMIT 1;
SELECT MIN(y.Consumption) FROM yearmonth y JOIN (SELECT t.CustomerID FROM transactions_1k t JOIN customers c ON t.CustomerID = c.CustomerID WHERE c.Segment = 'SME' AND strftime('%Y%m', t.Date) = '201606') s ON y.CustomerID = s.CustomerID AND y.Date = '201606';
SELECT MAX(sum_consumption) FROM (SELECT CustomerID, SUM(Consumption) AS sum_consumption FROM yearmonth WHERE CAST(date AS TEXT) LIKE '2012%' GROUP BY CustomerID);
SELECT MAX(SUM(consumption) / 12) FROM yearmonth WHERE CustomerID IN (SELECT CustomerID FROM customers WHERE Currency = 'euro') GROUP BY CustomerID;
SELECT DISTINCT Description FROM products WHERE ProductID IN (SELECT ProductID FROM transactions_1k WHERE Date LIKE '201309%');
SELECT DISTINCT gasstations.Country FROM gasstations JOIN transactions_1k ON gasstations.GasStationID = transactions_1k.GasStationID WHERE transactions_1k.Date LIKE '201306%';
SELECT DISTINCT ChainID FROM gasstations WHERE GasStationID IN (SELECT GasStationID FROM transactions_1k WHERE Currency = 'euro');
SELECT products.Description FROM transactions_1k JOIN products ON transactions_1k.ProductID = products.ProductID WHERE transactions_1k.Currency = 'euro';
SELECT AVG(Amount * Price) FROM transactions_1k WHERE Date LIKE '2012-01%';
SELECT COUNT(*) FROM yearmonth y JOIN customers c ON y.CustomerID = c.CustomerID WHERE c.Currency = 'euro' AND y.Consumption > 1000;
SELECT products.Description FROM transactions_1k JOIN products ON transactions_1k.ProductID = products.ProductID JOIN gasstations ON transactions_1k.GasStationID = gasstations.GasStationID WHERE gasstations.Country = 'CZE';
SELECT DISTINCT Time FROM transactions_1k WHERE GasStationID IN (SELECT GasStationID FROM gasstations WHERE ChainID = 11);
SELECT COUNT(*) FROM transactions_1k JOIN gasstations ON transactions_1k.GasStationID = gasstations.GasStationID WHERE gasstations.Country = 'CZE' AND transactions_1k.Price > 1000;
SELECT COUNT(*) FROM transactions_1k WHERE Date > '2012/1/1' AND GasStationID IN (SELECT GasStationID FROM gasstations WHERE Country = 'CZE');
SELECT AVG(total_price) FROM (SELECT SUM(Price * Amount) AS total_price FROM transactions_1k WHERE GasStationID IN (SELECT GasStationID FROM gasstations WHERE Country = 'CZE') GROUP BY TransactionID);
SELECT AVG(Price) FROM transactions_1k JOIN customers ON transactions_1k.CustomerID = customers.CustomerID WHERE Currency = 'euro';
SELECT CustomerID, MAX(Amount) FROM transactions_1k WHERE Date = '2012-08-25';
SELECT Country FROM gasstations WHERE GasStationID = (SELECT GasStationID FROM transactions_1k WHERE Date = '2012-08-25' ORDER BY TransactionID LIMIT 1);
SELECT c.Currency FROM customers c JOIN transactions_1k t ON c.CustomerID = t.CustomerID WHERE t.Time = '16:25:00' AND t.Date = '2012-08-24';
SELECT C.Segment FROM transactions_1k T1 JOIN customers C ON T1.CustomerID = C.CustomerID WHERE T1.Date = '2012-08-23' AND T1.Time = '21:20:00';
SELECT COUNT(*) FROM transactions_1k WHERE Currency = 'EUR' AND Time < '13:00:00' AND Date = '2012-08-26';
SELECT Segment FROM customers WHERE CustomerID = (SELECT MIN(CustomerID) FROM customers);
SELECT Country FROM gasstations AS G JOIN transactions_1k AS T1 ON G.GasStationID = T1.GasStationID WHERE T1.Date = '2012-08-24' AND T1.Time = '12:42:00';
SELECT P.Description FROM transactions_1k T1 JOIN products P ON T1.ProductID = P.ProductID WHERE T1.Date = '2012-08-23' AND T1.time = '21:20:00';
SELECT Date, SUM(Price) AS expenses FROM transactions_1k WHERE CustomerID = (SELECT CustomerID FROM transactions_1k WHERE Price = 124.05 AND Date = '2012-08-24') AND strftime('%Y', Date) = '2012' AND strftime('%m', Date) = '01' GROUP BY Date ORDER BY Date;
SELECT COUNT(*) FROM transactions_1k t JOIN gasstations g ON t.GasStationID = g.GasStationID WHERE t.Date = '2012-08-26' AND t.Time BETWEEN '08:00:00' AND '09:00:00' AND g.Country = 'CZE';
SELECT c.Currency FROM customers c JOIN transactions_1k t ON c.CustomerID = t.CustomerID WHERE t.Amount * t.Price = 214582.17 AND t.Date = 201306;
SELECT gasstations.Country FROM transactions_1k JOIN gasstations ON transactions_1k.GasStationID = gasstations.GasStationID WHERE transactions_1k.CardID = 667467;
SELECT customers.Segment FROM customers JOIN transactions_1k ON customers.CustomerID = transactions_1k.CustomerID WHERE transactions_1k.Amount * transactions_1k.Price = 548.4 AND transactions_1k.Date = '2012-08-24';
SELECT ROUND(COUNT(DISTINCT CustomerID) * 100.0 / (SELECT COUNT(DISTINCT CustomerID) FROM transactions_1k WHERE Date = '2012-08-25'), 2) FROM transactions_1k WHERE Date = '2012-08-25' AND Currency = 'EUR';
SELECT (y.consumption - y2.consumption) / y.consumption FROM yearmonth y JOIN yearmonth y2 ON y.CustomerID = y2.CustomerID WHERE y.CustomerID = (SELECT CustomerID FROM transactions_1k WHERE Price = 634.8 AND Date = '2012-08-25') AND y.Date = 2012 AND y2.Date = 2013;
SELECT GasStationID, SUM(Amount * Price) AS Revenue FROM transactions_1k GROUP BY GasStationID ORDER BY Revenue DESC LIMIT 1;
SELECT COUNT(*)*1.0/COUNT(DISTINCT GasStationID) FROM transactions_1k WHERE GasStationID IN (SELECT GasStationID FROM gasstations WHERE Country = 'SVK' AND Segment = 'premium') AND GasStationID IN (SELECT GasStationID FROM gasstations WHERE Country = 'SVK' AND Segment IS NOT NULL);
SELECT SUM(Amount) FROM transactions_1k WHERE CustomerID = 38508 AND GasStationID IS NOT NULL; SELECT SUM(Amount) FROM transactions_1k WHERE CustomerID = 38508 AND Date LIKE '201201%';
SELECT p.Description FROM products p JOIN transactions_1k t ON p.ProductID = t.ProductID GROUP BY p.Description ORDER BY SUM(t.Amount) DESC LIMIT 5;
SELECT transactions_1k.CustomerID, SUM(transactions_1k.Price) AS total_spending, AVG(transactions_1k.Price / transactions_1k.Amount) AS avg_price_per_single_item, customers.Currency FROM transactions_1k JOIN customers ON transactions_1k.CustomerID = customers.CustomerID GROUP BY transactions_1k.CustomerID ORDER BY total_spending DESC LIMIT 1;
SELECT MAX(price), Country FROM transactions_1k JOIN gasstations ON transactions_1k.GasStationID = gasstations.GasStationID WHERE ProductID = 2;
SELECT yearmonth.Consumption FROM transactions_1k AS T1 JOIN yearmonth ON T1.CustomerID = yearmonth.CustomerID AND T1.Date = yearmonth.Date WHERE T1.ProductID = 5 AND T1.Price / T1.Amount > 29.00 AND yearmonth.Date = 201208;
